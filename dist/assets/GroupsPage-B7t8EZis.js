import{d as M,r as a,j as e,q as U,n as F,L as P,U as y,s as z,X as v,e as x}from"./index-DavVl6G1.js";import{S as B}from"./search-CdPeamcd.js";import{C as D}from"./crown-DK_9BC_n.js";function q(){const{user:r}=M(),[w,d]=a.useState([]),[C,k]=a.useState(!0),[o,S]=a.useState(""),[G,n]=a.useState(!1),[J,l]=a.useState(!1),[c,u]=a.useState(""),[m,h]=a.useState(""),[p,f]=a.useState(!1),[b,j]=a.useState(!1);a.useEffect(()=>{async function s(){if(r)try{const t=await x.getByUser(r.uid);d(t)}catch(t){console.error("Error fetching groups:",t)}finally{k(!1)}}s()},[r]);const E=async s=>{if(s.preventDefault(),!!c.trim()){f(!0);try{const t=await x.create(r.uid,{name:c.trim()});d(i=>[...i,t]),u(""),n(!1)}catch(t){console.error("Error creating group:",t)}finally{f(!1)}}},L=async s=>{if(s.preventDefault(),!!m.trim()){j(!0);try{const t=await x.joinByCode(m.trim(),r.uid);t&&(d(i=>[...i,t]),h(""),l(!1))}catch(t){console.error("Error joining group:",t),alert(t.message||"Failed to join group")}finally{j(!1)}}},N=w.filter(s=>s.name.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 pb-24",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display text-iron-100",children:"Groups"}),e.jsx("p",{className:"text-iron-500 text-sm mt-1",children:"Train together, stay accountable"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>l(!0),className:"btn-secondary flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Join"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Create"})]})]})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(B,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-iron-500"}),e.jsx("input",{type:"text",placeholder:"Search groups...",value:o,onChange:s=>S(s.target.value),className:"input-field w-full pl-12"})]}),C?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"w-10 h-10 border-4 border-flame-500 border-t-transparent rounded-full animate-spin"})}):N.length>0?e.jsx("div",{className:"space-y-3",children:N.map(s=>{var t,i,g;return e.jsxs(P,{to:`/groups/${s.id}`,className:"card-steel p-4 flex items-center gap-4 hover:border-iron-600 transition-colors group",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-flame-500/20 to-flame-600/10 flex items-center justify-center flex-shrink-0",children:e.jsx(y,{className:"w-6 h-6 text-flame-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-iron-100 truncate",children:s.name}),((t=s.admins)==null?void 0:t.includes(r.uid))&&e.jsx(D,{className:"w-4 h-4 text-yellow-500 flex-shrink-0"})]}),e.jsxs("p",{className:"text-sm text-iron-500",children:[((i=s.members)==null?void 0:i.length)||1," member",(((g=s.members)==null?void 0:g.length)||1)!==1?"s":""]})]}),e.jsx(z,{className:"w-5 h-5 text-iron-600 group-hover:text-iron-400 transition-colors"})]},s.id)})}):e.jsxs("div",{className:"card-steel p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-iron-800 flex items-center justify-center mx-auto mb-4",children:e.jsx(y,{className:"w-8 h-8 text-iron-500"})}),e.jsx("h3",{className:"text-lg font-display text-iron-300 mb-2",children:o?"No groups found":"No groups yet"}),e.jsx("p",{className:"text-iron-500 text-sm mb-6 max-w-sm mx-auto",children:o?"Try a different search term":"Create a group to train with friends and track progress together"}),!o&&e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:()=>l(!0),className:"btn-secondary",children:"Join Group"}),e.jsx("button",{onClick:()=>n(!0),className:"btn-primary",children:"Create Group"})]})]}),G&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>n(!1)}),e.jsxs("div",{className:"relative bg-iron-900 border border-iron-700 rounded-2xl p-6 w-full max-w-md animate-scale-in",children:[e.jsx("button",{onClick:()=>n(!1),className:"absolute top-4 right-4 text-iron-500 hover:text-iron-300",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-xl font-display text-iron-100 mb-2",children:"Create Group"}),e.jsx("p",{className:"text-iron-500 text-sm mb-6",children:"Start a new workout group and invite your friends"}),e.jsxs("form",{onSubmit:E,children:[e.jsx("label",{className:"block text-sm font-medium text-iron-400 mb-2",children:"Group Name"}),e.jsx("input",{type:"text",value:c,onChange:s=>u(s.target.value),placeholder:"e.g., Morning Lifters",className:"input-field w-full mb-6",autoFocus:!0}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>n(!1),className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!c.trim()||p,className:"btn-primary flex-1",children:p?"Creating...":"Create Group"})]})]})]})]}),J&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>l(!1)}),e.jsxs("div",{className:"relative bg-iron-900 border border-iron-700 rounded-2xl p-6 w-full max-w-md animate-scale-in",children:[e.jsx("button",{onClick:()=>l(!1),className:"absolute top-4 right-4 text-iron-500 hover:text-iron-300",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-xl font-display text-iron-100 mb-2",children:"Join Group"}),e.jsx("p",{className:"text-iron-500 text-sm mb-6",children:"Enter the invite code shared by your group admin"}),e.jsxs("form",{onSubmit:L,children:[e.jsx("label",{className:"block text-sm font-medium text-iron-400 mb-2",children:"Invite Code"}),e.jsx("input",{type:"text",value:m,onChange:s=>h(s.target.value.toUpperCase()),placeholder:"Enter code",className:"input-field w-full mb-6 text-center text-xl tracking-widest font-mono",maxLength:8,autoFocus:!0}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!m.trim()||b,className:"btn-primary flex-1",children:b?"Joining...":"Join Group"})]})]})]})]})]})}export{q as default};

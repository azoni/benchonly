const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BH1MXG3y.js","assets/index-B_knwA6G.css"])))=>i.map(i=>d[i]);
import{t as pt,b as ut,d as gt,r as n,G as De,H as Le,I as y,K as Me,D as Ee,as as Ue,aq as jt,ao as U,M as ft,j as e,U as te,a3 as se,x as Nt,ac as Ie,au as bt,E as Re,aj as q,Y as vt,w as yt,C as wt,n as ae,aC as Ct,aD as re,p as O,aE as kt,k as Tt,h as Ge,_ as Pe,f as Fe,X as St,Q as Ve,z as H,av as At,aF as Dt,aG as Lt}from"./index-BH1MXG3y.js";import{S as Mt}from"./search-Cijha28e.js";import{P as $e}from"./pen-LLDuRvQy.js";import{T as We}from"./trash-2-DIsgLbDI.js";import{f as Et}from"./index-n5B_Cg_E.js";import{S as Ut}from"./save-oToGrHvn.js";import"./index-Mq-zAcux.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=pt("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);function Bt(){var Ce,ke,Te,Se;const T=ut(),{user:ie,userProfile:Rt,isRealAdmin:_e,startImpersonating:qe,impersonating:Gt}=gt(),[w,I]=n.useState([]),[o,R]=n.useState(null),[j,le]=n.useState(null),[Oe,He]=n.useState(!0),[B,Be]=n.useState(""),[G,z]=n.useState([]),[Q,S]=n.useState([]),[P,F]=n.useState(null),[ze,C]=n.useState(!1),[Pt,Ft]=n.useState(!1),[A,ne]=n.useState(null),[h,D]=n.useState("users"),[u,Qe]=n.useState(null),[K,ce]=n.useState([]),[Ke,oe]=n.useState(!1),[X,de]=n.useState(null),[d,f]=n.useState({painThresholdMin:3,painThresholdCount:2,defaultModel:"standard",rateLimitHourly:8,rateLimitDaily:25,overageCreditMultiplier:3}),[xe,me]=n.useState(!1),[Xe,Y]=n.useState(!1),[L,V]=n.useState(""),[he,pe]=n.useState(!1),[Ye,ue]=n.useState(!1),[$,Ze]=n.useState(!1),[ge,Je]=n.useState([]),[je,fe]=n.useState(!1),[Z,et]=n.useState(""),[tt,st]=n.useState(null),[x,N]=n.useState({lift:"",metricType:"weight",currentValue:"",targetValue:"",targetDate:"",notes:""}),at=["Bench Press","Squat","Deadlift","Overhead Press","Barbell Row","Pull-ups","Incline Bench","Romanian Deadlift","Front Squat","Close Grip Bench","Dead Hang","Plank","Dips","Chin-ups"],k={weight:{label:"Weight",unit:"lbs"},reps:{label:"Reps",unit:"reps"},time:{label:"Time",unit:"seconds"}},J=_e;n.useEffect(()=>{if(!J){T("/dashboard");return}rt()},[J,T]);const rt=async()=>{try{const t=De(Le(y,"users"),Me("displayName")),r=(await Ee(t)).docs.map(i=>({id:i.id,...i.data()}));I(r)}catch(t){console.error("Error loading users:",t)}finally{He(!1)}},it=async t=>{R(t),le(t),V(""),F(null);try{const[s,r]=await Promise.all([Ve.getByUser(t.uid,20),H.getByUser(t.uid)]);z(s),S(r)}catch(s){console.error("Error loading user data:",s)}},lt=async()=>{if(!o||!L)return;const t=parseInt(L);if(!(isNaN(t)||t===0)){pe(!0);try{await At.add(o.uid,t);const s=(o.credits??0)+t;R(r=>({...r,credits:s})),I(r=>r.map(i=>i.uid===o.uid?{...i,credits:s}:i)),V("")}catch(s){console.error("Error adding credits:",s),alert("Failed to add credits")}finally{pe(!1)}}},Ne=async()=>{ue(!0);try{const t=await Dt.getActivitySummary(7);Qe(t)}catch(t){console.error("Error loading activity:",t)}finally{ue(!1)}},p=n.useMemo(()=>{if(!(u!=null&&u.allEvents))return u;const t=$?u.allEvents.filter(c=>!c.adminUid):u.allEvents,s=new Set(t.map(c=>c.userId)),r={},i={},l={},a={};t.forEach(c=>{var M,b,E,v,W,_,Ae;r[c.action]=(r[c.action]||0)+1,c.action==="page_view"&&((M=c.metadata)!=null&&M.page)&&(i[c.metadata.page]=(i[c.metadata.page]||0)+1);const g=(E=(b=c.timestamp)==null?void 0:b.toDate)==null?void 0:E.call(b);if(g){const ee=g.toISOString().split("T")[0];l[ee]||(l[ee]=new Set),l[ee].add(c.userId)}a[c.userId]||(a[c.userId]={actions:0,lastSeen:null}),a[c.userId].actions++,(!a[c.userId].lastSeen||((W=(v=c.timestamp)==null?void 0:v.toDate)==null?void 0:W.call(v))>a[c.userId].lastSeen)&&(a[c.userId].lastSeen=(Ae=(_=c.timestamp)==null?void 0:_.toDate)==null?void 0:Ae.call(_))});const m=Object.entries(l).map(([c,g])=>({date:c,count:g.size})).sort((c,g)=>c.date.localeCompare(g.date));return{...u,totalEvents:t.length,uniqueUsers:s.size,actionCounts:r,pageCounts:i,dailyActiveCounts:m,userActivity:a,recentEvents:t.slice(0,50)}},[u,$]);n.useEffect(()=>{h==="activity"&&!u&&Ne(),h==="usage"&&ye(),h==="settings"&&ct(),h==="trainers"&&K.length===0&&nt()},[h]);const nt=async()=>{oe(!0);try{const t=await Ue.getPendingApplications();ce(t)}catch(t){console.error("Error loading trainer applications:",t)}finally{oe(!1)}},be=async(t,s)=>{de(t);try{await Ue.reviewApplication(t,s),ce(r=>r.filter(i=>i.id!==t))}catch(r){console.error("Error reviewing application:",r),alert("Failed to process application")}finally{de(null)}},ve=async(t,s)=>{try{const r=U(y,"users",t);await re(r,{isTrainer:!s}),I(i=>i.map(l=>l.id===t?{...l,isTrainer:!s}:l))}catch(r){console.error("Error toggling trainer status:",r)}},ct=async()=>{try{const t=await jt(U(y,"settings","ai"));t.exists()&&f({painThresholdMin:t.data().painThresholdMin??3,painThresholdCount:t.data().painThresholdCount??2,defaultModel:t.data().defaultModel??"standard",rateLimitHourly:t.data().rateLimitHourly??8,rateLimitDaily:t.data().rateLimitDaily??25,overageCreditMultiplier:t.data().overageCreditMultiplier??3})}catch(t){console.error("Error loading settings:",t)}},ot=async()=>{me(!0),Y(!1);try{await Lt(U(y,"settings","ai"),{painThresholdMin:d.painThresholdMin,painThresholdCount:d.painThresholdCount,defaultModel:d.defaultModel,rateLimitHourly:d.rateLimitHourly,rateLimitDaily:d.rateLimitDaily,overageCreditMultiplier:d.overageCreditMultiplier,updatedAt:new Date,updatedBy:ie.uid}),Y(!0),setTimeout(()=>Y(!1),2e3)}catch(t){console.error("Error saving settings:",t),alert("Failed to save settings")}finally{me(!1)}},ye=async()=>{fe(!0);try{const t=De(Le(y,"tokenUsage"),Me("createdAt","desc"),ft(200)),r=(await Ee(t)).docs.map(i=>{const l={id:i.id,...i.data()};return!l.estimatedCost&&l.promptTokens&&l.completionTokens&&(l.model==="gpt-4o"?l.estimatedCost=l.promptTokens/1e6*2.5+l.completionTokens/1e6*10:l.estimatedCost=l.promptTokens/1e6*.15+l.completionTokens/1e6*.6),l});Je(r)}catch(t){console.error("Error loading usage:",t)}finally{fe(!1)}},dt=async t=>{if(t.preventDefault(),!!j)try{const s=parseInt(x.currentValue)||0,r={lift:x.lift,metricType:x.metricType,currentValue:s,startValue:s,targetValue:parseInt(x.targetValue),targetDate:x.targetDate,notes:x.notes||"",status:"active"};if(x.metricType==="weight"&&(r.currentWeight=s,r.startWeight=s,r.targetWeight=parseInt(x.targetValue)),A)await H.update(A.id,r),S(i=>i.map(l=>l.id===A.id?{...l,...r}:l));else{const i=await H.create(j.uid,r);S(l=>[...l,{...i,...r}])}C(!1),ne(null),N({lift:"",metricType:"weight",currentValue:"",targetValue:"",targetDate:"",notes:""})}catch(s){console.error("Error saving goal:",s),alert("Failed to save goal")}},xt=async t=>{if(confirm("Delete this goal?"))try{await H.delete(t),S(s=>s.filter(r=>r.id!==t))}catch(s){console.error("Error deleting goal:",s),alert("Failed to delete goal")}},mt=async t=>{if(confirm("Delete this workout?"))try{await Ve.delete(t),z(s=>s.filter(r=>r.id!==t))}catch(s){console.error("Error deleting workout:",s),alert("Failed to delete workout")}},ht=t=>{ne(t),N({lift:t.lift,metricType:t.metricType||"weight",currentValue:(t.currentValue??t.currentWeight??"").toString(),targetValue:(t.targetValue??t.targetWeight??"").toString(),targetDate:t.targetDate||"",notes:t.notes||""}),C(!0)},we=w.filter(t=>{var s,r;return((s=t.displayName)==null?void 0:s.toLowerCase().includes(B.toLowerCase()))||((r=t.email)==null?void 0:r.toLowerCase().includes(B.toLowerCase()))});return J?e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 overflow-x-hidden",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-display text-iron-100 flex items-center gap-3",children:[e.jsx(It,{className:"w-7 h-7 text-flame-500"}),"Admin Panel"]}),e.jsx("p",{className:"text-iron-500 text-sm mt-1",children:"Manage users, create workouts and goals"})]})}),e.jsxs("div",{className:"card-steel p-1 mb-6 flex gap-1 max-w-md overflow-x-auto",children:[e.jsxs("button",{onClick:()=>D("users"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg font-medium text-sm transition-colors ${h==="users"?"bg-flame-500 text-white":"text-iron-400 hover:text-iron-200 hover:bg-iron-800"}`,children:[e.jsx(te,{className:"w-4 h-4"}),"Users"]}),e.jsxs("button",{onClick:()=>D("activity"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg font-medium text-sm transition-colors ${h==="activity"?"bg-flame-500 text-white":"text-iron-400 hover:text-iron-200 hover:bg-iron-800"}`,children:[e.jsx(se,{className:"w-4 h-4"}),"Activity"]}),e.jsxs("button",{onClick:()=>D("usage"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg font-medium text-sm transition-colors ${h==="usage"?"bg-flame-500 text-white":"text-iron-400 hover:text-iron-200 hover:bg-iron-800"}`,children:[e.jsx(Nt,{className:"w-4 h-4"}),"Usage"]}),e.jsxs("button",{onClick:()=>D("settings"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg font-medium text-sm transition-colors ${h==="settings"?"bg-flame-500 text-white":"text-iron-400 hover:text-iron-200 hover:bg-iron-800"}`,children:[e.jsx(Ie,{className:"w-4 h-4"}),"Settings"]}),e.jsxs("button",{onClick:()=>D("trainers"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg font-medium text-sm transition-colors ${h==="trainers"?"bg-flame-500 text-white":"text-iron-400 hover:text-iron-200 hover:bg-iron-800"}`,children:[e.jsx(bt,{className:"w-4 h-4"}),"Trainers"]})]}),j&&e.jsxs("div",{className:"mb-6 p-4 bg-purple-500/10 border border-purple-500/30 rounded-xl flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Re,{className:"w-5 h-5 text-purple-400"}),e.jsxs("span",{className:"text-purple-200",children:["Viewing as: ",e.jsx("strong",{children:j.displayName||j.email})]})]}),e.jsx("button",{onClick:()=>{le(null),R(null),z([]),S([])},className:"text-purple-400 hover:text-purple-300 text-sm",children:"Clear Selection"})]}),h==="users"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card-steel rounded-xl",children:[e.jsxs("div",{className:"p-4 border-b border-iron-800",children:[e.jsx("h2",{className:"font-display text-lg text-iron-100 mb-3",children:"Users"}),e.jsxs("div",{className:"relative",children:[e.jsx(Mt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-iron-500"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:B,onChange:t=>Be(t.target.value),className:"input-field w-full pl-10"})]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:Oe?e.jsx("div",{className:"p-8 text-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-flame-500 border-t-transparent rounded-full animate-spin mx-auto"})}):we.length>0?e.jsx("div",{className:"divide-y divide-iron-800",children:we.map(t=>e.jsxs("button",{onClick:()=>it(t),className:`w-full p-4 text-left hover:bg-iron-800/50 transition-colors flex items-center gap-3
                      ${(o==null?void 0:o.id)===t.id?"bg-flame-500/10 border-l-2 border-l-flame-500":""}`,children:[e.jsx("img",{src:t.photoURL||"/default-avatar.png",alt:t.displayName,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-iron-100 truncate",children:t.displayName||"No Name"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm text-iron-500 truncate",children:t.email}),t.credits!==void 0&&e.jsxs("span",{className:"flex items-center gap-0.5 text-xs text-flame-400 flex-shrink-0",children:[e.jsx(q,{className:"w-3 h-3"}),t.credits]})]})]})]},t.id))}):e.jsx("div",{className:"p-8 text-center text-iron-500",children:"No users found"})})]}),e.jsx("div",{className:"lg:col-span-2 space-y-6",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card-steel p-4 sm:p-6 rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4 mb-4",children:[e.jsx("img",{src:o.photoURL||"/default-avatar.png",alt:o.displayName,className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-display text-iron-100 truncate",children:o.displayName||"No Name"}),e.jsx("p",{className:"text-iron-400 text-sm truncate",children:o.email}),e.jsxs("p",{className:"text-xs text-iron-500 truncate",children:["UID: ",o.uid]})]})]}),e.jsxs("button",{onClick:async()=>{await qe(o.uid),T("/today")},className:"w-full sm:w-auto mb-4 px-4 py-2.5 bg-amber-500/20 hover:bg-amber-500/30 text-amber-300 text-sm font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"View as User"]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-iron-800/50 rounded-lg",children:[e.jsx(vt,{className:"w-5 h-5 text-flame-400 mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-display text-iron-100",children:G.length}),e.jsx("p",{className:"text-xs text-iron-500",children:"Workouts"})]}),e.jsxs("div",{className:"text-center p-3 bg-iron-800/50 rounded-lg",children:[e.jsx(yt,{className:"w-5 h-5 text-purple-400 mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-display text-iron-100",children:Q.filter(t=>t.status==="active").length}),e.jsx("p",{className:"text-xs text-iron-500",children:"Active Goals"})]}),e.jsxs("div",{className:"text-center p-3 bg-iron-800/50 rounded-lg",children:[e.jsx(wt,{className:"w-5 h-5 text-blue-400 mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-display text-iron-100",children:G.filter(t=>t.status==="scheduled").length}),e.jsx("p",{className:"text-xs text-iron-500",children:"Scheduled"})]}),e.jsxs("div",{className:"text-center p-3 bg-iron-800/50 rounded-lg",children:[e.jsx(q,{className:"w-5 h-5 text-flame-400 mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-display text-iron-100",children:o.credits??0}),e.jsx("p",{className:"text-xs text-iron-500",children:"Credits"})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-flame-400 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-iron-400",children:"Add credits:"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"flex gap-1.5",children:[10,25,50,100].map(t=>e.jsxs("button",{onClick:()=>V(String(t)),className:`px-2 py-1 text-xs rounded-md transition-colors ${L===String(t)?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:["+",t]},t))}),e.jsx("input",{type:"number",value:L,onChange:t=>V(t.target.value),placeholder:"Custom",className:"input-field w-20 text-sm py-1"}),e.jsxs("button",{onClick:lt,disabled:he||!L,className:"btn-primary text-sm py-1 px-3 flex items-center gap-1 disabled:opacity-40",children:[he?e.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(ae,{className:"w-3 h-3"}),"Add"]})]})]})]}),e.jsxs("div",{className:"card-steel p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(se,{className:"w-4 h-4 text-blue-400"}),e.jsx("h3",{className:"font-medium text-iron-200",children:"AI Chat Usage"})]}),P?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 bg-iron-800/50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-display text-iron-100",children:P.hourCount}),e.jsx("p",{className:"text-[10px] text-iron-500",children:"Last Hour (limit 8)"})]}),e.jsxs("div",{className:"p-2 bg-iron-800/50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-display text-iron-100",children:P.dayCount}),e.jsx("p",{className:"text-[10px] text-iron-500",children:"Last 24h (limit 25)"})]}),e.jsxs("div",{className:"p-2 bg-iron-800/50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-display text-iron-100",children:P.total}),e.jsx("p",{className:"text-[10px] text-iron-500",children:"All Time"})]})]}),e.jsx("button",{onClick:async()=>{try{const t=U(y,"users",o.uid);await re(t,{rateLimitResetAt:new Date().toISOString()}),F(null),alert("Rate limit reset signal sent. User will see it on next message.")}catch(t){console.error(t),alert("Failed to reset rate limit")}},className:"w-full py-2 text-sm bg-yellow-500/10 text-yellow-400 rounded-lg hover:bg-yellow-500/20 transition-colors",children:"Reset Client Rate Limit"})]}):e.jsx("button",{onClick:async()=>{try{const t=await Ct.getRecentCounts(o.uid);F(t)}catch{F({hourCount:"?",dayCount:"?",total:"?"})}},className:"text-sm text-flame-400 hover:text-flame-300",children:"Load usage data"})]}),e.jsxs("div",{className:"card-steel p-4 rounded-xl",children:[e.jsx("h3",{className:"font-medium text-iron-200 mb-3",children:"User Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-iron-400",children:"Coach Personality"}),e.jsxs("select",{value:o.chatPersonality||"coach",onChange:async t=>{try{const s=U(y,"users",o.uid);await re(s,{chatPersonality:t.target.value}),R(r=>({...r,chatPersonality:t.target.value})),I(r=>r.map(i=>i.uid===o.uid?{...i,chatPersonality:t.target.value}:i))}catch(s){console.error(s)}},className:"input-field text-sm py-1 px-2 w-36",children:[e.jsx("option",{value:"coach",children:"Coach"}),e.jsx("option",{value:"drill-sergeant",children:"Drill Sergeant"}),e.jsx("option",{value:"bro",children:"Gym Bro"}),e.jsx("option",{value:"scientist",children:"Scientist"}),e.jsx("option",{value:"comedian",children:"Trash Talk"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-iron-400",children:"Trainer Status"}),e.jsx("button",{onClick:()=>ve(o.uid||o.id,o.isTrainer),className:`text-sm px-3 py-1 rounded-lg transition-colors ${o.isTrainer?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:o.isTrainer?"Active Trainer":"Not a Trainer"})]})]})]}),e.jsxs("div",{className:"card-steel rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-iron-800",children:[e.jsx("h3",{className:"font-display text-lg text-iron-100",children:"Goals"}),e.jsxs("button",{onClick:()=>C(!0),className:"btn-primary text-sm flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Add Goal"]})]}),e.jsx("div",{className:"p-4",children:Q.length>0?e.jsx("div",{className:"space-y-3",children:Q.map(t=>{var a;const s=t.metricType||"weight",r=((a=k[s])==null?void 0:a.unit)||"lbs",i=t.currentValue??t.currentWeight??0,l=t.targetValue??t.targetWeight??0;return e.jsxs("div",{className:"p-3 bg-iron-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-iron-100",children:t.lift}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.status==="active"?"bg-green-500/20 text-green-400":"bg-iron-700 text-iron-400"}`,children:t.status}),e.jsx("button",{onClick:()=>ht(t),className:"p-1 text-iron-400 hover:text-iron-200 hover:bg-iron-700 rounded",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>xt(t.id),className:"p-1 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded",children:e.jsx(We,{className:"w-4 h-4"})})]})]}),e.jsxs("p",{className:"text-sm text-iron-400",children:[i," → ",l," ",r]}),t.notes&&e.jsx("p",{className:"text-xs text-iron-500 mt-1 italic",children:t.notes})]},t.id)})}):e.jsx("p",{className:"text-iron-500 text-center py-4",children:"No goals set"})})]}),e.jsxs("div",{className:"card-steel rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-iron-800",children:[e.jsx("h3",{className:"font-display text-lg text-iron-100",children:"Recent Workouts"}),e.jsxs("button",{onClick:()=>T(`/workouts/new?userId=${o.uid}`),className:"btn-secondary text-sm flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Create Workout"]})]}),e.jsx("div",{className:"p-4",children:G.length>0?e.jsx("div",{className:"space-y-2",children:G.slice(0,5).map(t=>{var r,i;const s=(r=t.date)!=null&&r.toDate?t.date.toDate():new Date(t.date);return e.jsx("div",{className:"p-3 bg-iron-800/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-iron-100",children:t.name||"Workout"}),e.jsxs("p",{className:"text-sm text-iron-500",children:[O(s,"MMM d, yyyy")," · ",((i=t.exercises)==null?void 0:i.length)||0," exercises",t.workoutType==="cardio"&&` · ${t.duration}min`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.status==="completed"?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:t.workoutType==="cardio"?"cardio":t.status}),e.jsx("button",{onClick:()=>T(`/workouts/${t.id}`),className:"p-1.5 text-iron-400 hover:text-iron-200 hover:bg-iron-700 rounded transition-colors",title:"View/Edit",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>mt(t.id),className:"p-1.5 text-iron-400 hover:text-red-400 hover:bg-red-500/10 rounded transition-colors",title:"Delete",children:e.jsx(We,{className:"w-4 h-4"})})]})]})},t.id)})}):e.jsx("p",{className:"text-iron-500 text-center py-4",children:"No workouts yet"})})]})]}):e.jsxs("div",{className:"card-steel p-12 rounded-xl text-center",children:[e.jsx(te,{className:"w-16 h-16 text-iron-700 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-display text-iron-300 mb-2",children:"Select a User"}),e.jsx("p",{className:"text-iron-500 text-sm",children:"Choose a user from the list to view their details and manage their data"})]})})]})}):h==="activity"?e.jsx("div",{className:"space-y-6",children:Ye?e.jsxs("div",{className:"card-steel p-12 text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-flame-500 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"text-iron-500 mt-4",children:"Loading activity data..."})]}):p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("span",{className:"text-sm text-iron-400",children:"Hide admin activity"}),e.jsx("button",{onClick:()=>Ze(t=>!t),className:`relative w-10 h-5 rounded-full transition-colors ${$?"bg-flame-500":"bg-iron-700"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform ${$?"translate-x-5":""}`})})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card-steel p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-display text-flame-400",children:p.uniqueUsers}),e.jsx("p",{className:"text-sm text-iron-500",children:"Active Users (7d)"})]}),e.jsxs("div",{className:"card-steel p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-display text-iron-100",children:p.totalEvents}),e.jsx("p",{className:"text-sm text-iron-500",children:"Total Events"})]}),e.jsxs("div",{className:"card-steel p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-display text-green-400",children:((Ce=p.actionCounts)==null?void 0:Ce.workout_created)||0}),e.jsx("p",{className:"text-sm text-iron-500",children:"Workouts Created"})]}),e.jsxs("div",{className:"card-steel p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-display text-orange-400",children:((ke=p.actionCounts)==null?void 0:ke.cardio_logged)||0}),e.jsx("p",{className:"text-sm text-iron-500",children:"Cardio Logged"})]})]}),e.jsxs("div",{className:"card-steel p-4",children:[e.jsx("h3",{className:"font-display text-lg text-iron-100 mb-4",children:"Daily Active Users"}),e.jsx("div",{className:"flex items-end gap-2 h-32",children:(Te=p.dailyActiveCounts)==null?void 0:Te.map((t,s)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full bg-flame-500 rounded-t",style:{height:`${Math.max(8,t.count/Math.max(...p.dailyActiveCounts.map(r=>r.count),1)*100)}%`}}),e.jsx("span",{className:"text-xs text-iron-500",children:O(new Date(t.date),"EEE")})]},t.date))})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card-steel p-4",children:[e.jsx("h3",{className:"font-display text-lg text-iron-100 mb-4",children:"Top Pages"}),e.jsx("div",{className:"space-y-2",children:Object.entries(p.pageCounts||{}).sort(([,t],[,s])=>s-t).slice(0,8).map(([t,s])=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-iron-800 last:border-0",children:[e.jsx("span",{className:"text-iron-300 text-sm",children:t}),e.jsx("span",{className:"text-flame-400 font-medium",children:s})]},t))})]}),e.jsxs("div",{className:"card-steel p-4",children:[e.jsx("h3",{className:"font-display text-lg text-iron-100 mb-4",children:"Action Breakdown"}),e.jsx("div",{className:"space-y-2",children:Object.entries(p.actionCounts||{}).sort(([,t],[,s])=>s-t).map(([t,s])=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-iron-800 last:border-0",children:[e.jsx("span",{className:"text-iron-300 text-sm",children:t.replace(/_/g," ")}),e.jsx("span",{className:"text-iron-400 font-medium",children:s})]},t))})]})]}),e.jsxs("div",{className:"card-steel p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-display text-lg text-iron-100",children:"Recent Activity"}),e.jsx("button",{onClick:Ne,className:"text-sm text-flame-400 hover:text-flame-300",children:"Refresh"})]}),e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:(Se=p.recentEvents)==null?void 0:Se.map(t=>{var r,i,l;const s=w.find(a=>a.uid===t.userId);return e.jsxs("div",{className:"flex items-center gap-3 py-2 border-b border-iron-800 last:border-0",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-iron-800 flex items-center justify-center text-iron-400 text-xs",children:((r=s==null?void 0:s.displayName)==null?void 0:r[0])||"?"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm text-iron-200 truncate",children:[e.jsx("span",{className:"text-iron-400",children:(s==null?void 0:s.displayName)||"Unknown"})," · ",e.jsx("span",{className:"text-flame-400",children:t.action.replace(/_/g," ")}),((i=t.metadata)==null?void 0:i.page)&&e.jsxs("span",{className:"text-iron-500",children:[" ",t.metadata.page]})]}),e.jsx("p",{className:"text-xs text-iron-600",children:((l=t.timestamp)==null?void 0:l.toDate)&&Et(t.timestamp.toDate(),{addSuffix:!0})})]})]},t.id)})})]})]}):e.jsxs("div",{className:"card-steel p-12 text-center",children:[e.jsx(se,{className:"w-12 h-12 text-iron-600 mx-auto mb-4"}),e.jsx("p",{className:"text-iron-500",children:"No activity data yet"})]})}):h==="usage"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-steel p-4 flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"text-sm text-iron-400 mb-2 block",children:"Filter by User"}),e.jsxs("select",{value:Z,onChange:t=>et(t.target.value),className:"input-field w-full max-w-xs",children:[e.jsx("option",{value:"",children:"All Users"}),w.map(t=>e.jsx("option",{value:t.uid,children:t.displayName||t.email},t.uid))]})]}),e.jsx("button",{onClick:ye,disabled:je,className:"text-sm text-flame-400 hover:text-flame-300 disabled:opacity-50",children:"Refresh"})]}),je?e.jsxs("div",{className:"card-steel p-12 text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-flame-500 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"text-iron-500 mt-4",children:"Loading usage data..."})]}):e.jsx(e.Fragment,{children:(()=>{const t=Z?ge.filter(a=>a.userId===Z):ge,s=t.reduce((a,m)=>a+(m.totalTokens||0),0),r=t.reduce((a,m)=>a+(m.estimatedCost||0),0),i={},l={"generate-workout":"Workout Gen","generate-group-workout":"Group Gen","ask-assistant":"AI Chat","form-check":"Form Check"};return t.forEach(a=>{const m=l[a.feature]||a.feature||"other";i[m]||(i[m]={tokens:0,requests:0,cost:0}),i[m].tokens+=a.totalTokens||0,i[m].requests+=1,i[m].cost+=a.estimatedCost||0}),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"card-steel p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-display text-flame-400",children:t.length}),e.jsx("p",{className:"text-sm text-iron-500",children:"Total Requests"})]}),e.jsxs("div",{className:"card-steel p-4 text-center",children:[e.jsxs("p",{className:"text-3xl font-display text-iron-100",children:[(s/1e3).toFixed(1),"k"]}),e.jsx("p",{className:"text-sm text-iron-500",children:"Tokens Used"})]}),e.jsxs("div",{className:"card-steel p-4 text-center",children:[e.jsxs("p",{className:"text-3xl font-display text-green-400",children:["$",r.toFixed(4)]}),e.jsx("p",{className:"text-sm text-iron-500",children:"Est. Cost"})]})]}),Object.keys(i).length>0&&e.jsxs("div",{className:"card-steel p-4",children:[e.jsx("p",{className:"text-xs text-iron-500 font-medium uppercase tracking-wider mb-3",children:"Cost by Feature"}),e.jsx("div",{className:"space-y-2",children:Object.entries(i).sort((a,m)=>m[1].cost-a[1].cost).map(([a,m])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${a==="AI Chat"?"bg-purple-400":a==="Workout Gen"?"bg-blue-400":a==="Group Gen"?"bg-cyan-400":"bg-iron-400"}`}),e.jsx("span",{className:"text-sm text-iron-300",children:a})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("span",{className:"text-green-400",children:["$",m.cost.toFixed(4)]}),e.jsxs("span",{className:"text-iron-500 ml-2",children:["(",m.requests,")"]})]})]},a))})]}),e.jsx("div",{className:"card-steel overflow-hidden",children:e.jsx("div",{className:"max-h-[600px] overflow-auto",children:e.jsxs("table",{className:"w-full text-sm min-w-[600px]",children:[e.jsx("thead",{className:"bg-iron-800 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3 text-iron-400 w-8"}),e.jsx("th",{className:"text-left p-3 text-iron-400",children:"User"}),e.jsx("th",{className:"text-left p-3 text-iron-400",children:"Feature"}),e.jsx("th",{className:"text-left p-3 text-iron-400",children:"Date"}),e.jsx("th",{className:"text-right p-3 text-iron-400",children:"Tokens"}),e.jsx("th",{className:"text-right p-3 text-iron-400",children:"Cost"})]})}),e.jsx("tbody",{children:t.slice(0,100).map(a=>{var g,M,b,E,v;const m=w.find(W=>W.uid===a.userId),c=tt===a.id;return e.jsxs(kt.Fragment,{children:[e.jsxs("tr",{className:`border-t border-iron-800 cursor-pointer hover:bg-iron-800/50 transition-colors ${c?"bg-iron-800/30":""}`,onClick:()=>st(c?null:a.id),children:[e.jsx("td",{className:"p-3 text-iron-500",children:e.jsx(Tt,{className:`w-4 h-4 transition-transform ${c?"rotate-180":""}`})}),e.jsx("td",{className:"p-3 text-iron-300",children:(m==null?void 0:m.displayName)||((g=a.userId)==null?void 0:g.slice(0,8))}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a.feature==="ask-assistant"?"bg-purple-500/20 text-purple-400":a.feature==="generate-group-workout"?"bg-cyan-500/20 text-cyan-400":a.feature==="form-check"?"bg-green-500/20 text-green-400":"bg-blue-500/20 text-blue-400"}`,children:a.feature==="generate-workout"?"Workout Gen":a.feature==="generate-group-workout"?"Group Gen":a.feature==="ask-assistant"?"AI Chat":a.feature==="form-check"?"Form Check":a.feature||"unknown"})}),e.jsx("td",{className:"p-3 text-iron-500",children:((M=a.createdAt)==null?void 0:M.toDate)&&O(a.createdAt.toDate(),"MMM d, h:mm a")}),e.jsx("td",{className:"p-3 text-right text-iron-300",children:(b=a.totalTokens)==null?void 0:b.toLocaleString()}),e.jsxs("td",{className:"p-3 text-right text-green-400",children:["$",(a.estimatedCost||0).toFixed(4)]})]}),c&&e.jsx("tr",{className:"border-t border-iron-800/50",children:e.jsx("td",{colSpan:6,className:"p-4 bg-iron-800/20",children:e.jsxs("div",{className:"space-y-4 max-w-3xl",children:[a.userMessage&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-iron-500 mb-1 font-medium",children:"USER MESSAGE"}),e.jsx("div",{className:"bg-iron-800 rounded-lg p-3 text-iron-300 text-sm",children:a.userMessage})]}),a.assistantResponse&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-iron-500 mb-1 font-medium",children:"ASSISTANT RESPONSE"}),e.jsx("div",{className:"bg-flame-500/10 border border-flame-500/20 rounded-lg p-3 text-iron-300 text-sm whitespace-pre-wrap",children:a.assistantResponse})]}),!a.userMessage&&!a.assistantResponse&&e.jsx("p",{className:"text-iron-500 text-sm italic",children:"No message data available (older request or different feature)"}),e.jsxs("div",{className:"flex gap-4 text-xs text-iron-500 pt-2 border-t border-iron-800",children:[e.jsxs("span",{children:["Model: ",a.model||"gpt-4o-mini"]}),e.jsxs("span",{children:["Prompt: ",(E=a.promptTokens)==null?void 0:E.toLocaleString()," tokens"]}),e.jsxs("span",{children:["Completion: ",(v=a.completionTokens)==null?void 0:v.toLocaleString()," tokens"]}),a.responseTimeMs&&e.jsxs("span",{children:["Response time: ",a.responseTimeMs,"ms"]})]})]})})})]},a.id)})})]})})})]})})()})]}):null,h==="settings"&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsxs("div",{className:"card-steel p-6",children:[e.jsxs("h2",{className:"text-xl font-display text-iron-100 mb-6 flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-flame-500"}),"AI Workout Generation Settings"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-iron-800/50 rounded-xl",children:[e.jsx("h3",{className:"font-medium text-iron-200 mb-4",children:"Pain Detection Thresholds"}),e.jsx("p",{className:"text-sm text-iron-500 mb-4",children:"Control when exercises are flagged for substitution based on pain history."}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Minimum Pain Level (1-10)"}),e.jsx("input",{type:"number",min:"1",max:"10",value:d.painThresholdMin,onChange:t=>f(s=>({...s,painThresholdMin:parseInt(t.target.value)||3})),className:"input-field w-full"}),e.jsxs("p",{className:"text-xs text-iron-600 mt-1",children:["Pain level that triggers a flag (currently: ≥",d.painThresholdMin,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Recurring Pain Count"}),e.jsx("input",{type:"number",min:"1",max:"10",value:d.painThresholdCount,onChange:t=>f(s=>({...s,painThresholdCount:parseInt(t.target.value)||2})),className:"input-field w-full"}),e.jsxs("p",{className:"text-xs text-iron-600 mt-1",children:["Times pain reported to trigger flag (currently: ≥",d.painThresholdCount,")"]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-iron-900/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-iron-400",children:[e.jsx("strong",{className:"text-iron-300",children:"Current Logic:"})," Flag exercise if pain ≥",d.painThresholdMin,"/10 OR reported ≥",d.painThresholdCount," times"]})})]}),e.jsxs("div",{className:"p-4 bg-iron-800/50 rounded-xl",children:[e.jsx("h3",{className:"font-medium text-iron-200 mb-4",children:"Default AI Model"}),e.jsx("p",{className:"text-sm text-iron-500 mb-4",children:"Set the default model for AI workout generation."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>f(t=>({...t,defaultModel:"standard"})),className:`flex-1 py-3 px-4 rounded-lg text-sm font-medium transition-colors ${d.defaultModel==="standard"?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:[e.jsx("div",{className:"font-semibold",children:"Standard"}),e.jsx("div",{className:"text-xs opacity-75 mt-1",children:"GPT-4o-mini (~$0.001/workout)"})]}),e.jsxs("button",{type:"button",onClick:()=>f(t=>({...t,defaultModel:"premium"})),className:`flex-1 py-3 px-4 rounded-lg text-sm font-medium transition-colors ${d.defaultModel==="premium"?"bg-purple-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:[e.jsx("div",{className:"font-semibold",children:"Premium"}),e.jsx("div",{className:"text-xs opacity-75 mt-1",children:"GPT-4o (~$0.02/workout)"})]})]})]}),e.jsxs("div",{className:"p-4 bg-iron-800/50 rounded-xl",children:[e.jsx("h3",{className:"font-medium text-iron-200 mb-4",children:"Chat Rate Limits"}),e.jsxs("p",{className:"text-sm text-iron-500 mb-4",children:["Users can keep messaging after hitting the limit, but each message costs ",d.overageCreditMultiplier,"x credits."]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"Hourly Limit"}),e.jsx("input",{type:"number",min:"1",max:"100",value:d.rateLimitHourly,onChange:t=>f(s=>({...s,rateLimitHourly:parseInt(t.target.value)||8})),className:"input-field w-full"}),e.jsx("p",{className:"text-[10px] text-iron-600 mt-1",children:"msgs/hour"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"Daily Limit"}),e.jsx("input",{type:"number",min:"1",max:"500",value:d.rateLimitDaily,onChange:t=>f(s=>({...s,rateLimitDaily:parseInt(t.target.value)||25})),className:"input-field w-full"}),e.jsx("p",{className:"text-[10px] text-iron-600 mt-1",children:"msgs/day"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"Overage Multiplier"}),e.jsx("input",{type:"number",min:"1",max:"10",value:d.overageCreditMultiplier,onChange:t=>f(s=>({...s,overageCreditMultiplier:parseInt(t.target.value)||3})),className:"input-field w-full"}),e.jsx("p",{className:"text-[10px] text-iron-600 mt-1",children:"x credit cost"})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-iron-900/50 rounded-lg",children:e.jsxs("p",{className:"text-xs text-iron-500",children:["After ",d.rateLimitHourly,"/hr or ",d.rateLimitDaily,"/day, each message costs ",d.overageCreditMultiplier," credits instead of 1"]})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-iron-800",children:[e.jsx("div",{className:"text-sm text-iron-500",children:Xe&&e.jsxs("span",{className:"text-green-400 flex items-center gap-1",children:[e.jsx(Ge,{className:"w-4 h-4"})," Settings saved!"]})}),e.jsx("button",{onClick:ot,disabled:xe,className:"btn-primary flex items-center gap-2",children:xe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ut,{className:"w-4 h-4"}),"Save Settings"]})})]})]})]}),e.jsxs("div",{className:"card-steel p-6 mt-6",children:[e.jsxs("h2",{className:"text-xl font-display text-iron-100 mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-purple-500"}),"Dev Tools"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-iron-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-iron-200",children:"Reset onboarding checklist"}),e.jsx("p",{className:"text-xs text-iron-500",children:"Clears claimed tasks so the checklist shows again on Today"})]}),e.jsx("button",{onClick:async()=>{try{const{updateDoc:t,doc:s}=await Pe(async()=>{const{updateDoc:i,doc:l}=await import("./index-BH1MXG3y.js").then(a=>a.b2);return{updateDoc:i,doc:l}},__vite__mapDeps([0,1])),{db:r}=await Pe(async()=>{const{db:i}=await import("./index-BH1MXG3y.js").then(l=>l.b3);return{db:i}},__vite__mapDeps([0,1]));await t(s(r,"users",ie.uid),{onboardingChecklist:{}}),alert("Checklist reset! Go to Today to see it.")}catch(t){alert("Error: "+t.message)}},className:"px-3 py-1.5 text-xs rounded-lg bg-purple-500/20 text-purple-400 border border-purple-500/30 hover:bg-purple-500/30 transition-colors",children:"Reset"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-iron-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-iron-200",children:"Preview login page"}),e.jsx("p",{className:"text-xs text-iron-500",children:"View the landing page without logging out"})]}),e.jsx("a",{href:"/login?preview",className:"px-3 py-1.5 text-xs rounded-lg bg-purple-500/20 text-purple-400 border border-purple-500/30 hover:bg-purple-500/30 transition-colors",children:"Preview"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-iron-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-iron-200",children:"Preview onboarding flow"}),e.jsx("p",{className:"text-xs text-iron-500",children:"View the new-user onboarding without resetting your profile"})]}),e.jsx("a",{href:"/onboarding?preview",className:"px-3 py-1.5 text-xs rounded-lg bg-purple-500/20 text-purple-400 border border-purple-500/30 hover:bg-purple-500/30 transition-colors",children:"Preview"})]})]})]})]}),h==="trainers"&&e.jsxs("div",{className:"max-w-2xl space-y-6",children:[e.jsxs("div",{className:"card-steel p-6",children:[e.jsx("h2",{className:"font-display text-lg text-iron-100 mb-4",children:"Pending Applications"}),Ke?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-iron-500 py-4",children:[e.jsx(Fe,{className:"w-4 h-4 animate-spin"}),"Loading applications..."]}):K.length===0?e.jsx("p",{className:"text-sm text-iron-500 py-4",children:"No pending applications."}):e.jsx("div",{className:"space-y-3",children:K.map(t=>{var s,r,i;return e.jsxs("div",{className:"p-4 bg-iron-800/50 rounded-xl border border-iron-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-iron-200",children:t.displayName||t.email}),e.jsx("p",{className:"text-xs text-iron-500",children:t.email})]}),e.jsx("span",{className:"text-xs text-iron-600",children:(s=t.createdAt)!=null&&s.toDate?O((i=(r=t.createdAt)==null?void 0:r.toDate)==null?void 0:i.call(r),"MMM d"):""})]}),t.notes&&e.jsx("p",{className:"text-sm text-iron-400 mb-3 p-2 bg-iron-900/50 rounded",children:t.notes}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>be(t.id,"approved"),disabled:X===t.id,className:`flex-1 py-2 bg-green-500/20 text-green-400 rounded-lg text-sm font-medium
                          hover:bg-green-500/30 transition-colors disabled:opacity-50 flex items-center justify-center gap-1.5`,children:[X===t.id?e.jsx(Fe,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(Ge,{className:"w-3.5 h-3.5"}),"Approve"]}),e.jsx("button",{onClick:()=>be(t.id,"denied"),disabled:X===t.id,className:`flex-1 py-2 bg-red-500/10 text-red-400 rounded-lg text-sm font-medium
                          hover:bg-red-500/20 transition-colors disabled:opacity-50`,children:"Deny"})]})]},t.id)})})]}),e.jsxs("div",{className:"card-steel p-6",children:[e.jsx("h2",{className:"font-display text-lg text-iron-100 mb-4",children:"Active Trainers"}),e.jsxs("div",{className:"space-y-2",children:[w.filter(t=>t.isTrainer||t.email==="charltonuw@gmail.com").map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-iron-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-iron-700 flex items-center justify-center overflow-hidden",children:t.photoURL?e.jsx("img",{src:t.photoURL,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx(te,{className:"w-4 h-4 text-iron-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-iron-200",children:t.displayName||t.email}),e.jsx("p",{className:"text-xs text-iron-500",children:t.email==="charltonuw@gmail.com"?"Admin (always trainer)":"Approved trainer"})]})]}),t.email!=="charltonuw@gmail.com"&&e.jsx("button",{onClick:()=>ve(t.id,t.isTrainer),className:"text-xs px-3 py-1 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500/20 transition-colors",children:"Remove"})]},t.id)),w.filter(t=>t.isTrainer||t.email==="charltonuw@gmail.com").length===0&&e.jsx("p",{className:"text-sm text-iron-500",children:"No active trainers besides admin."})]})]})]}),ze&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>C(!1)}),e.jsxs("div",{className:"relative bg-iron-900 border border-iron-700 rounded-2xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{onClick:()=>C(!1),className:"absolute top-4 right-4 text-iron-500 hover:text-iron-300",children:e.jsx(St,{className:"w-5 h-5"})}),e.jsxs("h2",{className:"text-xl font-display text-iron-100 mb-2",children:[A?"Edit":"Create"," Goal for ",j==null?void 0:j.displayName]}),e.jsx("p",{className:"text-sm text-iron-500 mb-6",children:A?"Update this goal":"This goal will be added to the user's account"}),e.jsxs("form",{onSubmit:dt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-400 mb-2",children:"Exercise *"}),e.jsxs("select",{value:x.lift,onChange:t=>N(s=>({...s,lift:t.target.value})),className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select an exercise"}),at.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-400 mb-2",children:"Goal Type"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(k).map(([t,{label:s}])=>e.jsx("button",{type:"button",onClick:()=>N(r=>({...r,metricType:t})),className:`py-2 px-3 rounded-lg text-sm font-medium transition-colors ${x.metricType===t?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:s},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-iron-400 mb-2",children:["Current ",k[x.metricType].label," (",k[x.metricType].unit,")"]}),e.jsx("input",{type:"number",value:x.currentValue,onChange:t=>N(s=>({...s,currentValue:t.target.value})),className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-iron-400 mb-2",children:["Target ",k[x.metricType].label," (",k[x.metricType].unit,") *"]}),e.jsx("input",{type:"number",value:x.targetValue,onChange:t=>N(s=>({...s,targetValue:t.target.value})),className:"input-field w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-400 mb-2",children:"Target Date *"}),e.jsx("input",{type:"date",value:x.targetDate,onChange:t=>N(s=>({...s,targetDate:t.target.value})),className:"input-field w-full",min:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-400 mb-2",children:"Notes (optional)"}),e.jsx("input",{type:"text",value:x.notes,onChange:t=>N(s=>({...s,notes:t.target.value})),placeholder:"e.g., with pause, 20lb vest",className:"input-field w-full"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>C(!1),className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!x.lift||!x.targetValue||!x.targetDate,className:"btn-primary flex-1",children:"Create Goal"})]})]})]})]})]}):null}export{Bt as default};

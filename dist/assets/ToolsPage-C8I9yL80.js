import{d as H,r as c,a3 as J,g as Z,Q as ee,j as e,L as b,a4 as te,a5 as G,a6 as se,N as ae,a7 as re,I as le,K as ne}from"./index-DngWaF3c.js";import{I as ie}from"./info-A1JU0cij.js";import{s as S}from"./index-CNvf9wai.js";const ce=["Bench Press","Squat","Deadlift","Overhead Press","Barbell Row","Incline Bench Press","Close Grip Bench","Front Squat","Romanian Deadlift"],W={epley:{name:"Epley",calc:(s,n)=>s*(1+n/30),description:"Most common formula, good for moderate rep ranges"},brzycki:{name:"Brzycki",calc:(s,n)=>s*(36/(37-n)),description:"Accurate for lower rep ranges (1-10)"},lombardi:{name:"Lombardi",calc:(s,n)=>s*Math.pow(n,.1),description:"Simple formula, tends to estimate conservatively"},oconner:{name:"O'Conner",calc:(s,n)=>s*(1+n/40),description:"Similar to Epley but more conservative"}},oe=s=>[{reps:1,percent:100,weight:s},{reps:2,percent:97,weight:s*.97},{reps:3,percent:94,weight:s*.94},{reps:4,percent:92,weight:s*.92},{reps:5,percent:89,weight:s*.89},{reps:6,percent:86,weight:s*.86},{reps:7,percent:83,weight:s*.83},{reps:8,percent:81,weight:s*.81},{reps:9,percent:78,weight:s*.78},{reps:10,percent:75,weight:s*.75},{reps:12,percent:69,weight:s*.69},{reps:15,percent:61,weight:s*.61}];function he(){const{user:s,isGuest:n}=H(),[v,L]=c.useState(""),[w,U]=c.useState(""),[E,V]=c.useState(""),[y,$]=c.useState("epley"),[C,R]=c.useState(!1),[D,q]=c.useState([]),[F,z]=c.useState([]),[B,I]=c.useState(!0),[A,K]=c.useState("4weeks");c.useEffect(()=>{s&&!n?Q():I(!1)},[s,n]);const Q=async()=>{try{const[t,a,i]=await Promise.all([J.getByUser(s.uid),Z.getByUser(s.uid),ee.getByUser(s.uid)]);q([...t,...a]),z(i)}catch(t){console.error("Error loading analytics:",t)}finally{I(!1)}},X=()=>{const t=new Date,i={"1week":7,"4weeks":28,"12weeks":84}[A],g=S(t,i),x=D.filter(r=>{var o,p;return(((p=(o=r.date)==null?void 0:o.toDate)==null?void 0:p.call(o))||new Date(r.date))>=g}),k=Math.ceil(i/7),Y=(x.length/k).toFixed(1);let P=0,O=0;const N={};x.forEach(r=>{var m;(m=r.exercises)==null||m.forEach(o=>{var p;(p=o.sets)==null||p.forEach(d=>{if(d.completed!==!1){P++;const j=parseFloat(d.actualWeight??d.weight)||0,h=parseInt(d.actualReps??d.reps)||0;O+=j*h;const u=o.name||"Unknown";N[u]||(N[u]=0),N[u]+=j*h}})})});const _=Object.entries(N).sort((r,m)=>m[1]-r[1]).slice(0,5),T=[];for(let r=k-1;r>=0;r--){const m=S(t,(r+1)*7),o=S(t,r*7),p=x.filter(d=>{var h,u;const j=((u=(h=d.date)==null?void 0:h.toDate)==null?void 0:u.call(h))||new Date(d.date);return j>=m&&j<o}).length;T.push({week:k-r,count:p})}return{totalWorkouts:x.length,workoutsPerWeek:Y,totalSets:P,totalVolume:Math.round(O),topExercises:_,weeklyData:T,activeGoals:F.filter(r=>r.status==="active").length,completedGoals:F.filter(r=>r.status==="completed").length}},l=!B&&D.length>0?X():null,f=(()=>{const t=parseFloat(v),a=parseInt(w);return!t||!a||a<1?null:a===1?t:a>30?null:W[y].calc(t,a)})(),M=f?oe(f):null;return e.jsxs("div",{className:"max-w-2xl mx-auto pb-24",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-display text-iron-100",children:"Tools"}),e.jsx("p",{className:"text-iron-500 text-sm mt-1",children:"Training calculators and utilities"})]}),e.jsxs(b,{to:"/form-check",className:"card-steel rounded-xl p-4 mb-6 flex items-center gap-4 hover:bg-iron-800/80 transition-colors group",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-500/20 flex items-center justify-center",children:e.jsx(te,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h2",{className:"font-display text-lg text-iron-100 flex items-center gap-2",children:["Form Check",e.jsx("span",{className:"text-[10px] font-semibold px-1.5 py-0.5 rounded-full bg-purple-500/20 text-purple-400 uppercase",children:"Beta"})]}),e.jsx("p",{className:"text-iron-500 text-sm",children:"Upload a video for AI-powered frame-by-frame form analysis"})]}),e.jsx(G,{className:"w-5 h-5 text-iron-600 group-hover:text-iron-400 transition-colors"})]}),e.jsxs("div",{className:"card-steel rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-iron-800 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-flame-500/20 flex items-center justify-center",children:e.jsx(se,{className:"w-5 h-5 text-flame-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-lg text-iron-100",children:"1RM Calculator"}),e.jsx("p",{className:"text-iron-500 text-sm",children:"Estimate your one-rep max"})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-300 mb-2",children:"Exercise (optional)"}),e.jsxs("select",{value:E,onChange:t=>V(t.target.value),className:"input-field w-full text-base py-3",children:[e.jsx("option",{value:"",children:"Select exercise..."}),ce.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-300 mb-2",children:"Weight (lbs)"}),e.jsx("input",{type:"number",inputMode:"decimal",value:v,onChange:t=>L(t.target.value),placeholder:"225",className:"input-field w-full text-base py-3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-300 mb-2",children:"Reps Completed"}),e.jsx("input",{type:"number",inputMode:"numeric",value:w,onChange:t=>U(t.target.value),placeholder:"5",min:"1",max:"30",className:"input-field w-full text-base py-3"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-iron-300",children:"Formula"}),e.jsx("button",{onClick:()=>R(!C),className:"text-iron-500 hover:text-iron-300 transition-colors",children:e.jsx(ie,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(W).map(([t,{name:a}])=>e.jsx("button",{onClick:()=>$(t),className:`py-2 px-3 rounded-lg text-sm font-medium transition-colors ${y===t?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:a},t))}),C&&e.jsx("p",{className:"text-xs text-iron-500 mt-2",children:W[y].description})]}),f&&e.jsxs("div",{className:"mt-6 p-6 bg-gradient-to-br from-flame-500/20 to-flame-600/10 rounded-xl text-center",children:[e.jsxs("p",{className:"text-iron-400 text-sm mb-1",children:[E||"Estimated"," 1RM"]}),e.jsxs("p",{className:"text-4xl font-display text-flame-400",children:[Math.round(f)," ",e.jsx("span",{className:"text-xl text-iron-400",children:"lbs"})]}),e.jsxs("p",{className:"text-iron-500 text-sm mt-2",children:["Based on ",v," lbs Ã— ",w," reps"]})]}),M&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-iron-300 mb-3",children:"Training Weights"}),e.jsxs("div",{className:"bg-iron-800/50 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-px bg-iron-700 text-xs font-medium text-iron-400",children:[e.jsx("div",{className:"bg-iron-800 p-2 text-center",children:"Reps"}),e.jsx("div",{className:"bg-iron-800 p-2 text-center",children:"% of 1RM"}),e.jsx("div",{className:"bg-iron-800 p-2 text-center",children:"Weight"})]}),M.map(({reps:t,percent:a,weight:i})=>e.jsxs("div",{className:`grid grid-cols-3 gap-px text-sm ${t===1?"bg-flame-500/10":""}`,children:[e.jsx("div",{className:`p-2 text-center ${t===1?"text-flame-400 font-medium":"text-iron-300"}`,children:t}),e.jsxs("div",{className:`p-2 text-center ${t===1?"text-flame-400 font-medium":"text-iron-400"}`,children:[a,"%"]}),e.jsxs("div",{className:`p-2 text-center ${t===1?"text-flame-400 font-medium":"text-iron-200"}`,children:[Math.round(i)," lbs"]})]},t))]}),e.jsx("p",{className:"text-xs text-iron-600 mt-2 text-center",children:"Use these percentages to plan your working sets"})]})]})]}),e.jsxs("div",{className:"mt-6 card-steel rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-iron-800 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-500/20 flex items-center justify-center",children:e.jsx(ae,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-lg text-iron-100",children:"Smart Analytics"}),e.jsx("p",{className:"text-iron-500 text-sm",children:"Your training insights"})]})]}),e.jsx("div",{className:"p-4",children:n?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(re,{className:"w-10 h-10 text-iron-700 mx-auto mb-2"}),e.jsx("p",{className:"text-iron-500 text-sm mb-4",children:"Sign in to see your training analytics"}),e.jsx(b,{to:"/login",className:"btn-primary text-sm",children:"Sign In"})]}):B?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-flame-500 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"text-iron-500 text-sm mt-2",children:"Loading analytics..."})]}):l?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex gap-2",children:[{value:"1week",label:"1 Week"},{value:"4weeks",label:"4 Weeks"},{value:"12weeks",label:"12 Weeks"}].map(({value:t,label:a})=>e.jsx("button",{onClick:()=>K(t),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${A===t?"bg-green-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:a},t))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-iron-800/50 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-display text-green-400",children:l.totalWorkouts}),e.jsx("p",{className:"text-xs text-iron-500",children:"Workouts"})]}),e.jsxs("div",{className:"bg-iron-800/50 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-display text-green-400",children:l.workoutsPerWeek}),e.jsx("p",{className:"text-xs text-iron-500",children:"Per Week"})]}),e.jsxs("div",{className:"bg-iron-800/50 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-display text-flame-400",children:l.totalSets}),e.jsx("p",{className:"text-xs text-iron-500",children:"Total Sets"})]}),e.jsxs("div",{className:"bg-iron-800/50 rounded-xl p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-display text-flame-400",children:[(l.totalVolume/1e3).toFixed(0),"k"]}),e.jsx("p",{className:"text-xs text-iron-500",children:"Volume (lbs)"})]})]}),l.weeklyData.length>1&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-iron-400 mb-3",children:"Workouts Per Week"}),e.jsx("div",{className:"h-24 flex items-end gap-1",children:l.weeklyData.map((t,a)=>{const i=Math.max(...l.weeklyData.map(x=>x.count),1),g=t.count/i*100;return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full bg-gradient-to-t from-green-600 to-green-400 rounded-t transition-all",style:{height:`${Math.max(g,4)}%`}}),e.jsxs("span",{className:"text-[10px] text-iron-600",children:["W",t.week]})]},a)})})]}),l.topExercises.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-iron-400 mb-3",children:"Top Exercises by Volume"}),e.jsx("div",{className:"space-y-2",children:l.topExercises.map(([t,a],i)=>{const g=l.topExercises[0][1],x=a/g*100;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-iron-500 w-4",children:i+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm text-iron-300 truncate",children:t}),e.jsxs("span",{className:"text-xs text-iron-500",children:[(a/1e3).toFixed(1),"k lbs"]})]}),e.jsx("div",{className:"h-1.5 bg-iron-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-flame-500 rounded-full",style:{width:`${x}%`}})})]})]},t)})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-iron-800/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ne,{className:"w-5 h-5 text-purple-400"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-iron-300",children:[l.activeGoals," Active Goals"]}),e.jsxs("p",{className:"text-xs text-iron-500",children:[l.completedGoals," completed"]})]})]}),e.jsx(b,{to:"/goals",className:"text-flame-400 hover:text-flame-300",children:e.jsx(G,{className:"w-5 h-5"})})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(le,{className:"w-10 h-10 text-iron-700 mx-auto mb-2"}),e.jsx("p",{className:"text-iron-500 text-sm mb-4",children:"Complete some workouts to see analytics"}),e.jsx(b,{to:"/workouts/new",className:"btn-primary text-sm",children:"Log a Workout"})]})})]})]})}export{he as default};

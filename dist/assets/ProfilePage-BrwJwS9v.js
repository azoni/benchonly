import{a as ns,u as ls,d as rs,b as is,c as cs,r as x,ag as de,ah as d,h as u,a3 as os,g as ds,Q as xs,ab as ms,j as e,i as D,ac as O,A as us,z as Q,L as k,t as xe,U as Ie,C as ue,X as me,D as he,l as hs,n as Le,K as Te,k as Ae,F as Me,ai as fs,af as Ue,aj as ps,V as Ns,Y as gs,$ as js,ak as X,I as bs,al as vs,am as ys,an as J}from"./index-BtJ8VAyI.js";import{g as ws,F as Ss}from"./wodLibrary-BricFkkX.js";import{L as ks}from"./lock-uJWGzprt.js";import{U as Es}from"./user-minus-Dre7K6sQ.js";import{C as fe}from"./clock-JSYsXT53.js";import{S as qe}from"./search-Dg433EWL.js";import{T as Oe}from"./trophy-C27vOsX-.js";import{C as Rs}from"./chevron-left-F6uQP_mc.js";import{s as Cs,a as Ds,i as Fs,b as Ps}from"./index-Rq9K6Xhu.js";import{f as Is}from"./index-D7emZy7Z.js";import{e as Ls}from"./index-52vbWmRk.js";import{e as Ts}from"./index-B8ZrzbsR.js";function As({friendStatus:g,loading:l,onAction:U}){if(!g)return null;const V={[d.NONE]:{label:"Add Friend",icon:he,className:"bg-flame-500/20 text-flame-400 hover:bg-flame-500/30"},[d.PENDING_SENT]:{label:"Pending",icon:fe,className:"bg-iron-700 text-iron-300 hover:bg-iron-600"},[d.PENDING_RECEIVED]:{label:"Accept",icon:ue,className:"bg-green-500/20 text-green-400 hover:bg-green-500/30"},[d.FRIENDS]:{label:"Friends",icon:Ue,className:"bg-blue-500/10 text-blue-400 hover:bg-red-500/10 hover:text-red-400"}},F=V[g.status]||V[d.NONE],P=F.icon;return e.jsxs("button",{onClick:U,disabled:l,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${F.className}`,children:[l?e.jsx(D,{className:"w-4 h-4 animate-spin"}):e.jsx(P,{className:"w-4 h-4"}),F.label]})}function Ys(){var ke,Ee,Re;const{userId:g}=ns();ls("Profile");const{user:l,isRealAdmin:U,updateProfile:V}=rs(),F=is(),P=cs(),[o,$]=x.useState(null),[Ve,G]=x.useState(!0),[I,$e]=x.useState(null),[pe,Ge]=x.useState([]),[b,We]=x.useState(!1),[L,Ne]=x.useState(new Date),[_e,Be]=x.useState([]),[W,Ke]=x.useState([]),[Z,He]=x.useState(!1),[T,ge]=x.useState(!1),[c,E]=x.useState(null),[ee,_]=x.useState(!1),[se,B]=x.useState(0),[te,je]=x.useState("overview"),[A,be]=x.useState([]),[M,ae]=x.useState([]),[K,ne]=x.useState([]),[le,ve]=x.useState(!1),[H,ye]=x.useState("friends"),[Y,Ye]=x.useState(""),[re,ze]=x.useState([]),[v,we]=x.useState({}),ie=()=>{var s;(s=P.state)!=null&&s.from?F(P.state.from):F(-1)},Qe=((ke=P.state)==null?void 0:ke.fromLabel)||"Back";x.useEffect(()=>{Se()},[g,l]);const Se=async()=>{G(!0);try{let s=null,t=null;if(g?(s=await de.getByUsername(g),s?t=s.uid:(s=await de.get(g),t=g)):(t=l==null?void 0:l.uid,s=await de.get(t)),We(t===(l==null?void 0:l.uid)),!s){$(null),G(!1);return}let i={status:d.NONE};if(l&&t!==l.uid)try{i=await u.getFriendshipStatus(l.uid,t),E(i)}catch(h){console.error("Friend status error:",h)}try{const h=await u.getFriendCount(t);if(B(h),t===(l==null?void 0:l.uid)){const w=await u.getReceivedRequests(l.uid);ae(w)}}catch(h){console.error("Friend count error:",h)}const a=s.defaultVisibility||(s.isPrivate?"private":"public"),n=i.status===d.FRIENDS;if(!(t===(l==null?void 0:l.uid)||U||a==="public"||a==="friends"&&n)){$({...s,isPrivate:!0,defaultVisibility:a,uid:t}),G(!1);return}$(s);const[r,f]=await Promise.all([os.getByUser(t,500),ds.getByUser(t)]),R=r.filter(h=>h.status==="completed"),y=f.filter(h=>h.status==="completed"),C=[...R,...y];Be([...r,...f]);const p={bench:0,squat:0,deadlift:0},N={bench:null,squat:null,deadlift:null},ss=(h,w)=>!h||!w||w<1?0:w===1?h:Math.round(h*(1+w/30));C.forEach(h=>{h.exercises&&h.exercises.forEach(w=>{var Ce,De;const j=((Ce=w.name)==null?void 0:Ce.toLowerCase())||"";let S=null;j.includes("bench")&&!j.includes("incline")&&!j.includes("decline")?S="bench":j.includes("squat")&&!j.includes("front")&&!j.includes("hack")?S="squat":j.includes("deadlift")&&!j.includes("romanian")&&!j.includes("rdl")&&!j.includes("stiff")&&(S="deadlift"),S&&((De=w.sets)==null||De.forEach(z=>{const oe=parseFloat(z.actualWeight)||parseFloat(z.prescribedWeight)||0,Fe=parseInt(z.actualReps)||parseInt(z.prescribedReps)||1;p[S]=Math.max(p[S],oe);const Pe=ss(oe,Fe);(!N[S]||Pe>N[S].e1rm)&&(N[S]={weight:oe,reps:Fe,e1rm:Pe})}))})}),$e({totalWorkouts:C.length,bench:p.bench,squat:p.squat,deadlift:p.deadlift,total:p.bench+p.squat+p.deadlift,bestSets:N});const ts=await xs.getByUser(t);Ke(ts.filter(h=>h.status==="active"));const as=await ms.getFeed(5,null,t);Ge(as.items)}catch(s){console.error("Error loading profile:",s)}finally{G(!1)}},ce=async()=>{if(!(!l||le)){ve(!0);try{const s=await Ns(gs(js,"users")),t={},i=[];s.docs.forEach(r=>{const f={id:r.id,uid:r.id,...r.data()};t[r.id]=f,r.id!==l.uid&&i.push(f)}),ze(i);const[a,n,m]=await Promise.all([u.getFriends(l.uid),u.getReceivedRequests(l.uid),u.getSentRequests(l.uid)]);be(a.map(r=>t[r]).filter(Boolean)),ae(n),ne(m),B(a.length)}catch(s){console.error("Error loading friends:",s)}finally{ve(!1)}}},q=async(s,t,i)=>{we(a=>({...a,[t]:!0}));try{if(s==="accept")await u.acceptRequest(t),await ce();else if(s==="decline")await u.declineRequest(t),ae(a=>a.filter(n=>n.id!==t));else if(s==="cancel")await u.cancelRequest(t),ne(a=>a.filter(n=>n.id!==t));else if(s==="remove"){if(!confirm("Remove this friend?"))return;await u.removeFriend(l.uid,t),be(a=>a.filter(n=>(n.uid||n.id)!==t)),B(a=>Math.max(0,a-1))}else if(s==="send"){await u.sendRequest(l.uid,t);const a=await u.getSentRequests(l.uid);ne(a)}}catch(a){console.error("Friend action error:",a),alert(a.message)}finally{we(a=>({...a,[t]:!1}))}},Xe=s=>{switch(s){case X.WORKOUT:return e.jsx(bs,{className:"w-4 h-4 text-green-400"});case X.CARDIO:return e.jsx(xe,{className:"w-4 h-4 text-orange-400"});case X.GOAL_COMPLETED:return e.jsx(Oe,{className:"w-4 h-4 text-yellow-400"});case X.GOAL_CREATED:return e.jsx(Te,{className:"w-4 h-4 text-purple-400"});default:return e.jsx(xe,{className:"w-4 h-4 text-iron-400"})}},Je=()=>{const s=vs(Ps(L),{weekStartsOn:1}),t=ys(Ls(L),{weekStartsOn:1});return Ts({start:s,end:t})},Ze=s=>{const t=J(s);return _e.filter(i=>{var n;const a=(n=i.date)!=null&&n.toDate?i.date.toDate():new Date(i.date);return J(a)===t})},es=s=>{const t=J(s);return W.find(i=>J(i.targetDate)===t)};if(Ve)return e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(D,{className:"w-8 h-8 text-flame-500 animate-spin"})});if(!o)return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-12 text-center",children:[e.jsx(O,{className:"w-16 h-16 text-iron-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-display text-iron-200 mb-2",children:"User Not Found"}),e.jsx("p",{className:"text-iron-500 mb-6",children:"This user doesn't exist or has been deleted."}),e.jsx("button",{onClick:ie,className:"btn-primary",children:"Go Back"})]});if(o.isPrivate&&!b){const s=async()=>{if(l){_(!0);try{!c||c.status===d.NONE?(await u.sendRequest(l.uid,o.uid||g),E({status:d.PENDING_SENT})):c.status===d.PENDING_SENT?(await u.cancelRequest(c.requestId),E({status:d.NONE})):c.status===d.PENDING_RECEIVED&&(await u.acceptRequest(c.requestId),E({status:d.FRIENDS}),Se())}catch(t){console.error("Friend action error:",t)}finally{_(!1)}}};return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-12 text-center",children:[e.jsx(ks,{className:"w-16 h-16 text-iron-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-display text-iron-200 mb-2",children:o.defaultVisibility==="friends"?"Friends Only":"Private Profile"}),e.jsx("p",{className:"text-iron-500 mb-6",children:o.defaultVisibility==="friends"?"This user only shares their activity with friends.":"This user has set their profile to private."}),l&&o.defaultVisibility==="friends"&&e.jsxs("button",{onClick:s,disabled:ee||(c==null?void 0:c.status)===d.FRIENDS,className:`px-4 py-2 rounded-lg font-medium text-sm transition-colors mb-4 ${(c==null?void 0:c.status)===d.PENDING_SENT?"bg-iron-700 text-iron-300 hover:bg-iron-600":(c==null?void 0:c.status)===d.PENDING_RECEIVED?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-flame-500/20 text-flame-400 hover:bg-flame-500/30"}`,children:[ee?e.jsx(D,{className:"w-4 h-4 animate-spin inline mr-1"}):null,(c==null?void 0:c.status)===d.PENDING_SENT?"Cancel Request":(c==null?void 0:c.status)===d.PENDING_RECEIVED?"Accept Friend Request":"Send Friend Request"]}),e.jsx("br",{}),e.jsx("button",{onClick:ie,className:"btn-primary",children:"Go Back"})]})}return e.jsxs("div",{className:"max-w-2xl mx-auto pb-24",children:[((Ee=P.state)==null?void 0:Ee.from)&&e.jsxs("button",{onClick:ie,className:"inline-flex items-center gap-2 text-iron-400 hover:text-iron-200 mb-6",children:[e.jsx(us,{className:"w-4 h-4"}),Qe]}),e.jsx("div",{className:"card-steel p-6 mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-iron-800 flex items-center justify-center",children:o.photoURL?e.jsx("img",{src:o.photoURL,alt:"",className:"w-20 h-20 rounded-full"}):e.jsx(O,{className:"w-10 h-10 text-iron-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h1",{className:"text-2xl font-display text-iron-100",children:[o.displayName||"User",U&&!b&&e.jsx("span",{className:`ml-2 text-xs font-normal px-2 py-0.5 rounded-full align-middle ${(o.defaultVisibility||"public")==="public"?"bg-green-500/10 text-green-400":o.defaultVisibility==="friends"?"bg-blue-500/10 text-blue-400":"bg-red-500/10 text-red-400"}`,children:o.defaultVisibility||"public"})]}),o.username&&e.jsxs("p",{className:"text-sm text-flame-400",children:["@",o.username]}),o.createdAt&&e.jsxs("p",{className:"text-xs text-iron-500 mt-1",children:["Member since ",Q(o.createdAt.toDate?o.createdAt.toDate():new Date(o.createdAt),"MMMM yyyy"),se>0&&e.jsxs(e.Fragment,{children:[" · ",e.jsxs("button",{onClick:()=>{je("friends"),A.length===0&&ce()},className:"text-flame-400 hover:text-flame-300",children:[se," friend",se!==1?"s":""]})]})]}),((Re=o.badges)==null?void 0:Re.length)>0&&e.jsx("div",{className:"flex items-center gap-1.5 mt-2 flex-wrap",children:o.badges.map(s=>e.jsx("span",{title:s.name,className:"w-7 h-7 flex items-center justify-center bg-iron-800 border border-iron-700 rounded-lg text-sm cursor-default hover:bg-iron-700 transition-colors",children:s.icon},s.id))})]}),b?e.jsx(k,{to:"/settings",className:"btn-secondary text-sm",children:"Edit Profile"}):l&&e.jsx(As,{friendStatus:c,loading:ee,onAction:async()=>{_(!0);try{const s=o.uid||g;!c||c.status===d.NONE?(await u.sendRequest(l.uid,s),E({status:d.PENDING_SENT})):c.status===d.PENDING_SENT?(await u.cancelRequest(c.requestId),E({status:d.NONE})):c.status===d.PENDING_RECEIVED?(await u.acceptRequest(c.requestId),E({status:d.FRIENDS})):c.status===d.FRIENDS&&confirm("Remove this friend?")&&(await u.removeFriend(l.uid,s),E({status:d.NONE}),B(t=>Math.max(0,t-1)))}catch(s){console.error("Friend action error:",s),alert(s.message)}finally{_(!1)}}})]})}),b&&e.jsx("div",{className:"flex gap-2 mb-6",children:[{key:"overview",label:"Overview",icon:xe},{key:"friends",label:"Friends",icon:Ie,badge:M.length||null}].map(s=>e.jsxs("button",{onClick:()=>{je(s.key),s.key==="friends"&&A.length===0&&!le&&ce()},className:`flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium transition-colors ${te===s.key?"bg-flame-500/20 text-flame-400 border border-flame-500/30":"bg-iron-800/50 text-iron-400 border border-iron-700/50 hover:text-iron-200"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label,s.badge>0&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded-full bg-flame-500 text-white font-bold",children:s.badge})]},s.key))}),b&&te==="friends"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-2 mb-4 flex-wrap",children:[{key:"friends",label:"My Friends",count:A.length},{key:"requests",label:"Requests",count:M.length},{key:"sent",label:"Sent",count:K.length},{key:"find",label:"Find People"}].map(s=>e.jsxs("button",{onClick:()=>ye(s.key),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${H===s.key?"bg-iron-800 text-iron-100":"text-iron-500 hover:text-iron-300"}`,children:[s.label,s.count>0&&e.jsx("span",{className:"ml-1.5 text-xs opacity-60",children:s.count})]},s.key))}),le?e.jsxs("div",{className:"card-steel p-12 text-center",children:[e.jsx(D,{className:"w-6 h-6 text-flame-500 animate-spin mx-auto"}),e.jsx("p",{className:"text-iron-500 mt-3 text-sm",children:"Loading friends..."})]}):H==="friends"?A.length===0?e.jsxs("div",{className:"card-steel p-12 text-center",children:[e.jsx(Ie,{className:"w-12 h-12 text-iron-600 mx-auto mb-4"}),e.jsx("p",{className:"text-iron-500 mb-2",children:"No friends yet"}),e.jsx("button",{onClick:()=>ye("find"),className:"text-sm text-flame-400 hover:text-flame-300",children:"Find people to add"})]}):e.jsx("div",{className:"space-y-2",children:A.map(s=>{const t=s.uid||s.id;return e.jsxs("div",{className:"card-steel p-4 flex items-center gap-3",children:[e.jsx(k,{to:`/profile/${s.username||t}`,className:"w-10 h-10 rounded-full bg-iron-800 flex items-center justify-center hover:bg-iron-700 transition-colors",children:s.photoURL?e.jsx("img",{src:s.photoURL,alt:"",className:"w-10 h-10 rounded-full"}):e.jsx(O,{className:"w-5 h-5 text-iron-400"})}),e.jsxs(k,{to:`/profile/${s.username||t}`,className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-iron-200 truncate",children:s.displayName||"User"}),s.username&&e.jsxs("p",{className:"text-xs text-flame-400",children:["@",s.username]})]}),e.jsx("button",{onClick:()=>q("remove",t),disabled:v[t],className:"p-2 text-iron-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Remove friend",children:v[t]?e.jsx(D,{className:"w-4 h-4 animate-spin"}):e.jsx(Es,{className:"w-4 h-4"})})]},t)})}):H==="requests"?e.jsx("div",{className:"space-y-2",children:M.length===0?e.jsxs("div",{className:"card-steel p-12 text-center",children:[e.jsx(fe,{className:"w-12 h-12 text-iron-600 mx-auto mb-4"}),e.jsx("p",{className:"text-iron-500",children:"No pending requests"})]}):M.map(s=>{const t=re.find(i=>i.id===s.from)||{displayName:"User"};return e.jsxs("div",{className:"card-steel p-4 flex items-center gap-3",children:[e.jsx(k,{to:`/profile/${t.username||s.from}`,className:"w-10 h-10 rounded-full bg-iron-800 flex items-center justify-center hover:bg-iron-700 transition-colors",children:t.photoURL?e.jsx("img",{src:t.photoURL,alt:"",className:"w-10 h-10 rounded-full"}):e.jsx(O,{className:"w-5 h-5 text-iron-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-iron-200 truncate",children:t.displayName}),t.username&&e.jsxs("p",{className:"text-xs text-flame-400",children:["@",t.username]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>q("accept",s.id),disabled:v[s.id],className:"flex items-center gap-1 px-3 py-1.5 bg-green-500/20 text-green-400 hover:bg-green-500/30 rounded-lg text-sm font-medium transition-colors",children:[v[s.id]?e.jsx(D,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(ue,{className:"w-3.5 h-3.5"}),"Accept"]}),e.jsx("button",{onClick:()=>q("decline",s.id),disabled:v[s.id],className:"p-1.5 text-iron-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx(me,{className:"w-4 h-4"})})]})]},s.id)})}):H==="sent"?e.jsx("div",{className:"space-y-2",children:K.length===0?e.jsxs("div",{className:"card-steel p-12 text-center",children:[e.jsx(he,{className:"w-12 h-12 text-iron-600 mx-auto mb-4"}),e.jsx("p",{className:"text-iron-500",children:"No sent requests"})]}):K.map(s=>{const t=re.find(i=>i.id===s.to)||{displayName:"User"};return e.jsxs("div",{className:"card-steel p-4 flex items-center gap-3",children:[e.jsx(k,{to:`/profile/${t.username||s.to}`,className:"w-10 h-10 rounded-full bg-iron-800 flex items-center justify-center hover:bg-iron-700 transition-colors",children:t.photoURL?e.jsx("img",{src:t.photoURL,alt:"",className:"w-10 h-10 rounded-full"}):e.jsx(O,{className:"w-5 h-5 text-iron-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-iron-200 truncate",children:t.displayName}),t.username&&e.jsxs("p",{className:"text-xs text-flame-400",children:["@",t.username]})]}),e.jsxs("button",{onClick:()=>q("cancel",s.id),disabled:v[s.id],className:"flex items-center gap-1 px-3 py-1.5 bg-iron-700 text-iron-300 hover:bg-iron-600 rounded-lg text-sm font-medium transition-colors",children:[v[s.id]?e.jsx(D,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(me,{className:"w-3.5 h-3.5"}),"Cancel"]})]},s.id)})}):e.jsxs("div",{children:[e.jsx("div",{className:"card-steel p-4 mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-iron-500"}),e.jsx("input",{type:"text",placeholder:"Search by name or username...",value:Y,onChange:s=>Ye(s.target.value),className:"input-field w-full pl-10",autoFocus:!0})]})}),Y.trim()?(()=>{const s=new Set(A.map(n=>n.uid||n.id)),t=new Set(K.map(n=>n.to)),i=new Set(M.map(n=>n.from)),a=re.filter(n=>{var r,f;const m=Y.toLowerCase();return(((r=n.displayName)==null?void 0:r.toLowerCase().includes(m))||((f=n.username)==null?void 0:f.toLowerCase().includes(m)))&&!s.has(n.id)});return a.length===0?e.jsx("div",{className:"card-steel p-8 text-center",children:e.jsxs("p",{className:"text-iron-500",children:['No users found matching "',Y,'"']})}):e.jsx("div",{className:"space-y-2",children:a.map(n=>{const m=t.has(n.id),r=i.has(n.id);return e.jsxs("div",{className:"card-steel p-4 flex items-center gap-3",children:[e.jsx(k,{to:`/profile/${n.username||n.id}`,className:"w-10 h-10 rounded-full bg-iron-800 flex items-center justify-center hover:bg-iron-700 transition-colors",children:n.photoURL?e.jsx("img",{src:n.photoURL,alt:"",className:"w-10 h-10 rounded-full"}):e.jsx(O,{className:"w-5 h-5 text-iron-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-iron-200 truncate",children:n.displayName||"User"}),n.username&&e.jsxs("p",{className:"text-xs text-flame-400",children:["@",n.username]})]}),m?e.jsxs("span",{className:"text-xs text-iron-500 flex items-center gap-1",children:[e.jsx(fe,{className:"w-3.5 h-3.5"})," Pending"]}):r?e.jsxs("button",{onClick:()=>{const f=M.find(R=>R.from===n.id);f&&q("accept",f.id)},className:"flex items-center gap-1 px-3 py-1.5 bg-green-500/20 text-green-400 hover:bg-green-500/30 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(ue,{className:"w-3.5 h-3.5"})," Accept"]}):e.jsxs("button",{onClick:()=>q("send",n.id),disabled:v[n.id],className:"flex items-center gap-1 px-3 py-1.5 bg-flame-500/20 text-flame-400 hover:bg-flame-500/30 rounded-lg text-sm font-medium transition-colors",children:[v[n.id]?e.jsx(D,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(he,{className:"w-3.5 h-3.5"}),"Add"]})]},n.id)})})})():e.jsxs("div",{className:"card-steel p-8 text-center",children:[e.jsx(qe,{className:"w-12 h-12 text-iron-600 mx-auto mb-4"}),e.jsx("p",{className:"text-iron-500",children:"Type a name or username to find people"})]})]})]}),(te==="overview"||!b)&&e.jsxs(e.Fragment,{children:[I&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[{label:"Bench Press",key:"bench",color:"text-flame-400",value:I.bench},{label:"Squat",key:"squat",color:"text-purple-400",value:I.squat},{label:"Deadlift",key:"deadlift",color:"text-green-400",value:I.deadlift},{label:"Total",key:"total",color:"text-yellow-400",value:I.total}].map(s=>{var a;const t=s.key!=="total"?(a=I.bestSets)==null?void 0:a[s.key]:null,i=t&&t.e1rm&&t.reps>1;return e.jsxs("div",{className:"card-steel p-4 text-center relative group cursor-default",children:[e.jsx("p",{className:"text-xs text-iron-500 mb-1",children:s.label}),e.jsx("p",{className:`text-2xl font-display ${s.color}`,children:s.value>0?`${s.value}`:"—"}),e.jsx("p",{className:"text-xs text-iron-600",children:"lbs"}),i&&e.jsxs("div",{className:"absolute inset-0 bg-iron-900/95 rounded-xl flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-150 pointer-events-none",children:[e.jsx("p",{className:"text-[10px] text-iron-500 uppercase tracking-wider",children:"Est. 1RM"}),e.jsx("p",{className:`text-2xl font-display ${s.color}`,children:t.e1rm}),e.jsxs("p",{className:"text-[10px] text-iron-500",children:["from ",t.weight,"×",t.reps]})]})]},s.key)})}),(()=>{const s=o==null?void 0:o.wodStats,t=s?Object.entries(s).filter(([,a])=>a==null?void 0:a.pr):[],i=T?t:t.slice(0,4);return e.jsxs("div",{className:"card-steel mb-6 overflow-hidden",children:[e.jsxs("button",{onClick:()=>ge(!T),className:"w-full flex items-center justify-between p-4 hover:bg-iron-800/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5 text-yellow-400"}),e.jsx("h2",{className:"font-display text-lg text-iron-100",children:"Benchmark WODs"}),t.length>0&&e.jsx("span",{className:"text-xs text-iron-500 ml-1",children:t.length})]}),T?e.jsx(hs,{className:"w-5 h-5 text-iron-400"}):e.jsx(Le,{className:"w-5 h-5 text-iron-400"})]}),T&&e.jsx("div",{className:"px-4 pb-4",children:t.length===0?e.jsx("p",{className:"text-sm text-iron-500 text-center py-4",children:"Complete a benchmark WOD to see your stats here."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.map(([a,n])=>{const m=ws(a),r=n.pr,f=(r==null?void 0:r.rxOrScaled)==="rx",R=(m==null?void 0:m.format)||"fortime";let y="—";return R==="amrap"&&(r==null?void 0:r.rounds)!=null?(y=`${r.rounds} rds`,r.extraReps&&(y+=` +${r.extraReps}`)):r!=null&&r.time&&!(r!=null&&r.dnf)?y=r.time:r!=null&&r.dnf&&(y="DNF"),e.jsxs("div",{className:"card-steel p-3 relative group",children:[b&&U&&e.jsx("button",{onClick:async()=>{const C={...o.wodStats};delete C[a],$(p=>({...p,wodStats:C})),await V({wodStats:C})},className:"absolute top-1.5 right-1.5 w-5 h-5 rounded-full bg-iron-800 text-iron-600 hover:text-red-400 hover:bg-iron-700 transition-colors items-center justify-center hidden group-hover:flex",children:e.jsx(me,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex items-start justify-between gap-1 mb-1 pr-4",children:[e.jsx("p",{className:"text-xs font-semibold text-iron-200 truncate",children:(m==null?void 0:m.name)||a}),e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-semibold flex-shrink-0 ${f?"bg-flame-500/20 text-flame-400":"bg-iron-700 text-iron-400"}`,children:f?"Rx":"Scaled"})]}),e.jsx("p",{className:"text-lg font-display text-yellow-400",children:y}),m&&e.jsx("p",{className:"text-[10px] text-iron-600 mt-0.5",children:Ss[m.format]})]},a)})}),t.length>4&&e.jsx("button",{onClick:()=>ge(!T),className:"mt-3 w-full text-center text-xs text-iron-500 hover:text-iron-300 transition-colors",children:T?"Show less":`Show all ${t.length}`})]})})]})})(),W.length>0&&e.jsxs("div",{className:"card-steel mb-6 overflow-hidden",children:[e.jsxs("button",{onClick:()=>He(!Z),className:"w-full flex items-center justify-between p-4 hover:bg-iron-800/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5 text-flame-500"}),e.jsx("h2",{className:"font-display text-lg text-iron-100",children:"Goals"}),e.jsx("span",{className:"text-xs text-iron-500 ml-1",children:W.length})]}),e.jsx(Le,{className:`w-5 h-5 text-iron-400 transition-transform duration-200 ${Z?"rotate-180":""}`})]}),Z&&e.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[W.map(s=>{const t=s.targetValue&&s.currentValue?Math.min(100,Math.round(s.currentValue/s.targetValue*100)):0,i=s.metricType==="weight"?"lbs":s.metricType==="time"?"s":"reps";return e.jsxs("div",{className:"bg-iron-800/30 rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-iron-200",children:s.lift}),e.jsxs("span",{className:"text-xs text-iron-500",children:[s.currentValue||0,i," → ",s.targetValue,i]})]}),e.jsx("div",{className:"w-full h-2 bg-iron-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-flame-500 transition-all duration-500",style:{width:`${t}%`}})}),e.jsxs("div",{className:"flex items-center justify-between mt-1.5",children:[e.jsxs("span",{className:"text-[10px] text-iron-500",children:[t,"%"]}),s.targetDate&&e.jsxs("span",{className:"text-[10px] text-iron-500",children:["by ",Q(new Date(s.targetDate),"MMM d, yyyy")]})]})]},s.id)}),b&&e.jsx(k,{to:"/goals",className:"block text-center text-xs text-flame-400 hover:text-flame-300 transition-colors pt-1",children:"Manage goals →"})]})]}),e.jsxs("div",{className:"card-steel p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"font-display text-lg text-iron-100 flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-flame-500"}),"Activity Calendar"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ne(Cs(L,1)),className:"p-1 text-iron-400 hover:text-iron-200",children:e.jsx(Rs,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-sm text-iron-300 w-28 text-center",children:Q(L,"MMM yyyy")}),e.jsx("button",{onClick:()=>Ne(Ds(L,1)),className:"p-1 text-iron-400 hover:text-iron-200",children:e.jsx(Me,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:["M","T","W","T","F","S","S"].map((s,t)=>e.jsx("div",{className:"text-center text-xs text-iron-500 py-1",children:s},t))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:Je().map((s,t)=>{const i=Ze(s),a=i.filter(N=>N.workoutType!=="cardio"),n=i.filter(N=>N.workoutType==="cardio");a.length>0;const m=n.length>0,r=a.some(N=>N.status==="completed"),f=a.some(N=>N.status!=="completed"),R=es(s),y=Fs(s,L),C=fs(s),p=r?"bg-green-500/20":f?"bg-flame-500/20":"";return e.jsxs("div",{className:`
                  relative aspect-square flex items-center justify-center text-xs rounded-md
                  ${y?"text-iron-300":"text-iron-600"}
                  ${C?"ring-1 ring-flame-500":""}
                  ${p}
                `,children:[Q(s,"d"),(m||R)&&e.jsxs("div",{className:"absolute bottom-0.5 left-1/2 -translate-x-1/2 flex items-center gap-0.5",children:[m&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-cyan-400"}),R&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-yellow-400"})]})]},t)})}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 mt-4 text-xs text-iron-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-green-500/20"}),e.jsx("span",{children:"Completed"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-flame-500/20"}),e.jsx("span",{children:"Scheduled"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-cyan-400"}),e.jsx("span",{children:"Cardio"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-400"}),e.jsx("span",{children:"Goal"})]})]})]}),e.jsxs("div",{className:"card-steel p-4",children:[e.jsx("h2",{className:"font-display text-lg text-iron-100 mb-4",children:"Recent Activity"}),pe.length===0?e.jsx("p",{className:"text-center text-iron-500 py-8",children:"No recent activity"}):e.jsx("div",{className:"space-y-3",children:pe.map(s=>{var t,i;return e.jsxs("div",{className:"flex items-center gap-3 py-2 border-b border-iron-800 last:border-0",children:[Xe(s.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-iron-300",children:((t=s.data)==null?void 0:t.name)||s.type.replace(/_/g," ")}),e.jsx("p",{className:"text-xs text-iron-600",children:((i=s.createdAt)==null?void 0:i.toDate)&&Is(s.createdAt.toDate(),{addSuffix:!0})})]}),s.reactionCount>0&&e.jsx("div",{className:"flex items-center gap-1 text-xs text-iron-500",children:e.jsxs("span",{children:[s.reactionCount," reaction",s.reactionCount!==1?"s":""]})})]},s.id)})}),e.jsx(k,{to:`/feed?user=${(o==null?void 0:o.uid)||(l==null?void 0:l.uid)}`,className:"block mt-4 text-center text-sm text-flame-400 hover:text-flame-300",children:"View all activity"})]}),b&&e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"card-steel overflow-hidden divide-y divide-iron-800",children:[{to:"/calendar",icon:Ae,label:"Calendar",desc:"Monthly view & scheduling"},{to:"/health",icon:Ue,label:"Health",desc:"Weight, sleep & body metrics"},{to:"/settings",icon:ps,label:"Settings",desc:"Preferences & account"}].map(s=>e.jsxs(k,{to:s.to,state:{from:"/profile",fromLabel:"Back to Profile"},className:"flex items-center gap-4 p-4 hover:bg-iron-800/50 transition-colors",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-iron-800 flex items-center justify-center flex-shrink-0",children:e.jsx(s.icon,{className:"w-5 h-5 text-iron-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-iron-200",children:s.label}),e.jsx("p",{className:"text-xs text-iron-500",children:s.desc})]}),e.jsx(Me,{className:"w-4 h-4 text-iron-600"})]},s.to))})})]})]})}export{Ys as default};

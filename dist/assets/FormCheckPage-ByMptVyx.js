import{t as Oe,u as We,d as Be,r as n,av as Ve,O as _e,j as e,A as ze,V as He,l as z,m as o,v as qe,P as Ge,aj as Me,S as Qe,f as Xe,s as Ye,R as Je,w as Ke,i as Ze,k as et,aL as tt}from"./index-DavVl6G1.js";import{P as st}from"./pause-CU6cDde2.js";import{I as Ae}from"./info-BHDbpY31.js";import{C as Fe,S as at}from"./shield-CLuHS2Aj.js";import{C as rt,X as it}from"./x-circle-G2W_UKOG.js";import{C as nt}from"./chevron-left-BWaiEwwj.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=Oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),O={quick:{frames:5,label:"Quick",desc:"5 frames",credits:10},standard:{frames:10,label:"Standard",desc:"10 frames",credits:15},detailed:{frames:20,label:"Detailed",desc:"20 frames",credits:25}},ot=480,ct=.5,Te=50,ee=["Tip: Film from a 45Â° angle for the most useful analysis","Tip: Keep your phone at hip height for squats and deadlifts","Tip: Side angle works best for bench press form","Tip: Wear form-fitting clothes so joint positions are visible","Tip: Good lighting makes a huge difference in analysis quality","Tip: Film entire reps â€” setup through lockout"];function te(a){return a>=8?"text-green-400":a>=6?"text-yellow-400":a>=4?"text-orange-400":"text-red-400"}function dt(a){return a>=8?"bg-green-500/20":a>=6?"bg-yellow-500/20":a>=4?"bg-orange-500/20":"bg-red-500/20"}function mt(a){return a>=8?"bg-green-500":a>=6?"bg-yellow-500":a>=4?"bg-orange-500":"bg-red-500"}function xt(a){return a>=8?"bg-green-500/30":a>=6?"bg-yellow-500/30":a>=4?"bg-orange-500/30":"bg-red-500/30"}function ht(a){return a>=9?"Excellent":a>=8?"Great":a>=7?"Good":a>=6?"Decent":a>=5?"Needs Work":a>=4?"Poor":a>=2?"Dangerous":"N/A"}function pt(a){return a==="high"?"text-red-400 bg-red-500/15 border-red-500/30":a==="medium"?"text-orange-400 bg-orange-500/15 border-orange-500/30":"text-yellow-400 bg-yellow-500/15 border-yellow-500/30"}function ut(a){return a==="high"?"ðŸ”´":a==="medium"?"ðŸŸ¡":"ðŸŸ¢"}function ft({score:a,size:l=100}){const g=(l-12)/2,k=2*Math.PI*g,T=k*(1-Math.min(a/10,1)),A=a>=8?"#4ade80":a>=6?"#facc15":a>=4?"#fb923c":"#f87171";return e.jsxs("div",{className:"relative flex-shrink-0",style:{width:l,height:l},children:[e.jsxs("svg",{width:l,height:l,className:"-rotate-90",children:[e.jsx("circle",{cx:l/2,cy:l/2,r:g,fill:"none",stroke:"rgba(255,255,255,0.06)",strokeWidth:"8"}),e.jsx(o.circle,{cx:l/2,cy:l/2,r:g,fill:"none",stroke:A,strokeWidth:"8",strokeLinecap:"round",strokeDasharray:k,initial:{strokeDashoffset:k},animate:{strokeDashoffset:T},transition:{duration:1.2,ease:"easeOut",delay:.3}})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(o.span,{className:`text-3xl font-bold font-display ${te(a)}`,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.6,duration:.4},children:a}),e.jsx("span",{className:"text-[10px] text-iron-500 uppercase tracking-wider",children:ht(a)})]})]})}function _({label:a,score:l,note:g}){const[k,T]=n.useState(!1),A=l>=8?"bg-green-500":l>=6?"bg-yellow-500":l>=4?"bg-orange-500":"bg-red-500";return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>g&&T(!k),className:"w-full flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-iron-400 w-16 text-right flex-shrink-0",children:a}),e.jsx("div",{className:"flex-1 h-2 bg-iron-800 rounded-full overflow-hidden",children:e.jsx(o.div,{className:`h-full rounded-full ${A}`,initial:{width:0},animate:{width:`${l/10*100}%`},transition:{duration:.8,ease:"easeOut",delay:.5}})}),e.jsx("span",{className:`text-xs font-semibold w-6 text-right ${te(l)}`,children:l})]}),e.jsx(z,{children:k&&g&&e.jsx(o.p,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"text-[11px] text-iron-500 ml-[76px] mt-1 overflow-hidden",children:g})})]})}function gt({phase:a}){const l={setup:"bg-blue-500/20 text-blue-400",descent:"bg-purple-500/20 text-purple-400",bottom:"bg-red-500/20 text-red-400",ascent:"bg-amber-500/20 text-amber-400",lockout:"bg-green-500/20 text-green-400",transition:"bg-iron-700/50 text-iron-400",rest:"bg-iron-700/50 text-iron-500"};return e.jsx("span",{className:`text-[10px] font-semibold px-2 py-0.5 rounded-full uppercase tracking-wide ${l[a]||l.transition}`,children:a})}function kt(){var pe,ue,fe,ge,be,je,ye,Ne;We("Form Check");const{user:a,isAppAdmin:l}=Be(),g=l,k=n.useRef(null),T=n.useRef(null),A=n.useRef(null),se=n.useRef(null),[b,y]=n.useState("upload"),[R,ae]=n.useState(null),[C,re]=n.useState(null),[c,ie]=n.useState([]),[$,ne]=n.useState(""),[I,H]=n.useState("standard"),[N,le]=n.useState("standard"),[W,q]=n.useState(0),[r,oe]=n.useState(null),[ce,j]=n.useState(null),[d,S]=n.useState(0),[de,G]=n.useState(!1),[Re,Q]=n.useState(!1),[me,xe]=n.useState(0),[B,he]=n.useState(!1);n.useEffect(()=>()=>{C&&URL.revokeObjectURL(C)},[C]),n.useEffect(()=>{if(b!=="results")return;const t=s=>{s.key==="ArrowLeft"&&d>0&&S(i=>i-1),s.key==="ArrowRight"&&d<c.length-1&&S(i=>i+1)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[b,d,c.length]),n.useEffect(()=>{if(b!=="analyzing")return;const t=setInterval(()=>xe(s=>(s+1)%ee.length),4e3);return()=>clearInterval(t)},[b]);const V=n.useCallback(t=>{if(t){if(!t.type.startsWith("video/")){j("Please select a video file.");return}if(t.size>100*1024*1024){j("Video must be under 100MB.");return}j(null),ae(t),re(s=>(s&&URL.revokeObjectURL(s),URL.createObjectURL(t)))}},[]),De=n.useCallback(t=>{var s;return V((s=t.target.files)==null?void 0:s[0])},[V]),Pe=n.useCallback(t=>{var s;t.preventDefault(),G(!1),V((s=t.dataTransfer.files)==null?void 0:s[0])},[V]),$e=n.useCallback(()=>{const t=se.current;t&&(t.paused?(t.play(),Q(!0)):(t.pause(),Q(!1)))},[]),Ie=n.useCallback(async()=>{if(!C)return;const t=O[N].frames;y("extracting"),q(0),j(null);const s=k.current,i=T.current;if(!s||!i){j("Could not initialize video processor."),y("upload");return}const u=i.getContext("2d"),F=x=>new Promise((ve,E)=>{const D=setTimeout(()=>E(new Error("Frame seek timed out")),5e3);s.onseeked=()=>{clearTimeout(D),ve()},s.onerror=()=>{clearTimeout(D),E(new Error("Video error during seek"))},s.currentTime=x});try{s.src=C,await new Promise((m,v)=>{s.readyState>=1?m():(s.onloadedmetadata=m,s.onerror=()=>v(new Error("Could not load video")))});const x=s.duration;if(!x||x<=0||!isFinite(x)){j("Could not read video duration. Try a different file."),y("upload");return}const E=Math.min(1,160/s.videoWidth);i.width=Math.round(s.videoWidth*E),i.height=Math.round(s.videoHeight*E);const D=Math.max(2,Math.min(30,Math.floor(x*2))),Ue=x/D,M=[];let U=null;for(let m=0;m<D;m++){const v=m*Ue;await F(v),u.drawImage(s,0,0,i.width,i.height);const f=u.getImageData(0,0,i.width,i.height).data;if(U){let P=0;for(let w=0;w<f.length;w+=16)P+=Math.abs(f[w]-U[w])+Math.abs(f[w+1]-U[w+1])+Math.abs(f[w+2]-U[w+2]);M.push({time:v,score:P})}U=new Uint8Array(f),q(Math.round((m+1)/D*30))}let Y=0,we=x;if(M.length>t){const m=Math.min(t,M.length);let v=0,f=0;for(let L=0;L<=M.length-m;L++){let K=0;for(let Z=L;Z<L+m;Z++)K+=M[Z].score;K>v&&(v=K,f=L)}const P=Math.max(0,f-1),w=Math.min(M.length-1,f+m);Y=M[P].time,we=M[w].time}const ke=we-Y,J=Math.max(1,Math.min(t,Math.floor(ke))),Le=ke/J,Se=Math.min(1,ot/s.videoWidth);i.width=Math.round(s.videoWidth*Se),i.height=Math.round(s.videoHeight*Se);const Ce=[];for(let m=0;m<J;m++){const v=Y+m*Le;await F(v),u.drawImage(s,0,0,i.width,i.height);const f=i.toDataURL("image/jpeg",ct),P=f.split(",")[1];Ce.push({dataUrl:f,base64:P,timestamp:v,index:m+1}),q(30+Math.round((m+1)/J*70))}ie(Ce),y("preview")}catch(x){console.error("Frame extraction error:",x),j(x.message||"Could not extract frames. Try a different file."),y("upload")}},[C,N]),Ee=n.useCallback(async()=>{if(!a||c.length===0)return;y("analyzing"),j(null),xe(Math.floor(Math.random()*ee.length));const t=I==="premium",s=t?Te:O[N].credits;try{if(!g&&await Ve.getBalance(a.uid)<s){j(`Not enough credits. You need ${s} credits.`),y("preview");return}const i=await a.getIdToken(),u=await fetch(_e("analyze-form"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({frames:c.map(x=>x.base64),note:$.trim()||void 0,model:t?"premium":"standard",quality:N})});if(!u.ok){const x=await u.json().catch(()=>({}));throw new Error(x.error||"Analysis failed")}const F=await u.json();oe(F.analysis),S(0),y("results")}catch(i){console.error("Form analysis error:",i),j(i.message||"Something went wrong. Please try again."),y("preview")}},[a,c,$,I,N,g]),X=()=>{y("upload"),ae(null),re(t=>(t&&URL.revokeObjectURL(t),null)),ie([]),ne(""),H("standard"),le("standard"),oe(null),j(null),S(0),he(!1)},p=(pe=r==null?void 0:r.frames)==null?void 0:pe[d],h=r==null?void 0:r.movementQuality;return e.jsxs("div",{className:"max-w-2xl mx-auto pb-24",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[b==="results"&&e.jsx("button",{onClick:X,className:"p-2 -ml-2 text-iron-400 hover:text-iron-200 transition-colors",children:e.jsx(ze,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-display text-iron-100 flex items-center gap-2",children:[e.jsx(He,{className:"w-6 h-6 text-flame-400"}),"Form Check",e.jsx("span",{className:"text-[10px] font-semibold px-1.5 py-0.5 rounded-full bg-purple-500/20 text-purple-400 uppercase",children:"Beta"})]}),b!=="results"&&e.jsx("p",{className:"text-sm text-iron-500 mt-1",children:"Upload a video for AI-powered frame-by-frame form analysis"})]})]}),e.jsx("video",{ref:k,className:"hidden",muted:!0,playsInline:!0,preload:"metadata"}),e.jsx("canvas",{ref:T,className:"hidden"}),e.jsx(z,{children:ce&&e.jsxs(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-xl flex items-start gap-2",children:[e.jsx(qe,{className:"w-4 h-4 text-red-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-300",children:ce})]})}),b==="upload"&&e.jsxs(o.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsx("div",{onClick:()=>{var t;return!R&&((t=A.current)==null?void 0:t.click())},onDragOver:t=>{t.preventDefault(),G(!0)},onDragLeave:()=>G(!1),onDrop:Pe,className:`relative rounded-2xl overflow-hidden transition-all duration-200 ${de?"ring-2 ring-flame-500 bg-flame-500/5":R?"bg-black":"card-steel border-2 border-dashed border-iron-700 hover:border-flame-500/40 cursor-pointer"}`,children:R&&C?e.jsxs("div",{className:"relative",children:[e.jsx("video",{ref:se,src:C,className:"w-full aspect-video object-contain bg-black",playsInline:!0,loop:!0,muted:!0,onEnded:()=>Q(!1)}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("button",{onClick:t=>{t.stopPropagation(),$e()},className:"w-14 h-14 rounded-full bg-black/60 backdrop-blur-sm flex items-center justify-center hover:bg-black/80 transition-colors",children:Re?e.jsx(st,{className:"w-6 h-6 text-white"}):e.jsx(Ge,{className:"w-6 h-6 text-white ml-0.5"})})}),e.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-gradient-to-t from-black/80 to-transparent p-4 pt-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white font-medium truncate max-w-[200px]",children:R.name}),e.jsxs("p",{className:"text-xs text-iron-400",children:[(R.size/(1024*1024)).toFixed(1),"MB"]})]}),e.jsx("button",{onClick:t=>{var s;t.stopPropagation(),(s=A.current)==null||s.click()},className:"text-xs text-flame-400 hover:text-flame-300 font-medium",children:"Change"})]})})]}):e.jsxs("div",{className:"p-10 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-iron-800/80 flex items-center justify-center mx-auto mb-4",children:e.jsx(lt,{className:`w-7 h-7 transition-colors ${de?"text-flame-400":"text-iron-500"}`})}),e.jsx("p",{className:"text-iron-200 font-medium mb-1",children:"Drop a video here or tap to upload"}),e.jsx("p",{className:"text-xs text-iron-500",children:"MP4, MOV, WEBM up to 100MB"})]})}),e.jsx("input",{ref:A,type:"file",accept:"video/*",onChange:De,className:"hidden","aria-label":"Upload video"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-iron-400 mb-1.5 block",children:"Note (optional)"}),e.jsx("input",{type:"text",value:$,onChange:t=>ne(t.target.value),placeholder:"e.g., checking squat depth, elbow pain on bench...",className:"input-field w-full","aria-label":"Analysis note"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Analysis Depth"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(O).map(([t,s])=>e.jsxs("button",{onClick:()=>le(t),className:`relative px-3 py-3 rounded-xl border transition-all text-center ${N===t?"border-flame-500 bg-flame-500/10 shadow-glow":"border-iron-700 hover:border-iron-600 bg-iron-900/50"}`,children:[t==="standard"&&e.jsx("span",{className:"absolute -top-2 left-1/2 -translate-x-1/2 text-[9px] font-bold px-1.5 py-0.5 rounded-full bg-flame-500 text-white uppercase",children:"Popular"}),e.jsx("div",{className:`text-sm font-semibold ${N===t?"text-flame-400":"text-iron-300"}`,children:s.label}),e.jsx("div",{className:"text-[11px] text-iron-500 mt-0.5",children:s.desc}),e.jsxs("div",{className:`text-xs font-semibold mt-1 ${N===t?"text-flame-400":"text-iron-400"}`,children:[s.credits," credits"]})]},t))})]}),g&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"AI Model"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>H("standard"),className:`px-3 py-2 text-xs rounded-xl border transition-colors text-center ${I==="standard"?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:e.jsxs("div",{className:"font-medium flex items-center justify-center gap-1",children:[e.jsx(Me,{className:"w-3 h-3"}),"Standard"]})}),e.jsx("button",{onClick:()=>H("premium"),className:`px-3 py-2 text-xs rounded-xl border transition-colors text-center ${I==="premium"?"border-purple-500 bg-purple-500/10 text-purple-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:e.jsxs("div",{className:"font-medium flex items-center justify-center gap-1",children:[e.jsx(Qe,{className:"w-3 h-3"}),"Premium"]})})]})]}),e.jsxs("div",{className:"flex items-start gap-2.5 p-3 bg-iron-800/40 rounded-xl",children:[e.jsx(Ae,{className:"w-4 h-4 text-iron-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-iron-500 leading-relaxed",children:"Video is processed on your device â€” only extracted frames are sent. We auto-detect when the exercise starts. Best with a side or 45Â° angle."})]}),e.jsxs("button",{onClick:Ie,disabled:!R,className:"btn-primary w-full py-3.5 disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-base",children:[e.jsx(Fe,{className:"w-5 h-5"})," Extract Frames"]})]}),b==="extracting"&&e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},className:"card-steel p-8 text-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-5",children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-flame-500/20 animate-ping"}),e.jsx("div",{className:"relative w-16 h-16 rounded-2xl bg-flame-500/10 flex items-center justify-center",children:e.jsx(Fe,{className:"w-7 h-7 text-flame-400"})})]}),e.jsx("p",{className:"text-iron-200 font-semibold mb-1",children:W<=30?"Scanning for movement...":"Extracting key frames..."}),e.jsx("p",{className:"text-xs text-iron-500 mb-4",children:W<=30?"Detecting when the exercise starts":`Capturing ${O[N].frames} frames`}),e.jsx("div",{className:"w-56 h-2.5 bg-iron-800 rounded-full mx-auto overflow-hidden",children:e.jsx(o.div,{className:"h-full bg-gradient-to-r from-flame-500 to-flame-400 rounded-full",animate:{width:`${W}%`},transition:{duration:.3}})}),e.jsxs("p",{className:"text-xs text-iron-600 mt-2",children:[W,"%"]})]}),b==="preview"&&e.jsxs(o.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsxs("div",{className:"card-steel p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-iron-200",children:[c.length," frames captured"]}),e.jsx("span",{className:"text-[11px] text-iron-500",children:c.length>0&&`${c[0].timestamp.toFixed(1)}s â€“ ${c[c.length-1].timestamp.toFixed(1)}s`})]}),e.jsx("div",{className:"flex gap-1.5 overflow-x-auto pb-2 -mx-1 px-1 scrollbar-hide",children:c.map((t,s)=>e.jsxs("div",{className:"relative flex-shrink-0 w-20 aspect-video rounded-lg overflow-hidden bg-iron-800 ring-1 ring-iron-700/50",children:[e.jsx("img",{src:t.dataUrl,alt:`Frame ${s+1}`,className:"w-full h-full object-cover"}),e.jsxs("span",{className:"absolute bottom-0.5 right-1 text-[9px] text-white/80 bg-black/60 px-1 rounded",children:[t.timestamp.toFixed(1),"s"]}),e.jsx("span",{className:"absolute top-0.5 left-1 text-[9px] text-white/60 font-semibold",children:s+1})]},s))})]}),$&&e.jsxs("div",{className:"card-steel p-3 flex items-start gap-2",children:[e.jsx(Ae,{className:"w-3.5 h-3.5 text-iron-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-iron-500 uppercase tracking-wider mb-0.5",children:"Note"}),e.jsx("p",{className:"text-sm text-iron-300",children:$})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:X,className:"btn-secondary flex-1 py-3",children:"Start Over"}),e.jsxs("button",{onClick:Ee,className:"btn-primary flex-1 py-3 flex items-center justify-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),"Analyze (",I==="premium"?Te:O[N].credits," credits)"]})]})]}),b==="analyzing"&&e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:[e.jsx("div",{className:"card-steel p-6",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"w-[100px] h-[100px] rounded-full bg-iron-800 animate-pulse flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("div",{className:"h-5 w-40 bg-iron-800 rounded animate-pulse"}),e.jsx("div",{className:"h-3 w-full bg-iron-800/60 rounded animate-pulse"}),e.jsx("div",{className:"h-3 w-3/4 bg-iron-800/60 rounded animate-pulse"})]})]})}),e.jsxs("div",{className:"card-steel p-5 text-center",children:[e.jsx(Xe,{className:"w-8 h-8 text-flame-400 animate-spin mx-auto mb-3"}),e.jsx("p",{className:"text-iron-200 font-semibold mb-1",children:"Analyzing your form..."}),e.jsx("p",{className:"text-xs text-iron-500 mb-4",children:"GPT-4o is reviewing each frame"}),e.jsx(z,{mode:"wait",children:e.jsx(o.p,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},className:"text-xs text-iron-600 italic",children:ee[me]},me)})]})]}),b==="results"&&r&&e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:[e.jsx(o.div,{className:"card-steel p-5",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx(ft,{score:r.overallScore}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h2",{className:"text-lg font-display text-iron-100",children:r.exercise||"Exercise"}),r.variation&&e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-iron-800 text-iron-400 border border-iron-700",children:r.variation})]}),r.repsDetected>0&&e.jsxs("p",{className:"text-xs text-iron-500 mt-0.5",children:[r.repsDetected," rep",r.repsDetected!==1?"s":""," detected"]}),e.jsx("p",{className:"text-sm text-iron-400 mt-2 leading-relaxed",children:r.overallSummary})]})]})}),h&&e.jsxs(o.div,{className:"card-steel p-4",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx("h3",{className:"text-xs font-semibold text-iron-400 uppercase tracking-wider mb-3",children:"Movement Quality"}),e.jsxs("div",{className:"space-y-2.5",children:[h.stability&&e.jsx(_,{label:"Stability",score:h.stability.score,note:h.stability.note}),h.rangeOfMotion&&e.jsx(_,{label:"ROM",score:h.rangeOfMotion.score,note:h.rangeOfMotion.note}),h.control&&e.jsx(_,{label:"Control",score:h.control.score,note:h.control.note}),h.alignment&&e.jsx(_,{label:"Alignment",score:h.alignment.score,note:h.alignment.note})]})]}),e.jsxs(o.div,{className:"grid grid-cols-2 gap-3",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.3},children:[((ue=r.keyStrengths)==null?void 0:ue.length)>0&&e.jsxs("div",{className:"card-steel p-4",children:[e.jsxs("h3",{className:"text-xs font-semibold text-green-400 uppercase tracking-wider mb-2.5 flex items-center gap-1.5",children:[e.jsx(rt,{className:"w-3.5 h-3.5"})," Strengths"]}),e.jsx("div",{className:"space-y-2",children:r.keyStrengths.map((t,s)=>e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed",children:t},s))})]}),((fe=r.keyIssues)==null?void 0:fe.length)>0&&e.jsxs("div",{className:"card-steel p-4",children:[e.jsxs("h3",{className:"text-xs font-semibold text-red-400 uppercase tracking-wider mb-2.5 flex items-center gap-1.5",children:[e.jsx(it,{className:"w-3.5 h-3.5"})," Issues"]}),e.jsx("div",{className:"space-y-2",children:r.keyIssues.map((t,s)=>e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed",children:t},s))})]})]}),((ge=r.injuryRisks)==null?void 0:ge.length)>0&&e.jsxs(o.div,{className:"card-steel p-4",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.35},children:[e.jsxs("h3",{className:"text-xs font-semibold text-iron-400 uppercase tracking-wider mb-3 flex items-center gap-1.5",children:[e.jsx(at,{className:"w-3.5 h-3.5"})," Injury Risk Areas"]}),e.jsx("div",{className:"space-y-2.5",children:r.injuryRisks.map((t,s)=>e.jsxs("div",{className:`p-3 rounded-xl border ${pt(t.severity)}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm",children:ut(t.severity)}),e.jsx("span",{className:"text-xs font-semibold",children:t.area}),e.jsx("span",{className:"text-[9px] uppercase tracking-wider opacity-70 ml-auto",children:t.severity})]}),e.jsx("p",{className:"text-[11px] opacity-80 leading-relaxed",children:t.description}),t.fix&&e.jsxs("p",{className:"text-[11px] mt-1.5 opacity-90",children:[e.jsx("span",{className:"font-semibold",children:"Fix:"})," ",t.fix]})]},s))})]}),c.length>0&&((be=r.frames)==null?void 0:be.length)>0&&e.jsxs(o.div,{className:"card-steel overflow-hidden",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsx("h3",{className:"text-xs font-semibold text-iron-400 uppercase tracking-wider px-4 pt-4 pb-2",children:"Frame-by-Frame"}),e.jsxs("div",{className:"relative bg-black",onTouchStart:t=>{t.currentTarget.dataset.touchX=t.touches[0].clientX},onTouchEnd:t=>{const s=t.changedTouches[0].clientX-Number(t.currentTarget.dataset.touchX||0);s>50&&d>0&&S(d-1),s<-50&&d<c.length-1&&S(d+1)},children:[e.jsx(z,{mode:"wait",children:e.jsx(o.img,{src:(je=c[d])==null?void 0:je.dataUrl,alt:`Frame ${d+1}`,className:"w-full aspect-video object-contain",initial:{opacity:.6},animate:{opacity:1},transition:{duration:.15}},d)}),d>0&&e.jsx("button",{onClick:()=>S(d-1),"aria-label":"Previous frame",className:"absolute left-2 top-1/2 -translate-y-1/2 w-9 h-9 rounded-full bg-black/60 backdrop-blur-sm flex items-center justify-center opacity-80 lg:opacity-0 lg:hover:opacity-100 transition-opacity",children:e.jsx(nt,{className:"w-5 h-5 text-white"})}),d<c.length-1&&e.jsx("button",{onClick:()=>S(d+1),"aria-label":"Next frame",className:"absolute right-2 top-1/2 -translate-y-1/2 w-9 h-9 rounded-full bg-black/60 backdrop-blur-sm flex items-center justify-center opacity-80 lg:opacity-0 lg:hover:opacity-100 transition-opacity",children:e.jsx(Ye,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"absolute top-3 left-3 flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-white bg-black/60 backdrop-blur-sm px-2 py-1 rounded-lg font-medium",children:[d+1,"/",c.length]}),p&&e.jsxs("span",{className:`text-xs font-bold px-2 py-1 rounded-lg backdrop-blur-sm ${dt(p.formScore)} ${te(p.formScore)}`,children:[p.formScore,"/10"]})]}),(p==null?void 0:p.phase)&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(gt,{phase:p.phase})})]}),p&&e.jsxs("div",{className:"p-4 border-t border-iron-800/50",children:[e.jsx("p",{className:"text-sm text-iron-200 leading-relaxed",children:p.assessment}),((ye=p.cues)==null?void 0:ye.length)>0&&e.jsx("div",{className:"mt-2.5 space-y-1.5",children:p.cues.map((t,s)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Je,{className:"w-3 h-3 text-flame-400 mt-1 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed",children:t})]},s))})]}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx("div",{className:"flex gap-1",children:c.map((t,s)=>{var F;const i=(F=r.frames)==null?void 0:F[s],u=(i==null?void 0:i.formScore)||0;return e.jsx("button",{onClick:()=>S(s),"aria-label":`Frame ${s+1}`,className:`flex-1 rounded-full transition-all ${s===d?`h-3 ${mt(u)} shadow-sm`:`h-2 ${u>0?xt(u):"bg-iron-700"} hover:h-2.5`}`,title:`Frame ${s+1}: ${(i==null?void 0:i.phase)||""} (${u}/10)`},s)})}),e.jsx("p",{className:"text-center text-[10px] text-iron-600 mt-2",children:"â† â†’ arrow keys to navigate Â· swipe on mobile"})]})]}),r.focusDrill&&e.jsxs(o.div,{className:"relative overflow-hidden rounded-2xl border border-flame-500/20",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.5},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-flame-500/10 via-transparent to-transparent"}),e.jsxs("div",{className:"relative p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-flame-400"}),e.jsx("h3",{className:"text-sm font-semibold text-flame-400",children:"Focus Next Session"})]}),e.jsx("p",{className:"text-sm font-semibold text-iron-100 mb-1",children:r.focusDrill.title}),e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed mb-3",children:r.focusDrill.description}),r.focusDrill.cue&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-flame-500/15 rounded-lg border border-flame-500/20",children:[e.jsx("span",{className:"text-xs text-iron-500",children:"Cue:"}),e.jsxs("span",{className:"text-sm font-semibold text-flame-300",children:['"',r.focusDrill.cue,'"']})]})]})]}),((Ne=r.recommendations)==null?void 0:Ne.length)>0&&e.jsxs(o.div,{className:"card-steel p-4",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.55},children:[e.jsx("h3",{className:"text-xs font-semibold text-iron-400 uppercase tracking-wider mb-3",children:"Recommendations"}),e.jsx("div",{className:"space-y-2.5",children:(B?r.recommendations:r.recommendations.slice(0,3)).map((t,s)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5 text-[10px] font-bold ${s===0?"bg-flame-500/20 text-flame-400":"bg-iron-800 text-iron-500"}`,children:s+1}),e.jsx("p",{className:"text-sm text-iron-300 leading-relaxed",children:t})]},s))}),r.recommendations.length>3&&e.jsxs("button",{onClick:()=>he(!B),className:"mt-3 text-xs text-iron-500 hover:text-iron-300 flex items-center gap-1 transition-colors",children:[B?e.jsx(Ze,{className:"w-3.5 h-3.5"}):e.jsx(et,{className:"w-3.5 h-3.5"}),B?"Show less":`Show ${r.recommendations.length-3} more`]})]}),e.jsxs("button",{onClick:X,className:"btn-secondary w-full py-3 flex items-center justify-center gap-2",children:[e.jsx(tt,{className:"w-4 h-4"})," Analyze Another Video"]})]})]})}export{kt as default};

import{b as Be,u as tt,d as st,r as o,az as Y,Q as at,V as ke,W as De,Y as Se,$ as Pe,a0 as Ce,a2 as Te,j as e,A as nt,F as Ge,av as Me,aw as Ae,m as rt,i as Ee,S as We,K as re,C as Ie,P as it,k as lt,w as ot,x as ct,an as dt,a9 as xt,Z as mt,J as ut,I as ht,B as gt,z as $e,q as pt}from"./index-DngWaF3c.js";import{a as ft}from"./index-Co_xhios.js";import{P as bt}from"./pause-jSnuuXYY.js";import{T as jt}from"./trash-2-BfpgiwwA.js";const ae=[{id:"monday",short:"Mon"},{id:"tuesday",short:"Tue"},{id:"wednesday",short:"Wed"},{id:"thursday",short:"Thu"},{id:"friday",short:"Fri"},{id:"saturday",short:"Sat"},{id:"sunday",short:"Sun"}],Fe=["Bench Press","Squat","Deadlift","Overhead Press","Incline Bench","Close Grip Bench"],ne=["Pull-ups","Push-ups","Dips","Plank","Handstand Hold","Muscle-ups","L-sit","Pistol Squats"],yt=[{id:"strength",label:"Strength",desc:"Barbell/dumbbell focused"},{id:"bodyweight",label:"Bodyweight",desc:"Calisthenics & holds"},{id:"mixed",label:"Mixed",desc:"Weights + bodyweight"}],Nt=[{value:20,label:"20 min"},{value:30,label:"30 min"},{value:45,label:"45 min"},{value:60,label:"60 min"},{value:90,label:"90 min"}],Le=[{text:"Analyzing your current strength levels...",icon:"brain"},{text:"Designing periodization phases...",icon:"calc"},{text:"Calculating progressive overload targets...",icon:"calc"},{text:"Building weekly training splits...",icon:"dumbbell"},{text:"Planning deload timing...",icon:"alert"},{text:"Adding accessory exercises...",icon:"dumbbell"},{text:"Finalizing program structure...",icon:"check"}],Oe={primary:"bg-flame-500/20 text-flame-400 border-flame-500/30",volume:"bg-blue-500/20 text-blue-400 border-blue-500/30",speed:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",accessories:"bg-purple-500/20 text-purple-400 border-purple-500/30",deload:"bg-green-500/20 text-green-400 border-green-500/30",test:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"};function St(){var ye,Ne;const n=Be();tt("Programs");const{user:h,userProfile:T,updateProfile:L,isAppAdmin:m}=st(),v=m,[k,M]=o.useState([]),[A,U]=o.useState(!0),[V,D]=o.useState(!1),[E,O]=o.useState([]),[i,W]=o.useState("strength"),[l,b]=o.useState(["Bench Press"]),[c,q]=o.useState(""),[p,ie]=o.useState(""),[I,_e]=o.useState(6),[S,ze]=o.useState(["monday","wednesday","friday"]),[K,He]=o.useState(45),[le,Ye]=o.useState(""),[J,Ue]=o.useState(""),[Q,oe]=o.useState(!1),[w,R]=o.useState(null),[B,P]=o.useState(null),[ce,de]=o.useState(!1),[G,xe]=o.useState("standard"),[Z,me]=o.useState(""),[ue,_]=o.useState([]),X=o.useRef(null);o.useEffect(()=>{h&&Ve()},[h]);const Ve=async()=>{try{const[t,a]=await Promise.all([Y.getByUser(h.uid),at.getByUser(h.uid)]);M(t),O(a.filter(d=>d.status==="active"));const r=await ke(De(Se(Pe,"workouts"),Ce("userId","==",h.uid),Te(50))),s={};r.docs.forEach(d=>{const j=d.data();j.status==="completed"&&(j.exercises||[]).forEach(y=>{(y.sets||[]).forEach(g=>{if(!g.actualWeight&&!g.actualReps&&g.prescribedWeight)return;const $=parseFloat(g.actualWeight||g.prescribedWeight||0),F=parseInt(g.actualReps||g.prescribedReps||0);if($>0&&F>0){const C=Math.round($*(1+F/30));(!s[y.name]||C>s[y.name].e1rm)&&(s[y.name]={e1rm:C,weight:$,reps:F})}})})}),s["Bench Press"]&&q(String(s["Bench Press"].e1rm))}catch(t){console.error("Error loading programs:",t)}finally{U(!1)}},qe=t=>{ze(a=>a.includes(t)?a.filter(r=>r!==t):[...a,t].sort((r,s)=>ae.findIndex(d=>d.id===r)-ae.findIndex(d=>d.id===s)))},Ke=t=>{const a=t.lift||"Bench Press";l.includes(a)||b(d=>[...d,a]);const r=t.currentValue??t.currentWeight??"",s=t.targetValue??t.targetWeight??"";q(String(r)),ie(String(s)),(t.metricType==="reps"||t.metricType==="time")&&W("bodyweight")},ee=t=>{b(a=>a.includes(t)?a.filter(r=>r!==t):[...a,t])},he=()=>{const t=Z.trim();t&&!l.includes(t)&&b(a=>[...a,t]),me("")},Je=()=>{_([]);let t=0;X.current=setInterval(()=>{t<Le.length&&(_(a=>[...a,{...Le[t],id:t}]),t++)},1200)},ge=()=>{X.current&&clearInterval(X.current)},Qe=async()=>{if(S.length===0){P("Select at least one training day.");return}const t=(T==null?void 0:T.credits)??0,a=G==="premium"?Ae:Me["generate-program"];if(!v&&t<a){P(`Not enough credits. Program generation costs ${a} credits, you have ${t}.`);return}oe(!0),P(null),R(null),Je();try{v||L({credits:t-a});const r={},s={},d={},j=new Date;(await ke(De(Se(Pe,"workouts"),Ce("userId","==",h.uid),Te(30)))).docs.forEach(N=>{var we;const f=N.data();if(f.status!=="completed")return;const ve=(we=f.date)!=null&&we.toDate?f.date.toDate():f.date?new Date(f.date):null,z=ve?Math.floor((j-ve)/(1e3*60*60*24)):null;(f.exercises||[]).forEach(x=>{(x.sets||[]).forEach(u=>{if(!u.actualWeight&&!u.actualReps&&u.prescribedWeight)return;const te=parseFloat(u.actualWeight||u.prescribedWeight||0),se=parseInt(u.actualReps||u.prescribedReps||0);if(te>0&&se>0){const H=Math.round(te*(1+se/30));(!r[x.name]||H>r[x.name].e1rm)&&(r[x.name]={e1rm:H,weight:te,reps:se})}if(u.painLevel&&parseInt(u.painLevel)>0){const H=parseInt(u.painLevel);s[x.name]||(s[x.name]={count:0,maxPain:0,lastDaysAgo:null,recentCount:0}),s[x.name].count++,s[x.name].maxPain=Math.max(s[x.name].maxPain,H),z!==null&&((s[x.name].lastDaysAgo===null||z<s[x.name].lastDaysAgo)&&(s[x.name].lastDaysAgo=z),z<=30&&s[x.name].recentCount++)}u.rpe&&(d[x.name]||(d[x.name]={sum:0,count:0}),d[x.name].sum+=parseFloat(u.rpe),d[x.name].count++)})})});const g={};Object.entries(d).forEach(([N,f])=>{g[N]=Math.round(f.sum/f.count*10)/10});const $=i==="bodyweight"?{lifts:l,type:"bodyweight",current:c||void 0,target:p||void 0}:{lifts:l,current:c?parseFloat(c):void 0,target:p?parseFloat(p):void 0,type:i},F=await ot(),C=await fetch(ct("generate-program"),{method:"POST",headers:F,body:JSON.stringify({goal:$,weeks:I,trainingDays:S,workoutDuration:K,programType:i,prompt:le||void 0,context:{maxLifts:r,painHistory:s,rpeAverages:g},model:G})});if(!C.ok){const N=await C.json().catch(()=>({}));throw new Error(N.error||"Failed to generate program")}const et=await C.json();R(et.program),ge(),_(N=>[...N,{text:"Program ready!",icon:"check",id:N.length}])}catch(r){console.error("Generation error:",r),P(r.message),ge(),v||L({credits:t})}finally{oe(!1)}},Ze=async()=>{if(w){de(!0);try{let t;J?t=new Date(J+"T00:00:00"):t=dt(xt(new Date,7),{weekStartsOn:1});const a=ft(t,I),r={...w,goal:i==="bodyweight"?{lifts:l,type:"bodyweight",current:c||null,target:p||null}:{lifts:l,current:c?parseFloat(c):null,target:p?parseFloat(p):null,type:i},trainingDays:S,workoutDuration:K,programType:i,startDate:t.toISOString(),endDate:a.toISOString(),numWeeks:I,completedDays:[],skippedDays:[]},s=await Y.create(h.uid,r);n(`/programs/${s.id}`)}catch(t){console.error("Save error:",t),P("Failed to save program")}finally{de(!1)}}},pe=async(t,a)=>{try{await Y.update(t,{status:a}),M(r=>r.map(s=>s.id===t?{...s,status:a}:s))}catch(r){console.error("Status update error:",r)}},fe=async t=>{if(confirm("Delete this program? This cannot be undone."))try{await Y.delete(t),M(a=>a.filter(r=>r.id!==t))}catch(a){console.error("Delete error:",a)}},Xe=t=>{switch(t){case"brain":return e.jsx(gt,{className:"w-3 h-3 text-purple-400"});case"calc":return e.jsx(re,{className:"w-3 h-3 text-blue-400"});case"dumbbell":return e.jsx(ht,{className:"w-3 h-3 text-flame-400"});case"alert":return e.jsx(ut,{className:"w-3 h-3 text-yellow-400"});case"check":return e.jsx(Ie,{className:"w-3 h-3 text-green-400"});default:return e.jsx(mt,{className:"w-3 h-3 text-iron-400"})}};if(A)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-flame-500 border-t-transparent rounded-full animate-spin"})});if(V)return e.jsxs("div",{className:"max-w-2xl mx-auto p-4 pb-32",children:[e.jsxs("button",{onClick:()=>{D(!1),R(null),P(null)},className:"flex items-center gap-2 text-iron-400 hover:text-iron-200 mb-6",children:[e.jsx(nt,{className:"w-4 h-4"})," Back to Programs"]}),e.jsx("h1",{className:"text-2xl font-display text-iron-100 mb-1",children:"Create Program"}),e.jsx("p",{className:"text-sm text-iron-500 mb-6",children:"AI designs a periodized plan — workouts generate on-demand when you train."}),w?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-steel p-5 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-flame-500/20 flex items-center justify-center",children:e.jsx(re,{className:"w-6 h-6 text-flame-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-display text-iron-100",children:w.name}),e.jsxs("p",{className:"text-sm text-iron-500",children:[l.length>0?l.join(", "):i,c&&p?`: ${c} → ${p}${i==="bodyweight"?"":"lb"}`:c?` (current: ${c}${i==="bodyweight"?"":"lb"})`:""," · ",I," weeks · ",S.length,"x/week"]})]})]}),((ye=w.phases)==null?void 0:ye.length)>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:w.phases.map((t,a)=>e.jsxs("div",{className:"px-3 py-1.5 bg-iron-800/50 rounded-lg text-xs",children:[e.jsx("span",{className:"text-iron-300 font-medium",children:t.name}),e.jsxs("span",{className:"text-iron-500 ml-1.5",children:["wk ",t.weekStart,"-",t.weekEnd]})]},a))})]}),e.jsx("div",{className:"space-y-3",children:(Ne=w.weeks)==null?void 0:Ne.map((t,a)=>{var r;return e.jsxs("div",{className:"card-steel rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-2.5 bg-iron-800/30 border-b border-iron-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-iron-200",children:["Week ",t.weekNumber]}),e.jsx("span",{className:"text-xs text-iron-500",children:t.phase})]}),e.jsx("div",{className:"p-3 space-y-2",children:(r=t.days)==null?void 0:r.map((s,d)=>{var j,y;return e.jsxs("div",{className:"flex items-start gap-3 p-2.5 bg-iron-800/20 rounded-lg",children:[e.jsx("div",{className:`px-2 py-0.5 rounded text-[10px] font-medium border flex-shrink-0 mt-0.5 ${Oe[s.type]||Oe.primary}`,children:s.type}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-iron-200 capitalize",children:(j=s.dayOfWeek)==null?void 0:j.slice(0,3)}),e.jsx("span",{className:"text-sm text-iron-300",children:"—"}),e.jsx("span",{className:"text-sm text-iron-300 truncate",children:s.label})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-0.5",children:[e.jsxs("span",{className:"text-xs text-flame-400",children:[s.primaryScheme," @ ",s.intensity]}),((y=s.accessories)==null?void 0:y.length)>0&&e.jsxs("span",{className:"text-xs text-iron-500",children:["+ ",s.accessories.length," accessories"]})]}),s.notes&&e.jsx("p",{className:"text-xs text-iron-500 mt-1",children:s.notes})]})]},d)})})]},a)})}),B&&e.jsx("p",{className:"text-red-400 text-sm",children:B}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{R(null),_([])},className:"btn-secondary flex-1",children:"Regenerate"}),e.jsx("button",{onClick:Ze,disabled:ce,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:ce?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4 animate-spin"})," Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"w-4 h-4"})," Start Program"]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[E.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Quick fill from a goal"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(t=>{const a=t.currentValue??t.currentWeight??"",r=t.targetValue??t.targetWeight??"",s=t.metricType==="time"?"sec":t.metricType==="reps"?"reps":"lb";return e.jsxs("button",{onClick:()=>Ke(t),className:"px-3 py-1.5 rounded-lg text-sm bg-iron-800 text-iron-300 hover:bg-iron-700 transition-colors border border-iron-700",children:[e.jsx("span",{className:"text-flame-400",children:t.lift}),": ",a||"—"," → ",r,s]},t.id)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Program Type"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:yt.map(t=>e.jsxs("button",{onClick:()=>{W(t.id),t.id==="bodyweight"?b([]):l.length===0&&b(["Bench Press"])},className:`p-3 rounded-xl text-center transition-colors ${i===t.id?"bg-flame-500/20 border border-flame-500/40 text-flame-400":"bg-iron-800 border border-iron-700 text-iron-400 hover:bg-iron-700"}`,children:[e.jsx("p",{className:"text-sm font-medium",children:t.label}),e.jsx("p",{className:"text-xs text-iron-500 mt-0.5",children:t.desc})]},t.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-iron-400 mb-1",children:[i==="bodyweight"?"Focus Exercises":"Primary Lifts",e.jsx("span",{className:"text-iron-600 ml-1",children:"(select any or none)"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(i==="bodyweight"?ne:Fe).map(t=>e.jsx("button",{onClick:()=>ee(t),className:`px-3 py-1.5 rounded-lg text-sm transition-colors ${l.includes(t)?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:t},t)),i==="mixed"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full border-t border-iron-800 mt-1 pt-2"}),ne.map(t=>e.jsx("button",{onClick:()=>ee(t),className:`px-3 py-1.5 rounded-lg text-sm transition-colors ${l.includes(t)?"bg-emerald-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:t},t))]}),l.filter(t=>!Fe.includes(t)&&!ne.includes(t)).map(t=>e.jsxs("button",{onClick:()=>ee(t),className:"px-3 py-1.5 rounded-lg text-sm bg-cyan-500 text-white flex items-center gap-1",children:[t," ",e.jsx("span",{className:"text-xs opacity-70",children:"x"})]},t))]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("input",{type:"text",value:Z,onChange:t=>me(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),he())},placeholder:"Type any exercise...",className:"input-field flex-1 text-sm"}),e.jsx("button",{type:"button",onClick:he,disabled:!Z.trim(),className:"px-3 py-2 rounded-lg text-sm bg-iron-800 text-iron-300 hover:bg-iron-700 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:"Add"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:i==="bodyweight"?"Current Level":"Current Max (lbs)"}),e.jsx("input",{type:i==="bodyweight"?"text":"number",inputMode:i==="bodyweight"?"text":"decimal",value:c,onChange:t=>q(t.target.value),placeholder:i==="bodyweight"?"e.g. 8 pull-ups, 30s plank":"295",className:"input-field w-full"})]}),e.jsx("div",{className:"flex items-end pb-3",children:e.jsx(Ge,{className:"w-5 h-5 text-iron-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:i==="bodyweight"?"Target":"Target (lbs)"}),e.jsx("input",{type:i==="bodyweight"?"text":"number",inputMode:i==="bodyweight"?"text":"decimal",value:p,onChange:t=>ie(t.target.value),placeholder:i==="bodyweight"?"e.g. 20 pull-ups, 5min plank":"350",className:"input-field w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Workout Duration"}),e.jsx("div",{className:"flex gap-2",children:Nt.map(t=>e.jsx("button",{onClick:()=>He(t.value),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${K===t.value?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Program Length"}),e.jsx("div",{className:"flex gap-2",children:[4,6,8,10,12].map(t=>e.jsxs("button",{onClick:()=>_e(t),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${I===t?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:[t,"wk"]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Training Days"}),e.jsx("div",{className:"flex gap-2",children:ae.map(t=>e.jsx("button",{onClick:()=>qe(t.id),className:`flex-1 py-2.5 rounded-lg text-sm font-medium transition-colors ${S.includes(t.id)?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:t.short},t.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-iron-400 mb-2",children:["Start Date ",e.jsx("span",{className:"text-iron-600",children:"(defaults to next Monday)"})]}),e.jsx("input",{type:"date",value:J,onChange:t=>Ue(t.target.value),className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-iron-400 mb-2",children:["Additional Instructions ",e.jsx("span",{className:"text-iron-600",children:"(optional)"})]}),e.jsx("textarea",{value:le,onChange:t=>Ye(t.target.value),placeholder:"e.g. I have a shoulder issue, prefer dumbbells for accessories, focus on time under tension, include paused bench...",rows:3,className:"input-field w-full resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"AI Model"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>xe("standard"),className:`flex-1 py-2.5 rounded-lg text-sm font-medium transition-colors ${G==="standard"?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:["Standard",e.jsxs("span",{className:"block text-xs opacity-70",children:[Me["generate-program"]," credits"]})]}),e.jsxs("button",{onClick:()=>xe("premium"),className:`flex-1 py-2.5 rounded-lg text-sm font-medium transition-colors relative ${G==="premium"?"bg-purple-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:["Premium",e.jsxs("span",{className:"block text-xs opacity-70",children:[Ae," credits"]})]})]})]}),Q&&ue.length>0&&e.jsxs("div",{className:"card-steel p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-flame-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-iron-400",children:"AI is designing your program..."})]}),e.jsx("div",{className:"space-y-2",children:ue.map(t=>e.jsxs(rt.div,{initial:{opacity:0,x:-8},animate:{opacity:1,x:0},className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded bg-iron-800 flex items-center justify-center flex-shrink-0",children:Xe(t.icon)}),e.jsx("span",{className:`text-sm ${t.icon==="check"?"text-green-400 font-medium":"text-iron-300"}`,children:t.text})]},t.id))})]}),B&&e.jsx("p",{className:"text-red-400 text-sm",children:B}),e.jsx("button",{onClick:Qe,disabled:Q||S.length===0,className:"btn-primary w-full flex items-center justify-center gap-2",children:Q?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-5 h-5 animate-spin"})," Designing Program..."]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-5 h-5"})," Generate Program ",e.jsx("span",{className:"text-xs opacity-70",children:"(10 credits)"})]})})]})]});const be=k.filter(t=>t.status==="active"),je=k.filter(t=>t.status!=="active");return e.jsxs("div",{className:"max-w-2xl mx-auto p-4 pb-32",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display text-iron-100",children:"Programs"}),e.jsx("p",{className:"text-sm text-iron-500",children:"AI-designed periodized training plans"})]}),e.jsxs("button",{onClick:()=>D(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"New Program"]})]}),k.length===0?e.jsxs("div",{className:"card-steel p-10 text-center border-dashed border-iron-700",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-iron-800 flex items-center justify-center mx-auto mb-4",children:e.jsx(lt,{className:"w-8 h-8 text-iron-600"})}),e.jsx("h3",{className:"text-lg font-display text-iron-200 mb-2",children:"No programs yet"}),e.jsx("p",{className:"text-sm text-iron-500 mb-6 max-w-sm mx-auto",children:"Programs are multi-week training plans designed by AI. Set a goal, pick your training days, and the AI builds the full periodization. Workouts generate fresh each session using your real data."}),e.jsxs("button",{onClick:()=>D(!0),className:"btn-primary inline-flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"}),"Create Your First Program"]})]}):e.jsxs("div",{className:"space-y-4",children:[be.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xs text-iron-500 uppercase tracking-wider mb-2",children:"Active"}),e.jsx("div",{className:"space-y-3",children:be.map(t=>e.jsx(Re,{program:t,onStatusChange:pe,onDelete:fe},t.id))})]}),je.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xs text-iron-500 uppercase tracking-wider mb-2 mt-6",children:"Past Programs"}),e.jsx("div",{className:"space-y-3",children:je.map(t=>e.jsx(Re,{program:t,onStatusChange:pe,onDelete:fe},t.id))})]})]})]})}function Re({program:n,onStatusChange:h,onDelete:T}){var D,E,O,i,W;const L=Be(),m=n.goal||{},v=(n.weeks||[]).reduce((l,b)=>{var c;return l+(((c=b.days)==null?void 0:c.length)||0)},0),k=(n.completedDays||[]).length,M=v>0?Math.round(k/v*100):0;let A=null;if(n.startDate){const l=(D=n.startDate)!=null&&D.toDate?n.startDate.toDate():new Date(n.startDate),c=Math.floor((new Date-l)/(7*24*60*60*1e3));c>=0&&c<(n.numWeeks||((E=n.weeks)==null?void 0:E.length)||0)&&(A=c+1)}const U=n.startDate?$e((O=n.startDate)!=null&&O.toDate?n.startDate.toDate():new Date(n.startDate),"MMM d"):"—",V=n.endDate?$e((i=n.endDate)!=null&&i.toDate?n.endDate.toDate():new Date(n.endDate),"MMM d"):"—";return e.jsxs("div",{className:"card-steel rounded-xl overflow-hidden",children:[e.jsx("button",{onClick:()=>L(`/programs/${n.id}`),className:"w-full p-4 text-left hover:bg-iron-800/30 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center flex-shrink-0 ${n.status==="active"?"bg-flame-500/20":"bg-iron-800"}`,children:e.jsx(re,{className:`w-5 h-5 ${n.status==="active"?"text-flame-400":"text-iron-500"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-iron-100 truncate",children:n.name}),n.status==="paused"&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] rounded bg-yellow-500/20 text-yellow-400",children:"Paused"}),n.status==="completed"&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] rounded bg-green-500/20 text-green-400",children:"Done"})]}),e.jsxs("p",{className:"text-sm text-iron-500 mt-0.5",children:[((W=m.lifts)==null?void 0:W.length)>0?m.lifts.join(", "):m.lift||m.type||"Program",m.current&&m.target?`: ${m.current} → ${m.target}${m.type==="bodyweight"?"":"lb"}`:m.current?` (${m.current}${m.type==="bodyweight"?"":"lb"})`:""," · ",U," – ",V]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-iron-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-flame-500 rounded-full transition-all",style:{width:`${M}%`}})}),e.jsxs("span",{className:"text-xs text-iron-500",children:[k,"/",v]}),A&&e.jsxs("span",{className:"text-xs text-flame-400",children:["Wk ",A]})]})]}),e.jsx(Ge,{className:"w-5 h-5 text-iron-600 flex-shrink-0 mt-1"})]})}),e.jsxs("div",{className:"flex border-t border-iron-800 divide-x divide-iron-800",children:[n.status==="active"?e.jsxs("button",{onClick:l=>{l.stopPropagation(),h(n.id,"paused")},className:"flex-1 py-2 text-xs text-iron-400 hover:text-yellow-400 hover:bg-iron-800/30 transition-colors flex items-center justify-center gap-1",children:[e.jsx(bt,{className:"w-3 h-3"})," Pause"]}):n.status==="paused"?e.jsxs("button",{onClick:l=>{l.stopPropagation(),h(n.id,"active")},className:"flex-1 py-2 text-xs text-iron-400 hover:text-green-400 hover:bg-iron-800/30 transition-colors flex items-center justify-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3"})," Resume"]}):null,e.jsxs("button",{onClick:l=>{l.stopPropagation(),T(n.id)},className:"flex-1 py-2 text-xs text-iron-400 hover:text-red-400 hover:bg-iron-800/30 transition-colors flex items-center justify-center gap-1",children:[e.jsx(jt,{className:"w-3 h-3"})," Delete"]})]})]})}export{St as default};

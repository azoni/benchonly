const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BdPqgTIW.js","assets/index-S268y3hy.css"])))=>i.map(i=>d[i]);
import{a as qs,b as Vs,c as Js,u as Zs,d as Ks,e as Xs,r as b,g as L,f as Qs,h as Is,_ as rs,j as e,i as pe,U as Te,X as z,P as he,C as se,A as et,k as st,S as tt,m as D,E as at,T as rt,B as is,l as ue,n as fe,o as te,p as ls,Z as ns,H as os,R as it,q as lt,L as nt,s as ot,t as ct,v as dt,w as cs,x as ds,y as xt,z as mt}from"./index-BdPqgTIW.js";import{E as xs}from"./ExerciseInfoModal-DcK3BaxB.js";import{W as pt}from"./WorkoutSummaryCard-B2zrFQKr.js";import{T as be}from"./trash-2-WQaPhAcm.js";import{S as ht}from"./share-2-DiRvGHla.js";import{P as ae}from"./pencil-BwDh2SvO.js";import{F as ut}from"./file-text-R8wY_AVA.js";import{M as re}from"./message-square-S56mHBN_.js";import{S as ft}from"./search-Dq056VB6.js";import{I as bt}from"./info-3YvsxJ9T.js";import"./external-link-BDFbsyp_.js";const gt=(v,k)=>!v||!k||k<1?null:k===1?v:k>30?null:Math.round(v*(1+k/30)),T=v=>{if(v.type)return v.type;const k=v.sets||[];return k.some(j=>j.prescribedTime||j.actualTime)?"time":!k.some(j=>j.prescribedWeight||j.actualWeight)&&k.some(j=>j.prescribedReps||j.actualReps)?"bodyweight":"weight"},ms=v=>{switch(v){case"time":return{label:"Time",color:"bg-blue-500/20 text-blue-400"};case"bodyweight":return{label:"BW",color:"bg-emerald-500/20 text-emerald-400"};default:return null}};function Wt(){var es,ss,ts;const{id:v}=qs(),k=Vs(),q=Js();Zs("Group Workout");const{user:j}=Ks(),ge=Xs(s=>s.sidebarOpen),[n,_]=b.useState(null),[P,ps]=b.useState(null),[hs,us]=b.useState(!0),[G,B]=b.useState(!1),[A,U]=b.useState(!1),[E,S]=b.useState([]),[We,Fe]=b.useState(""),[fs,bs]=b.useState(""),[gs,Me]=b.useState(!1),[Y,Pe]=b.useState(!1),[je,js]=b.useState(!1),[ie,V]=b.useState(null),[le,J]=b.useState(null),[Ae,ne]=b.useState(null),[Ne,Z]=b.useState(null),[ve,K]=b.useState(""),[$e,Ns]=b.useState({}),[we,Le]=b.useState({}),[vs,oe]=b.useState(!1),[ye,ws]=b.useState([]),[ke,ys]=b.useState({}),[Re,ks]=b.useState(""),[H,_e]=b.useState(null),[Be,De]=b.useState(""),[ce,Ge]=b.useState(!1),[Rs,Oe]=b.useState(!1),[Cs,de]=b.useState(!1),[Ce,ze]=b.useState(""),[Ue,Ye]=b.useState(""),[Se,$]=b.useState([]);b.useEffect(()=>{Ss()},[v]);const Ss=async()=>{try{const s=await L.get(v);if(s){_(s),Fe(s.notes||""),bs(s.personalNotes||""),s.exercises&&S(s.exercises.map(t=>{var a;return{...t,type:T(t),notes:t.notes||"",userNotes:t.userNotes||"",sets:((a=t.sets)==null?void 0:a.map(i=>({...i})))||[]}}));const r=await Qs.get(s.groupId);ps(r)}}catch(s){console.error("Error loading workout:",s)}finally{us(!1)}};b.useEffect(()=>{var s;(s=q.state)!=null&&s.openShare&&n&&(window.history.replaceState({},""),setTimeout(()=>He(),100))},[n]);const He=async()=>{oe(!0),_e(null),De(""),Oe(!1);try{const s=await Is.getFriends(j.uid);ws(s);const r={},{getDoc:t,doc:a}=await rs(async()=>{const{getDoc:o,doc:c}=await import("./index-BdPqgTIW.js").then(p=>p.bc);return{getDoc:o,doc:c}},__vite__mapDeps([0,1])),{db:i}=await rs(async()=>{const{db:o}=await import("./index-BdPqgTIW.js").then(c=>c.bd);return{db:o}},__vite__mapDeps([0,1]));await Promise.all(s.map(async o=>{const c=await t(a(i,"users",o));c.exists()&&(r[o]=c.data())})),ys(r)}catch(s){console.error("Error loading friends:",s)}},Es=async()=>{var s;if(!(!H||!n||ce)){Ge(!0);try{const r=((s=ke[H])==null?void 0:s.displayName)||"";await dt.share(j.uid,j.displayName||"Someone",H,n,Be,r),Oe(!0),setTimeout(()=>oe(!1),1500)}catch(r){console.error("Share error:",r)}finally{Ge(!1)}}},Ts=()=>{ze(n.name||""),Ye(n.description||""),$((n.exercises||[]).map((s,r)=>{var t;return{...s,_id:r,type:T(s),sets:((t=s.sets)==null?void 0:t.map((a,i)=>({...a,_id:i})))||[]}})),de(!0)},Ws=async()=>{if(!Ce.trim()){alert("Please enter a workout name");return}B(!0);try{const s=Se.map(({_id:t,...a})=>{var i;return{...a,sets:((i=a.sets)==null?void 0:i.map(({_id:o,...c})=>c))||[]}}),r={name:Ce.trim(),description:Ue.trim(),exercises:s};await L.update(v,r),_(t=>({...t,...r})),S(s.map(t=>{var a;return{...t,type:T(t),notes:t.notes||"",userNotes:t.userNotes||"",sets:((a=t.sets)==null?void 0:a.map(i=>({...i})))||[]}})),de(!1)}catch(s){console.error("Error saving workout edits:",s),alert("Failed to save changes")}finally{B(!1)}},xe=(s,r,t,a)=>{$(i=>{const o=[...i];return o[s]={...o[s],sets:o[s].sets.map((c,p)=>p===r?{...c,[t]:a}:c)},o})},Fs=s=>{$(r=>{const t=[...r],a=t[s],i=a.sets[a.sets.length-1],o=a.type||"weight";let c={_id:Date.now()+Math.random()};return o==="time"?c={...c,prescribedTime:(i==null?void 0:i.prescribedTime)||""}:o==="bodyweight"?c={...c,prescribedReps:(i==null?void 0:i.prescribedReps)||""}:c={...c,prescribedWeight:(i==null?void 0:i.prescribedWeight)||"",prescribedReps:(i==null?void 0:i.prescribedReps)||""},t[s]={...a,sets:[...a.sets,c]},t})},Ms=(s,r)=>{$(t=>{const a=[...t],i=a[s];return i.sets.length<=1?t:(a[s]={...i,sets:i.sets.filter((o,c)=>c!==r)},a)})},Ps=()=>{$(s=>[...s,{_id:Date.now(),name:"",type:"weight",notes:"",sets:[{_id:Date.now()+.1,prescribedWeight:"",prescribedReps:""}]}])},As=s=>{$(r=>r.length<=1?r:r.filter((t,a)=>a!==s))},qe=()=>{var s,r;(s=q.state)!=null&&s.from?k(q.state.from,{state:(r=q.state)==null?void 0:r.backState}):n!=null&&n.groupId?k(`/groups/${n.groupId}`,{state:{activeTab:"workouts"}}):k(-1)},$s=async()=>{if(confirm("Delete this workout? This cannot be undone."))try{await L.delete(v),n!=null&&n.groupId?k(`/groups/${n.groupId}`,{state:{activeTab:"workouts"}}):k(-1)}catch(s){console.error("Error deleting workout:",s),alert("Failed to delete workout")}},Ve=async(s,r)=>{var a;const t=A?E[s]:(a=n==null?void 0:n.exercises)==null?void 0:a[s];if(t){ne(s);try{const i=(A?E:n.exercises).filter((h,u)=>u!==s).map(h=>h.name),o=await cs(),c=await fetch(ds("swap-exercise"),{method:"POST",headers:o,body:JSON.stringify({exerciseName:t.name,exerciseType:t.type||"weight",sets:t.sets,workoutContext:{otherExercises:i},...r?{reason:r}:{}})});if(!c.ok)throw new Error("Swap failed");const p=await c.json();if(p.exercise){const h=(A?E:n.exercises).map((u,l)=>l===s?{...p.exercise,type:p.exercise.type||u.type||"weight"}:u);await L.update(v,{exercises:h}),_(u=>({...u,exercises:h})),A&&S(h.map(u=>{var l;return{...u,notes:u.notes||"",sets:((l=u.sets)==null?void 0:l.map(m=>({...m})))||[]}}))}}catch(i){console.error("Swap error:",i)}finally{ne(null)}}},Je=async(s,r)=>{var a;const t=A?E[s]:(a=n==null?void 0:n.exercises)==null?void 0:a[s];if(t){ne(s),V(null),J(null);try{const i=(A?E:n.exercises).filter((h,u)=>u!==s).map(h=>h.name),o=await cs(),c=await fetch(ds("swap-exercise"),{method:"POST",headers:o,body:JSON.stringify({exerciseName:t.name,exerciseType:t.type||"weight",sets:t.sets,workoutContext:{otherExercises:i},preferredReplacement:r})});if(!c.ok)throw new Error("Swap failed");const p=await c.json();if(p.exercise){const h=(A?E:n.exercises).map((u,l)=>l===s?{...p.exercise,type:p.exercise.type||u.type||"weight"}:u);await L.update(v,{exercises:h}),_(u=>({...u,exercises:h})),A&&S(h.map(u=>{var l;return{...u,notes:u.notes||"",sets:((l=u.sets)==null?void 0:l.map(m=>({...m})))||[]}}))}}catch(i){console.error("Substitution swap error:",i)}finally{ne(null)}}},w=(s,r,t,a)=>{S(i=>{const o=[...i];return o[s]={...o[s],sets:o[s].sets.map((c,p)=>p===r?{...c,[t]:a}:c)},o})},Ee=(s,r)=>{S(t=>{const a=[...t];return a[s]={...a[s],userNotes:r},a})},Ze=s=>{S(r=>{const t=[...r],a=t[s],i=a==null?void 0:a.supersetGroup,o=[s];return i!=null&&t.forEach((c,p)=>{p!==s&&c.supersetGroup===i&&o.push(p)}),o.forEach(c=>{const p=t[c],h=p.sets[p.sets.length-1],u=p.type||"weight";let l={id:Date.now()+Math.random(),rpe:"",painLevel:0,completed:!1};u==="time"?l={...l,prescribedTime:(h==null?void 0:h.prescribedTime)||"",actualTime:""}:u==="bodyweight"?l={...l,prescribedReps:(h==null?void 0:h.prescribedReps)||"",actualReps:""}:l={...l,prescribedWeight:(h==null?void 0:h.prescribedWeight)||"",prescribedReps:(h==null?void 0:h.prescribedReps)||"",actualWeight:"",actualReps:""},t[c]={...p,sets:[...p.sets,l]}}),t})},Ke=(s,r)=>{S(t=>{const a=[...t],i=a[s];if(i.sets.length<=1)return t;const o=i==null?void 0:i.supersetGroup;return a[s]={...i,sets:i.sets.filter((c,p)=>p!==r)},o!=null&&a.forEach((c,p)=>{p!==s&&c.supersetGroup===o&&(a[p]={...c,sets:c.sets.filter((h,u)=>u!==r)})}),a})},Xe=s=>{S(r=>{if(r.length<=1)return r;const t=r[s];return(t==null?void 0:t.supersetGroup)!=null?r.filter(a=>a.supersetGroup!==t.supersetGroup):r.filter((a,i)=>i!==s)})},Qe=s=>{const r={exercises:s,notes:We,personalNotes:fs};return n.coachingNotes&&(r.coachingNotes=n.coachingNotes),n.description&&(r.description=n.description),r},Ls=async()=>{B(!0);try{const s=Qe(E);await L.update(v,s),_(r=>({...r,...s})),U(!1)}catch(s){console.error("Error saving workout:",s),alert("Failed to save workout")}finally{B(!1)}},_s=async()=>{B(!0);try{const s=E.map(a=>{const i=a.type||T(a);return{...a,sets:a.sets.map(o=>i==="time"?{...o,actualTime:o.actualTime||o.prescribedTime||""}:i==="bodyweight"?{...o,actualReps:o.actualReps||o.prescribedReps||""}:{...o,actualWeight:o.actualWeight||o.prescribedWeight||"",actualReps:o.actualReps||o.prescribedReps||""})}}),r=Qe(s);n.completedBy&&n.completedBy!==n.assignedTo&&j.uid===n.assignedTo&&(r.reviewStatus="edited",r.reviewedAt=new Date),await L.complete(v,r,j.uid,n.assignedTo),_(a=>({...a,...r,status:"completed",completedBy:j.uid!==n.assignedTo?j.uid:void 0,reviewStatus:j.uid!==n.assignedTo?"pending":"self"})),S(s),U(!1)}catch(s){console.error("Error completing workout:",s),alert("Failed to complete workout")}finally{B(!1)}},Bs=async()=>{B(!0);try{await L.approveReview(v),_(s=>({...s,reviewStatus:"approved"}))}catch(s){console.error("Error approving review:",s),alert("Failed to approve")}finally{B(!1)}},Ds=()=>{U(!0)},Gs=s=>{if(!s)return"";try{const r=xt(s);return isNaN(r.getTime())?"":mt(r,"EEEE, MMM d")}catch{return""}},Os=async()=>{if(confirm("Mark this workout as incomplete? It will go back to scheduled status."))try{await L.update(v,{status:"scheduled",completedAt:null}),_(s=>({...s,status:"scheduled",completedAt:null}))}catch(s){console.error("Error marking incomplete:",s),alert("Failed to update workout status")}},zs=s=>s>=9?"text-red-400":s>=7?"text-yellow-400":"text-green-400",Us=s=>s>=7?"bg-red-500/20 text-red-400":s>=4?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400";if(hs)return e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx(pe,{className:"w-8 h-8 text-flame-500 animate-spin"})});if(!n)return e.jsxs("div",{className:"max-w-md mx-auto px-4 py-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-iron-800 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Te,{className:"w-8 h-8 text-iron-600"})}),e.jsx("h2",{className:"text-xl font-display text-iron-200 mb-2",children:"Workout Not Found"}),e.jsx("p",{className:"text-iron-500 mb-6",children:"This workout may have been deleted or you don't have access."}),e.jsx("button",{onClick:qe,className:"btn-primary",children:"Go Back"})]});const y=n.status==="completed",X=n.assignedTo===(j==null?void 0:j.uid),Q=(es=P==null?void 0:P.admins)==null?void 0:es.includes(j==null?void 0:j.uid),Ys=X||Q,Ie=n.coachingNotes||n.personalNotes||n.description,me=X&&n.reviewStatus==="pending"&&n.completedBy,I=n.reviewStatus==="approved",Hs=n.reviewStatus==="edited";return Cs?e.jsxs("div",{className:"max-w-2xl mx-auto pb-36",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-iron-950/95 backdrop-blur-sm border-b border-iron-800 -mx-4 px-4 py-3 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>de(!1),className:"p-2 -ml-2 text-iron-400 hover:text-iron-200 transition-colors",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg text-iron-100",children:"Edit Workout"}),e.jsx("div",{className:"w-9"})]})}),e.jsxs("div",{className:"card-steel p-4 mb-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1",children:"Workout Name"}),e.jsx("input",{type:"text",value:Ce,onChange:s=>ze(s.target.value),placeholder:"e.g., Upper Body, Bench Day",className:"w-full input-field text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1",children:"Description (optional)"}),e.jsx("textarea",{value:Ue,onChange:s=>Ye(s.target.value),placeholder:"Workout focus or instructions",rows:2,className:"w-full input-field text-sm resize-none"})]})]}),e.jsxs("div",{className:"space-y-4",children:[Se.map((s,r)=>{var a;const t=s.type||"weight";return e.jsxs("div",{className:"card-steel overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-iron-800/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"text",value:s.name||"",onChange:i=>{$(o=>{const c=[...o];return c[r]={...c[r],name:i.target.value},c})},placeholder:"Exercise name",className:"flex-1 bg-transparent text-lg font-bold text-iron-50 border-none focus:outline-none placeholder:text-iron-600"}),Se.length>1&&e.jsx("button",{onClick:()=>As(r),className:"p-1.5 text-iron-600 hover:text-red-400 transition-colors",title:"Remove exercise",children:e.jsx(be,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex gap-2",children:[{t:"weight",label:"Weight"},{t:"bodyweight",label:"BW"},{t:"time",label:"Time"}].map(({t:i,label:o})=>e.jsx("button",{onClick:()=>{$(c=>{const p=[...c],h=p[r],u=h.sets.map(l=>{const m={_id:l._id};return i==="time"?{...m,prescribedTime:""}:i==="bodyweight"?{...m,prescribedReps:""}:{...m,prescribedWeight:"",prescribedReps:""}});return p[r]={...h,type:i,sets:u},p})},className:`px-3 py-1 text-xs rounded-lg transition-colors ${t===i?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:text-iron-200"}`,children:o},i))}),e.jsx("textarea",{value:s.notes||"",onChange:i=>{$(o=>{const c=[...o];return c[r]={...c[r],notes:i.target.value},c})},placeholder:"Coach notes for this exercise (optional)",rows:1,className:"w-full input-field text-xs resize-none mt-2"})]}),e.jsx("div",{className:"divide-y divide-iron-800/50",children:(a=s.sets)==null?void 0:a.map((i,o)=>e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-iron-800 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-lg font-bold text-iron-400",children:o+1})}),t==="time"?e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"number",inputMode:"numeric",value:i.prescribedTime||"",onChange:c=>xe(r,o,"prescribedTime",c.target.value),placeholder:"seconds",className:"w-full input-field text-lg py-2.5 px-3 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-1",children:"seconds"})]}):t==="bodyweight"?e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"text",inputMode:"numeric",value:i.prescribedReps||"",onChange:c=>xe(r,o,"prescribedReps",c.target.value),placeholder:"reps",className:"w-full input-field text-lg py-2.5 px-3 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-1",children:"reps"})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2 flex-1",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:i.prescribedWeight||"",onChange:c=>xe(r,o,"prescribedWeight",c.target.value),placeholder:"lbs",className:"w-full input-field text-lg py-2.5 px-3 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-1",children:"lbs"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"text",inputMode:"numeric",value:i.prescribedReps||"",onChange:c=>xe(r,o,"prescribedReps",c.target.value),placeholder:"reps",className:"w-full input-field text-lg py-2.5 px-3 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-1",children:"reps"})]})]}),s.sets.length>1&&e.jsx("button",{onClick:()=>Ms(r,o),className:"p-1.5 text-iron-600 hover:text-red-400 transition-colors",children:e.jsx(z,{className:"w-4 h-4"})})]})},i._id))}),e.jsx("div",{className:"px-4 py-2",children:e.jsxs("button",{onClick:()=>Fs(r),className:`w-full py-2.5 border border-dashed border-iron-700 rounded-lg
                      text-sm text-flame-400 hover:text-flame-300 hover:border-iron-600
                      flex items-center justify-center gap-1.5 transition-colors`,children:[e.jsx(he,{className:"w-4 h-4"}),"Add Set"]})})]},s._id)}),e.jsxs("button",{onClick:Ps,className:`w-full py-4 border-2 border-dashed border-iron-700 rounded-xl
              text-iron-400 hover:text-iron-200 hover:border-iron-600
              flex items-center justify-center gap-2 transition-colors`,children:[e.jsx(he,{className:"w-5 h-5"}),"Add Exercise"]})]}),e.jsx("div",{className:`fixed bottom-0 right-0 p-4 bg-iron-950/95 backdrop-blur-sm border-t border-iron-800 left-0 ${ge?"lg:left-64":"lg:left-20"} transition-[left] duration-300`,children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>de(!1),className:"btn-secondary flex-1 py-3",children:"Cancel"}),e.jsxs("button",{onClick:Ws,disabled:G,className:"btn-primary flex-1 py-3 flex items-center justify-center gap-2",children:[G?e.jsx(pe,{className:"w-4 h-4 animate-spin"}):e.jsx(se,{className:"w-5 h-5"}),G?"Saving...":"Save Changes"]})]})})]}):A?e.jsxs("div",{className:"max-w-2xl mx-auto pb-36",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-iron-950/95 backdrop-blur-sm border-b border-iron-800 -mx-4 px-4 py-3 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>U(!1),className:"p-2 -ml-2 text-iron-400 hover:text-iron-200 transition-colors",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg text-iron-100",children:y?"Edit Log":"Log Workout"}),e.jsx("button",{onClick:()=>Me(!0),className:"p-2 text-iron-400 hover:text-iron-200 transition-colors",children:e.jsx(bt,{className:"w-5 h-5"})})]})}),Ie&&e.jsxs("div",{className:"card-steel mb-4 overflow-hidden",children:[e.jsxs("button",{onClick:()=>Pe(!Y),className:"w-full flex items-center justify-between p-3 hover:bg-iron-800/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4 text-flame-400"}),e.jsx("span",{className:"text-sm font-medium text-iron-300",children:"AI Coaching Notes"})]}),Y?e.jsx(ue,{className:"w-4 h-4 text-iron-500"}):e.jsx(fe,{className:"w-4 h-4 text-iron-500"})]}),e.jsx(te,{children:Y&&e.jsx(D.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"px-3 pb-3 max-h-48 overflow-y-auto space-y-2",children:[n.coachingNotes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wider mb-1",children:"Coaching"}),e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed",children:n.coachingNotes})]}),n.personalNotes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wider mb-1",children:"For You"}),e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed",children:n.personalNotes})]})]})})})]}),e.jsxs("div",{className:"card-steel p-4 mb-4",children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Workout Notes"}),e.jsx("textarea",{value:We,onChange:s=>Fe(s.target.value),placeholder:"How did the workout go?",rows:2,className:"w-full input-field text-sm resize-none"})]}),e.jsx("div",{className:"space-y-4",children:ls(E).map((s,r)=>{var c,p,h,u;if(s.type==="superset"){const{exerciseA:l,exerciseB:m,indexA:N,indexB:d}=s,C=(x,g,f,R)=>{const O=g.type||T(g);return O==="time"?e.jsxs("div",{children:[e.jsx("input",{type:"number",inputMode:"numeric",value:f.actualTime||"",onChange:M=>w(x,R,"actualTime",M.target.value),placeholder:f.prescribedTime||"—",className:"w-full input-field text-lg py-2 px-3 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-0.5",children:"seconds"})]}):O==="bodyweight"?e.jsx("div",{className:"grid grid-cols-2 gap-2",children:e.jsxs("div",{children:[e.jsx("input",{type:"number",inputMode:"numeric",value:f.actualReps||"",onChange:M=>w(x,R,"actualReps",M.target.value),placeholder:f.prescribedReps||"—",className:"w-full input-field text-lg py-2 px-3 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-0.5",children:"reps"})]})}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:f.actualWeight||"",onChange:M=>w(x,R,"actualWeight",M.target.value),placeholder:f.prescribedWeight||"lbs",className:"w-full input-field text-lg py-2 px-3 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-0.5",children:"lbs"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",inputMode:"numeric",value:f.actualReps||"",onChange:M=>w(x,R,"actualReps",M.target.value),placeholder:f.prescribedReps||"—",className:"w-full input-field text-lg py-2 px-3 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-0.5",children:"reps"})]})]})},W=(x,g,f,R)=>{const O=g.type||T(g);O==="time"?w(x,R,"actualTime",f.prescribedTime||""):(O==="bodyweight"||w(x,R,"actualWeight",f.prescribedWeight||""),w(x,R,"actualReps",f.prescribedReps||""))},F=(x,g)=>{const f=x.type||T(x);return f==="time"?`${g.prescribedTime||"—"}s`:f==="bodyweight"?`${g.prescribedReps||"—"} reps`:`${g.prescribedWeight||"—"} × ${g.prescribedReps||"—"}`};return e.jsxs("div",{className:"card-steel overflow-hidden border border-purple-500/20",children:[e.jsxs("div",{className:"p-4 bg-iron-800/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 rounded bg-purple-500/10 text-purple-400 text-xs font-semibold",children:[e.jsx(ns,{className:"w-3 h-3"})," Superset"]}),e.jsxs("h3",{className:"text-lg font-bold text-iron-50 flex-1",children:[l.name," ",e.jsx("span",{className:"text-iron-600",children:"/"})," ",m.name]}),E.length>2&&e.jsx("button",{onClick:()=>Xe(N),className:"p-1.5 text-iron-600 hover:text-red-400 transition-colors",title:"Remove superset",children:e.jsx(be,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-sm text-iron-500 mt-1",children:[((c=l.sets)==null?void 0:c.length)||0," sets"]})]}),e.jsx("div",{className:"divide-y divide-iron-800/50",children:(p=l.sets)==null?void 0:p.map((x,g)=>{var as;const f=(as=m.sets)==null?void 0:as[g],R=(()=>{const ee=l.type||T(l);return ee==="time"?!!x.actualTime:ee==="bodyweight"?!!x.actualReps:!!(x.actualWeight&&x.actualReps)})(),O=f?(()=>{const ee=m.type||T(m);return ee==="time"?!!f.actualTime:ee==="bodyweight"?!!f.actualReps:!!(f.actualWeight&&f.actualReps)})():!1,M=R&&O;return e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${M?"bg-green-500/15 ring-1 ring-green-500/30":"bg-iron-800"}`,children:e.jsx("span",{className:`text-lg font-bold ${M?"text-green-400":"text-iron-400"}`,children:g+1})}),e.jsxs("button",{onClick:()=>{W(N,l,x,g),f&&W(d,m,f,g)},className:"flex-1 text-left hover:text-flame-400 active:scale-[0.98] transition-all",title:"Tap to fill both with targets",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-wider text-iron-600 block",children:"Targets"}),e.jsxs("span",{className:"text-xs font-medium text-iron-400",children:["A: ",F(l,x)," · B: ",f?F(m,f):"—"]})]}),l.sets.length>1&&e.jsx("button",{onClick:()=>Ke(N,g),className:"p-1.5 text-iron-600 hover:text-red-400 transition-colors",children:e.jsx(z,{className:"w-4 h-4"})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-purple-400 font-medium mb-1.5",children:["A — ",l.name]}),C(N,l,x,g)]}),f&&e.jsxs("div",{className:"pt-2 border-t border-iron-700/30",children:[e.jsxs("p",{className:"text-xs text-purple-400 font-medium mb-1.5",children:["B — ",m.name]}),C(d,m,f,g)]})]},g)})}),e.jsx("div",{className:"px-4 pt-2 pb-1",children:e.jsxs("button",{onClick:()=>Ze(N),className:"w-full py-2.5 border border-dashed border-iron-700 rounded-lg text-sm text-flame-400 hover:text-flame-300 hover:border-iron-600 flex items-center justify-center gap-1.5 transition-colors",children:[e.jsx(he,{className:"w-4 h-4"})," Add Set"]})}),e.jsx("div",{className:"px-4 pb-4",children:l.userNotes||m.userNotes||we[`ss-${s.supersetGroup}`]?e.jsx("textarea",{value:l.userNotes||"",onChange:x=>{Ee(N,x.target.value),Ee(d,x.target.value)},placeholder:"How did the superset feel?",rows:2,className:"w-full input-field text-sm resize-none"}):e.jsxs("button",{onClick:()=>Le(x=>({...x,[`ss-${s.supersetGroup}`]:!0})),className:"w-full text-left text-sm text-iron-600 hover:text-iron-400 py-2 transition-colors flex items-center gap-2",children:[e.jsx(ae,{className:"w-3.5 h-3.5"})," Add notes..."]})})]},`ss-${s.supersetGroup}`)}const t=s.exercise,a=s.index,i=t.type||T(t),o=ms(i);return e.jsxs("div",{className:"card-steel overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-iron-800/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{V(t),J(a)},className:"text-xl font-bold text-iron-50 hover:text-flame-400 transition-colors text-left flex-1 flex items-center gap-1.5",children:[t.name,e.jsx(os,{className:"w-3.5 h-3.5 text-iron-600 flex-shrink-0"})]}),o&&e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${o.color}`,children:o.label}),E.length>1&&e.jsx("button",{onClick:()=>Xe(a),className:"p-1.5 text-iron-600 hover:text-red-400 transition-colors",title:"Remove exercise",children:e.jsx(be,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-sm text-iron-500 mt-1",children:[((h=t.sets)==null?void 0:h.length)||0," sets"]}),t.notes&&e.jsxs("div",{className:"flex items-start gap-2 mt-2 bg-iron-900/50 rounded-lg p-2.5",children:[e.jsx(re,{className:"w-3.5 h-3.5 text-iron-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed",children:t.notes})]})]}),e.jsx("div",{className:"divide-y divide-iron-800/50",children:(u=t.sets)==null?void 0:u.map((l,m)=>{const N=i==="time"?!!l.actualTime:i==="bodyweight"?!!l.actualReps:!!(l.actualWeight&&l.actualReps);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${N?"bg-green-500/15 ring-1 ring-green-500/30":"bg-iron-800"}`,children:e.jsx("span",{className:`text-lg font-bold ${N?"text-green-400":"text-iron-400"}`,children:m+1})}),e.jsxs("button",{onClick:()=>{i==="time"?w(a,m,"actualTime",l.prescribedTime||""):(i==="bodyweight"||w(a,m,"actualWeight",l.prescribedWeight||""),w(a,m,"actualReps",l.prescribedReps||""))},className:"flex-1 text-left hover:text-flame-400 active:scale-[0.98] transition-all",title:"Tap to fill with target values",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-wider text-iron-600 block",children:"Target"}),e.jsxs("span",{className:"text-sm font-medium text-iron-400",children:[i==="time"?`${l.prescribedTime||"—"}s`:i==="bodyweight"?`${l.prescribedReps||"—"} reps`:`${l.prescribedWeight||"—"} lbs × ${l.prescribedReps||"—"}`,l.targetRpe?` @ RPE ${l.targetRpe}`:""]})]}),t.sets.length>1&&e.jsx("button",{onClick:()=>Ke(a,m),className:"p-1.5 text-iron-600 hover:text-red-400 transition-colors",children:e.jsx(z,{className:"w-4 h-4"})})]}),i==="time"?e.jsxs("div",{className:"ml-[52px]",children:[e.jsx("input",{type:"number",inputMode:"numeric",value:l.actualTime||"",onChange:d=>w(a,m,"actualTime",d.target.value),placeholder:l.prescribedTime||"—",className:"w-full input-field text-xl py-3 px-4 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-1",children:"seconds"})]}):i==="bodyweight"?e.jsxs("div",{className:"ml-[52px]",children:[e.jsx("input",{type:"number",inputMode:"numeric",value:l.actualReps||"",onChange:d=>w(a,m,"actualReps",d.target.value),placeholder:l.prescribedReps||"—",className:"w-full input-field text-xl py-3 px-4 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-1",children:"reps"})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2 ml-[52px]",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const d=parseFloat(l.actualWeight||l.prescribedWeight||0);d>=5&&w(a,m,"actualWeight",String(Math.round(d-5)))},className:"w-9 h-11 rounded-lg bg-iron-700/80 text-iron-400 hover:text-iron-200 hover:bg-iron-700 active:scale-95 transition-all text-lg font-bold flex-shrink-0 flex items-center justify-center",children:"−"}),e.jsx("input",{type:"text",value:l.actualWeight||"",onChange:d=>w(a,m,"actualWeight",d.target.value),placeholder:l.prescribedWeight||"lbs",className:"w-full input-field text-lg py-2.5 px-2 text-center font-semibold"}),e.jsx("button",{onClick:()=>{const d=parseFloat(l.actualWeight||l.prescribedWeight||0);w(a,m,"actualWeight",String(Math.round(d+5)))},className:"w-9 h-11 rounded-lg bg-iron-700/80 text-iron-400 hover:text-iron-200 hover:bg-iron-700 active:scale-95 transition-all text-lg font-bold flex-shrink-0 flex items-center justify-center",children:"+"})]}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-1",children:"lbs"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",inputMode:"numeric",value:l.actualReps||"",onChange:d=>w(a,m,"actualReps",d.target.value),placeholder:l.prescribedReps||"—",className:"w-full input-field text-lg py-2.5 px-2 text-center font-semibold"}),e.jsx("p",{className:"text-[10px] text-iron-600 text-center mt-1",children:"reps"})]})]})]},m)})}),e.jsx("div",{className:"px-4 pt-2 pb-1",children:e.jsxs("button",{onClick:()=>Ze(a),className:`w-full py-2.5 border border-dashed border-iron-700 rounded-lg
                  text-sm text-flame-400 hover:text-flame-300 hover:border-iron-600
                  flex items-center justify-center gap-1.5 transition-colors`,children:[e.jsx(he,{className:"w-4 h-4"}),"Add Set"]})}),e.jsxs("div",{className:"px-4 pb-2",children:[e.jsxs("button",{onClick:()=>Ns(l=>({...l,[a]:!l[a]})),className:"flex items-center gap-2 py-2 text-sm text-iron-500 hover:text-iron-300 transition-colors w-full",children:[e.jsx(ct,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[t.rpe?`RPE ${t.rpe}`:"RPE",(t.painLevel||0)>0?` · Pain ${t.painLevel}`:""]}),$e[a]?e.jsx(ue,{className:"w-3.5 h-3.5 ml-auto"}):e.jsx(fe,{className:"w-3.5 h-3.5 ml-auto"})]}),$e[a]&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("label",{className:"text-[10px] text-iron-500 uppercase tracking-wider w-6",children:"RPE"}),[6,7,8,9,10].map(l=>e.jsx("button",{onClick:()=>{S(m=>{const N=[...m];return N[a]={...N[a],rpe:N[a].rpe==l?"":String(l)},N})},className:`w-8 h-8 text-xs rounded-lg border transition-colors ${t.rpe==l?"border-flame-500 bg-flame-500/15 text-flame-400 font-semibold":"border-iron-700/60 text-iron-500 hover:border-iron-600"}`,children:l},l))]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("label",{className:"text-[10px] text-iron-500 uppercase tracking-wider w-7",children:"Pain"}),[1,2,3,4,5].map(l=>e.jsx("button",{onClick:()=>{S(m=>{const N=[...m];return N[a]={...N[a],painLevel:(N[a].painLevel||0)===l?0:l},N})},className:`w-8 h-8 text-xs rounded-lg border transition-colors ${(t.painLevel||0)===l?l<=2?"border-yellow-500/50 bg-yellow-500/10 text-yellow-400 font-semibold":"border-red-500/50 bg-red-500/10 text-red-400 font-semibold":"border-iron-700/60 text-iron-500 hover:border-iron-600"}`,children:l},l))]})]})]}),e.jsx("div",{className:"px-4 pb-4",children:t.userNotes||we[a]?e.jsx("textarea",{value:t.userNotes||"",onChange:l=>Ee(a,l.target.value),placeholder:"How did this feel? Any discomfort?",rows:2,autoFocus:we[a]&&!t.userNotes,className:"w-full input-field text-sm resize-none"}):e.jsxs("button",{onClick:()=>Le(l=>({...l,[a]:!0})),className:"w-full text-left text-sm text-iron-600 hover:text-iron-400 py-2 transition-colors flex items-center gap-2",children:[e.jsx(ae,{className:"w-3.5 h-3.5"}),"Add notes..."]})})]},a)})}),e.jsxs("div",{className:`fixed bottom-0 right-0 p-4 bg-iron-950/95 backdrop-blur-sm border-t border-iron-800 left-0 ${ge?"lg:left-64":"lg:left-20"} transition-[left] duration-300`,children:[e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsx("button",{onClick:()=>U(!1),className:"btn-secondary flex-1 py-3",children:"Cancel"}),e.jsx("button",{onClick:Ls,disabled:G,className:"btn-secondary flex-1 py-3",children:"Save Progress"})]}),e.jsx("button",{onClick:_s,disabled:G,className:"btn-primary w-full py-4 text-lg flex items-center justify-center gap-2",children:G?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-5 h-5"}),me?"Save Changes":y?"Update":"Complete"]})}),e.jsx("p",{className:"text-xs text-iron-500 text-center mt-2",children:me?"Your changes will replace coach data":"Empty fields filled with targets"})]}),gs&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-iron-900 rounded-xl w-full max-w-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-display text-xl text-iron-100",children:"RPE Scale"}),e.jsx("button",{onClick:()=>Me(!1),className:"p-2 text-iron-400 hover:text-iron-200",children:e.jsx(z,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-iron-400 text-sm mb-4",children:"Rate of Perceived Exertion"}),e.jsx("div",{className:"space-y-2",children:[{value:10,label:"Max effort - could not do more"},{value:9,label:"Very hard - 1 rep left"},{value:8,label:"Hard - 2 reps left"},{value:7,label:"Challenging - 3 reps left"},{value:6,label:"Moderate - 4+ reps left"}].map(({value:s,label:r})=>e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-flame-500/20 text-flame-400 flex items-center justify-center font-medium",children:s}),e.jsx("span",{className:"text-iron-300",children:r})]},s))})]})}),e.jsx(xs,{exercise:ie,isOpen:!!ie,onClose:()=>{V(null),J(null)},onSubstitute:le!==null?s=>Je(le,s):void 0})]}):e.jsxs("div",{className:"max-w-2xl mx-auto pb-24",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-iron-950/95 backdrop-blur-sm border-b border-iron-800 -mx-4 px-4 py-3 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:qe,className:"p-2 -ml-2 text-iron-400 hover:text-iron-200 transition-colors",children:e.jsx(et,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:He,className:"p-2 text-iron-400 hover:text-iron-200 hover:bg-iron-800 rounded-lg transition-colors",title:"Share workout",children:e.jsx(ht,{className:"w-4 h-4"})}),Q&&e.jsx("button",{onClick:Ts,className:"p-2 text-iron-400 hover:text-iron-200 hover:bg-iron-800 rounded-lg transition-colors",title:"Edit workout",children:e.jsx(ae,{className:"w-4 h-4"})}),Q&&e.jsx("button",{onClick:$s,className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete workout",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx("span",{className:"px-3 py-1 bg-cyan-500/20 text-cyan-400 rounded-full text-sm font-medium",children:"Group"}),y?e.jsx("span",{className:"px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm font-medium",children:"Completed"}):e.jsx("span",{className:"px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded-full text-sm font-medium",children:"Assigned"}),me&&e.jsx("span",{className:"px-3 py-1 bg-amber-500/20 text-amber-400 rounded-full text-sm font-medium animate-pulse",children:"Review"})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-display text-iron-50 mb-2",children:n.name}),n.description&&e.jsx("p",{className:"text-iron-400 mb-2",children:n.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-iron-400",children:[e.jsx(st,{className:"w-4 h-4 text-flame-400"}),e.jsx("span",{children:Gs(n.date)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-iron-400",children:[e.jsx(Te,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{children:(P==null?void 0:P.name)||"Group Workout"})]}),n.generatedByAI&&e.jsxs("div",{className:"flex items-center gap-1.5 text-iron-500",children:[e.jsx(tt,{className:"w-3.5 h-3.5 text-flame-400"}),e.jsx("span",{children:"AI Generated"})]})]})]}),!X&&!Q&&e.jsx("div",{className:"card-steel p-4 mb-6 border-iron-700",children:e.jsx("p",{className:"text-sm text-iron-400",children:"This workout was assigned to another member. You can view but not edit."})}),!X&&Q&&e.jsx("div",{className:"card-steel p-4 mb-6 border-cyan-500/30 bg-cyan-500/5",children:e.jsx("p",{className:"text-sm text-cyan-400",children:"You're viewing as admin. You can log this workout on behalf of the member."})}),me&&e.jsx(D.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 rounded-xl border border-amber-500/30 bg-amber-500/5 overflow-hidden",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx(at,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-amber-300",children:"Review Required"}),e.jsx("p",{className:"text-sm text-iron-400 mt-1",children:"Your coach logged this workout for you. Review the results and either approve or make changes."})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:Bs,disabled:G,className:"flex-1 flex items-center justify-center gap-2 py-2.5 px-4 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(rt,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:Ds,className:"flex-1 flex items-center justify-center gap-2 py-2.5 px-4 bg-iron-800 hover:bg-iron-700 text-iron-300 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(ae,{className:"w-4 h-4"}),"Edit & Fix"]})]})]})}),X&&(I||Hs)&&e.jsxs("div",{className:`card-steel p-3 mb-6 flex items-center gap-2 ${I?"border-green-500/20 bg-green-500/5":"border-blue-500/20 bg-blue-500/5"}`,children:[e.jsx(se,{className:`w-4 h-4 ${I?"text-green-400":"text-blue-400"}`}),e.jsx("p",{className:`text-sm ${I?"text-green-400":"text-blue-400"}`,children:I?"You approved this workout logged by your coach.":"You edited and updated this workout."})]}),Ie&&e.jsxs("div",{className:"card-steel mb-6 overflow-hidden",children:[e.jsxs("button",{onClick:()=>Pe(!Y),className:"w-full flex items-center justify-between p-4 hover:bg-iron-800/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4 text-flame-400"}),e.jsx("span",{className:"text-sm font-medium text-iron-200",children:"AI Coaching Notes"})]}),Y?e.jsx(ue,{className:"w-4 h-4 text-iron-500"}):e.jsx(fe,{className:"w-4 h-4 text-iron-500"})]}),e.jsx(te,{children:Y&&e.jsx(D.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 max-h-64 overflow-y-auto space-y-3",children:[n.coachingNotes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wider mb-1",children:"Coaching Notes"}),e.jsx("p",{className:"text-sm text-iron-300 leading-relaxed",children:n.coachingNotes})]}),n.personalNotes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wider mb-1",children:"Your Notes"}),e.jsx("p",{className:"text-sm text-iron-300 leading-relaxed",children:n.personalNotes})]})]})})})]}),n.generationPrompt&&e.jsxs("div",{className:"card-steel mb-3 overflow-hidden",children:[e.jsxs("button",{onClick:()=>js(!je),className:"w-full flex items-center justify-between p-4 hover:bg-iron-800/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{className:"w-4 h-4 text-iron-500"}),e.jsx("span",{className:"text-sm font-medium text-iron-200",children:"Generation Prompt"})]}),je?e.jsx(ue,{className:"w-4 h-4 text-iron-500"}):e.jsx(fe,{className:"w-4 h-4 text-iron-500"})]}),e.jsx(te,{children:je&&e.jsx(D.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"px-4 pb-4",children:e.jsx("pre",{className:"text-xs text-iron-400 leading-relaxed whitespace-pre-wrap font-mono max-h-96 overflow-y-auto",children:n.generationPrompt})})})})]}),n.notes&&e.jsx("div",{className:"card-steel p-4 mb-6",children:e.jsx("p",{className:"text-iron-300 text-sm",children:n.notes})}),((ss=n.exercises)==null?void 0:ss.length)>0&&e.jsx(pt,{exercises:n.exercises,isCompleted:y}),e.jsx("div",{className:"space-y-4",children:ls(n.exercises||[]).map((s,r)=>{var c,p,h,u,l,m,N;if(s.type==="superset"){const{exerciseA:d,exerciseB:C}=s,W=(F,x)=>{const g=F.type==="time",f=F.type==="bodyweight",R=g?!!x.actualTime:f?!!x.actualReps:!!(x.actualWeight||x.actualReps);return g?y&&R?e.jsxs("span",{className:"text-base font-bold text-flame-400",children:[x.actualTime,"s ",e.jsxs("span",{className:"text-xs text-iron-500 font-normal",children:["target ",x.prescribedTime||"—","s"]})]}):e.jsxs("span",{className:"text-base font-bold text-iron-100",children:[x.prescribedTime||"—","s"]}):f?y&&R?e.jsxs("span",{className:"text-base font-bold text-flame-400",children:[x.actualReps||"—"," reps ",e.jsxs("span",{className:"text-xs text-iron-500 font-normal",children:["target ",x.prescribedReps||"—"]})]}):e.jsxs("span",{className:"text-base font-bold text-iron-100",children:[x.prescribedReps||"—"," reps"]}):y&&R?e.jsxs("span",{className:"text-base font-bold text-flame-400",children:[x.actualWeight||"—"," × ",x.actualReps||"—"," ",e.jsxs("span",{className:"text-xs text-iron-500 font-normal",children:["target ",x.prescribedWeight||"—"," × ",x.prescribedReps||"—"]})]}):e.jsxs("span",{className:"text-base font-bold text-iron-100",children:[x.prescribedWeight||"—"," lbs × ",x.prescribedReps||"—"]})};return e.jsxs("div",{className:"card-steel overflow-hidden border border-purple-500/20",children:[e.jsxs("div",{className:"p-4 border-b border-iron-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 rounded bg-purple-500/10 text-purple-400 text-xs font-semibold",children:[e.jsx(ns,{className:"w-3 h-3"})," Superset"]}),e.jsxs("h3",{className:"text-lg font-semibold text-iron-50 flex-1",children:[d.name," ",e.jsx("span",{className:"text-iron-600",children:"/"})," ",C.name]})]}),e.jsxs("p",{className:"text-sm text-iron-500 mt-1",children:[((c=d.sets)==null?void 0:c.length)||0," sets"]})]}),e.jsx("div",{className:"divide-y divide-iron-800/50",children:(p=d.sets)==null?void 0:p.map((F,x)=>{var f;const g=(f=C.sets)==null?void 0:f[x];return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-iron-800 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-lg font-bold text-iron-400",children:x+1})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-purple-400 font-medium mb-0.5",children:["A — ",d.name]}),W(d,F)]}),g&&e.jsxs("div",{className:"pt-1.5 border-t border-iron-700/30",children:[e.jsxs("p",{className:"text-xs text-purple-400 font-medium mb-0.5",children:["B — ",C.name]}),W(C,g)]})]})]})},x)})}),(d.notes||C.notes)&&e.jsxs("div",{className:"px-4 pb-2 space-y-1",children:[d.notes&&e.jsxs("div",{className:"flex items-start gap-2 bg-iron-800/30 rounded-lg p-3",children:[e.jsx(re,{className:"w-4 h-4 text-iron-500 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-iron-400",children:[e.jsx("span",{className:"text-purple-400",children:"A:"})," ",d.notes]})]}),C.notes&&e.jsxs("div",{className:"flex items-start gap-2 bg-iron-800/30 rounded-lg p-3",children:[e.jsx(re,{className:"w-4 h-4 text-iron-500 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-iron-400",children:[e.jsx("span",{className:"text-purple-400",children:"B:"})," ",C.notes]})]})]})]},`ss-${s.supersetGroup}`)}const t=s.exercise,a=s.index,i=T(t),o=ms(i);return e.jsxs("div",{className:"card-steel overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-iron-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{V(t),J(a)},className:"text-xl font-semibold text-iron-50 hover:text-flame-400 transition-colors text-left flex items-center gap-1.5",children:[t.name,e.jsx(os,{className:"w-3.5 h-3.5 text-iron-600 flex-shrink-0"})]}),o&&e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${o.color}`,children:o.label}),!y&&e.jsx("button",{onClick:()=>Z(a),disabled:Ae!==null,title:"Swap for similar exercise",className:"p-1.5 text-iron-500 hover:text-flame-400 hover:bg-flame-500/10 rounded-lg transition-colors disabled:opacity-30",children:Ae===a?e.jsx(pe,{className:"w-4 h-4 animate-spin text-flame-400"}):e.jsx(it,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-sm text-iron-500 mt-1",children:[((h=t.sets)==null?void 0:h.length)||0," sets"]})]}),e.jsx("div",{className:"divide-y divide-iron-800/50",children:(u=t.sets)==null?void 0:u.map((d,C)=>{const W=i==="time"?d.actualTime:i==="bodyweight"?d.actualReps:d.actualWeight||d.actualReps,F=i==="weight"&&W&&d.actualWeight&&d.actualReps&&parseInt(d.actualReps)>1?gt(parseFloat(d.actualWeight),parseInt(d.actualReps)):null;return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-iron-800 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-lg font-bold text-iron-400",children:C+1})}),e.jsx("div",{className:"flex-1",children:i==="time"?y?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-iron-500 mb-1",children:["Target: ",d.prescribedTime||"—","s"]}),W?e.jsxs("span",{className:"text-2xl font-bold text-flame-400",children:[d.actualTime||"—"," seconds"]}):e.jsx("span",{className:"text-lg text-iron-600",children:"Not logged"})]}):e.jsxs("div",{className:"text-2xl font-bold text-iron-100",children:[d.prescribedTime||"—"," seconds"]}):i==="bodyweight"?y?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-iron-500 mb-1",children:["Target: ",d.prescribedReps||"—"," reps"]}),W?e.jsxs("span",{className:"text-2xl font-bold text-flame-400",children:[d.actualReps||"—"," reps"]}):e.jsx("span",{className:"text-lg text-iron-600",children:"Not logged"})]}):e.jsxs("div",{className:"text-2xl font-bold text-iron-100",children:[d.prescribedReps||"—"," reps"]}):y?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-iron-500 mb-1",children:["Target: ",d.prescribedWeight||"—"," lbs × ",d.prescribedReps||"—"," reps"]}),W?e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("span",{className:"text-2xl font-bold text-flame-400",children:[d.actualWeight||"—"," lbs × ",d.actualReps||"—"]}),F&&e.jsxs("span",{className:"text-sm text-iron-500 bg-iron-800 px-2 py-1 rounded-lg",children:["e1RM: ",F," lbs"]})]}):e.jsx("span",{className:"text-lg text-iron-600",children:"Not logged"})]}):e.jsxs("span",{className:"text-2xl font-bold text-iron-100",children:[d.prescribedWeight||"—"," lbs × ",d.prescribedReps||"—",d.targetRpe&&e.jsxs("span",{className:"text-sm text-iron-500 font-normal ml-2",children:["@ RPE ",d.targetRpe]})]})})]})},C)})}),y&&(t.rpe||t.painLevel>0||((l=t.sets)==null?void 0:l.some(d=>d.rpe||d.painLevel>0)))&&e.jsxs("div",{className:"px-4 pb-2 flex items-center gap-3",children:[(t.rpe||((m=t.sets)==null?void 0:m.some(d=>d.rpe)))&&e.jsxs("span",{className:`text-sm font-semibold ${zs(t.rpe||Math.max(...(t.sets||[]).map(d=>parseFloat(d.rpe)||0)))}`,children:["RPE ",t.rpe||Math.max(...(t.sets||[]).map(d=>parseFloat(d.rpe)||0))]}),(t.painLevel>0||((N=t.sets)==null?void 0:N.some(d=>d.painLevel>0)))&&e.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${Us(t.painLevel||Math.max(...(t.sets||[]).map(d=>d.painLevel||0)))}`,children:["Pain ",t.painLevel||Math.max(...(t.sets||[]).map(d=>d.painLevel||0))]})]}),t.notes&&e.jsx("div",{className:"px-4 pb-2",children:e.jsxs("div",{className:"flex items-start gap-2 bg-iron-800/30 rounded-lg p-3",children:[e.jsx(re,{className:"w-4 h-4 text-iron-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-iron-400",children:t.notes})]})}),t.userNotes&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"flex items-start gap-2 bg-flame-500/5 border border-flame-500/10 rounded-lg p-3",children:[e.jsx(re,{className:"w-4 h-4 text-flame-400/60 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-iron-500 mb-0.5",children:"Your Notes"}),e.jsx("p",{className:"text-sm text-iron-400",children:t.userNotes})]})]})})]},a)})}),(!n.exercises||n.exercises.length===0)&&e.jsxs("div",{className:"card-steel p-8 text-center",children:[e.jsx(Te,{className:"w-12 h-12 text-iron-700 mx-auto mb-3"}),e.jsx("p",{className:"text-iron-500",children:"No exercises in this workout"})]}),Ys&&e.jsxs("div",{className:`fixed bottom-0 right-0 p-4 bg-iron-950/95 backdrop-blur-sm border-t border-iron-800 left-0 ${ge?"lg:left-64":"lg:left-20"} transition-[left] duration-300`,children:[e.jsxs("button",{onClick:()=>U(!0),className:`w-full py-4 text-lg flex items-center justify-center gap-2 ${y?"btn-secondary":"btn-primary"}`,children:[y?e.jsx(ae,{className:"w-5 h-5"}):e.jsx(lt,{className:"w-5 h-5"}),y?"Edit Logged Data":"Log This Workout"]}),y&&e.jsx("button",{onClick:Os,className:"w-full mt-2 py-2 text-xs text-iron-500 hover:text-iron-300 transition-colors",children:"Mark as incomplete"})]}),e.jsx(xs,{exercise:ie,isOpen:!!ie,onClose:()=>{V(null),J(null)},onSubstitute:le!==null?s=>Je(le,s):void 0}),e.jsx(te,{children:Ne!==null&&e.jsxs(e.Fragment,{children:[e.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>{Z(null),K("")},className:"fixed inset-0 bg-black/60 z-50"}),e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-x-4 top-[30%] mx-auto max-w-sm bg-iron-900 border border-iron-700 rounded-2xl z-50 p-4 space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-iron-200",children:"Swap Exercise"}),e.jsx("p",{className:"text-xs text-iron-500",children:`Optionally note why you're swapping (e.g. "shoulder pain", "no cable machine")`}),e.jsx("input",{type:"text",value:ve,onChange:s=>K(s.target.value),placeholder:"Reason (optional)",className:"input-field w-full text-sm",autoFocus:!0,onKeyDown:s=>{s.key==="Enter"&&(Ve(Ne,ve),Z(null),K(""))}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{Z(null),K("")},className:"flex-1 py-2.5 text-sm text-iron-400 hover:text-iron-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>{Ve(Ne,ve),Z(null),K("")},className:"flex-1 py-2.5 text-sm bg-flame-500/15 text-flame-400 border border-flame-500/30 rounded-xl hover:bg-flame-500/25 transition-colors",children:"Swap"})]})]})]})}),e.jsx(te,{children:vs&&e.jsxs(e.Fragment,{children:[e.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>oe(!1),className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50"}),e.jsxs(D.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed inset-x-4 top-[15%] mx-auto max-w-md bg-iron-900 border border-iron-700 rounded-2xl z-50 overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-iron-800",children:[e.jsx("h3",{className:"font-display text-lg text-iron-100",children:"Share Workout"}),e.jsx("button",{onClick:()=>oe(!1),className:"p-1.5 text-iron-400 hover:text-iron-200 rounded-lg",children:e.jsx(z,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 space-y-4",children:Rs?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-14 h-14 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(se,{className:"w-7 h-7 text-green-400"})}),e.jsx("p",{className:"text-iron-200 font-medium",children:"Workout Shared!"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3 bg-iron-800/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-iron-300 font-medium",children:(n==null?void 0:n.name)||"Workout"}),e.jsxs("p",{className:"text-xs text-iron-500 mt-0.5",children:[((ts=n==null?void 0:n.exercises)==null?void 0:ts.length)||0," exercises · ",(P==null?void 0:P.name)||"Group"]})]}),ye.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-sm text-iron-500",children:"No friends yet. Add friends to share workouts."}),e.jsx(nt,{to:"/friends",className:"text-sm text-flame-400 hover:underline mt-1 inline-block",children:"Find Friends"})]}):e.jsxs(e.Fragment,{children:[ye.length>5&&e.jsxs("div",{className:"relative",children:[e.jsx(ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-iron-500"}),e.jsx("input",{type:"text",placeholder:"Search friends...",value:Re,onChange:s=>ks(s.target.value),className:"input-field pl-9 py-2 text-sm w-full"})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:ye.filter(s=>{var t;if(!Re)return!0;const r=ke[s];return(t=r==null?void 0:r.displayName)==null?void 0:t.toLowerCase().includes(Re.toLowerCase())}).map(s=>{const r=ke[s];return e.jsxs("button",{onClick:()=>_e(s),className:`w-full flex items-center gap-3 p-2.5 rounded-lg transition-colors ${H===s?"bg-flame-500/15 border border-flame-500/30":"hover:bg-iron-800"}`,children:[r!=null&&r.photoURL?e.jsx("img",{src:r.photoURL,alt:"",className:"w-8 h-8 rounded-full"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-iron-700 flex items-center justify-center text-xs font-medium text-iron-400",children:((r==null?void 0:r.displayName)||"?")[0]}),e.jsx("span",{className:"text-sm text-iron-200 flex-1 text-left truncate",children:(r==null?void 0:r.displayName)||"User"}),H===s&&e.jsx(se,{className:"w-4 h-4 text-flame-400"})]},s)})}),e.jsx("textarea",{placeholder:"Add a message (optional)",value:Be,onChange:s=>De(s.target.value),rows:2,className:"input-field w-full resize-none text-sm"}),e.jsxs("button",{onClick:Es,disabled:!H||ce,className:"btn-primary w-full py-3 text-sm flex items-center justify-center gap-2 disabled:opacity-50",children:[ce?e.jsx(pe,{className:"w-4 h-4 animate-spin"}):e.jsx(ot,{className:"w-4 h-4"}),ce?"Sharing...":"Share Workout"]})]})]})})]})]})})]})}export{Wt as default};

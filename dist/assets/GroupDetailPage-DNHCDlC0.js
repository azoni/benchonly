import{t as Fs,r as d,d as Ws,p as Pe,D as ts,G as as,H as ns,I as rs,J as ls,M as is,j as e,l as Cs,m as ge,S as Ne,X as be,B as _e,f as We,h as se,v as Re,aj as Gs,ak as Te,al as $e,U as Xe,i as Bs,k as ms,Y as Ye,N as Us,O as Is,a as Hs,b as zs,c as qs,u as _s,ae as Ss,af as Es,L as Ve,A as Vs,ac as Js,aO as Xs,n as Je,s as Ms,q as Ys,ab as Ks,aA as Ds,g as fe,e as je,aM as Zs,z as Qs,a9 as et,o as Rs,aN as st}from"./index-BH1MXG3y.js";import{M as Ts}from"./message-square-C07fH1sq.js";import{e as tt}from"./index-DSKlA9ux.js";import{M as at}from"./more-vertical-DHEyCNvN.js";import{T as os}from"./trash-2-DIsgLbDI.js";import{P as nt}from"./pen-LLDuRvQy.js";import{C as rt}from"./crown-mLF8fdIv.js";import{F as lt}from"./file-text-Dxv4eQwk.js";import{S as As}from"./search-Cijha28e.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=Fs("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ds=[{text:"Loading athlete profiles and training histories...",icon:"users"},{text:"Scanning recent workout data for volume and intensity trends...",icon:"brain"},{text:"Evaluating pain history and flagging injury risks...",icon:"alert"},{text:"Calculating estimated 1-rep maxes from recent sets...",icon:"calc"},{text:"Reviewing RPE averages to calibrate load recommendations...",icon:"brain"},{text:"Checking recovery status based on recent training frequency...",icon:"brain"},{text:"Selecting primary compound movements for the session...",icon:"dumbbell"},{text:"Adding accessory exercises to target weak points...",icon:"dumbbell"},{text:"Personalizing working weights per athlete based on e1RM...",icon:"users"},{text:"Applying progressive overload — adjusting from last session...",icon:"calc"},{text:"Building set/rep schemes for target intensity zone...",icon:"dumbbell"},{text:"Checking for exercise substitutions where pain was flagged...",icon:"alert"},{text:"Writing coaching notes and form cues for each exercise...",icon:"msg"},{text:"Generating individualized notes for each athlete...",icon:"users"},{text:"Validating workout structure and total volume...",icon:"calc"}];function it({isOpen:M,onClose:te,group:V,athletes:p,coachId:Le,isAdmin:ae=!1,onSuccess:v}){var ue,ee;const[ce,F]=d.useState(""),{user:Ke,userProfile:J,updateProfile:Oe,isAppAdmin:hs}=Ws(),[Fe,ne]=d.useState(Pe(new Date,"yyyy-MM-dd")),[E,ve]=d.useState([]),[I,ye]=d.useState({}),[de,xe]=d.useState(!1),[G,we]=d.useState(!1),[L,me]=d.useState(null),[re,B]=d.useState(null),[X,ke]=d.useState("standard"),[Y,Ce]=d.useState("auto"),[Se,Ge]=d.useState("moderate"),[he,Be]=d.useState("auto"),[Q,Ze]=d.useState("auto"),[Ee,Me]=d.useState(""),[Ue,De]=d.useState([]),[le,O]=d.useState(null),[K,H]=d.useState([]),Z=d.useRef(null),U=d.useRef(null);d.useEffect(()=>{M&&(p==null?void 0:p.length)>0&&(ve(p.map(n=>n.uid)),j(p))},[M,p]),d.useEffect(()=>{Z.current&&(Z.current.scrollTop=Z.current.scrollHeight)},[K]),d.useEffect(()=>()=>{U.current&&clearInterval(U.current)},[]);const _=(n,o,g=null)=>{De(b=>{const C=b.findIndex(S=>S.label===n);if(C>=0){const S=[...b];return S[C]={label:n,status:o,detail:g},S}return[...b,{label:n,status:o,detail:g}]})},z=()=>{H([]);let n=0;H([{...ds[0],id:0}]),n=1,U.current=setInterval(()=>{n<ds.length?(H(o=>[...o,{...ds[n],id:n}]),n++):H(o=>[...o,{text:"Finalizing workout details...",icon:"brain",id:o.length}])},2200)},T=()=>{U.current&&(clearInterval(U.current),U.current=null)},j=async n=>{xe(!0),De([]);const o={};for(const g of n){const b=g.displayName||"Unknown";_(`Analyzing ${b}`,"loading");try{const C=await Ae(g.uid);o[g.uid]={...C,name:b};const S=Object.keys(C.maxLifts||{}).length,A=Object.keys(C.painHistory||{}).length;let y=`${S} lifts`;A>0&&(y+=`, ${A} pain flags`),_(`Analyzing ${b}`,A>0?"warning":"complete",y)}catch(C){console.error(`Error for ${g.uid}:`,C),o[g.uid]={id:g.uid,name:b,maxLifts:{},painHistory:{},rpeAverages:{},goals:[],recentWorkouts:[]},_(`Analyzing ${b}`,"complete","No data")}}ye(o),xe(!1)},Ae=async n=>{let o=[];try{(await ts(as(ns(rs,"workouts"),ls("userId","==",n),is(30)))).docs.forEach(x=>{var k,P,$,R;const N=x.data();N.status==="completed"&&o.push({...N,date:((R=($=(P=(k=N.date)==null?void 0:k.toDate)==null?void 0:P.call(k))==null?void 0:$.toISOString)==null?void 0:R.call($).split("T")[0])||N.date})})}catch(u){console.error(u)}try{(await ts(as(ns(rs,"groupWorkouts"),ls("assignedTo","==",n),is(30)))).docs.forEach(x=>{var k,P,$,R;const N=x.data();N.status==="completed"&&o.push({...N,date:((R=($=(P=(k=N.date)==null?void 0:k.toDate)==null?void 0:P.call(k))==null?void 0:$.toISOString)==null?void 0:R.call($).split("T")[0])||N.date})})}catch(u){console.error(u)}o.sort((u,x)=>new Date(x.date||0)-new Date(u.date||0));const g={},b={},C={};o.forEach(u=>{(u.exercises||[]).forEach(x=>{x.name&&(x.sets||[]).forEach(N=>{if(!N.actualWeight&&!N.actualReps&&N.prescribedWeight)return;const k=parseFloat(N.actualWeight)||parseFloat(N.prescribedWeight)||0,P=parseInt(N.actualReps)||parseInt(N.prescribedReps)||0,$=parseInt(N.rpe)||0,R=parseInt(N.painLevel)||0;if(k>0&&P>0&&P<=12){const pe=Math.round(k*(1+P/30));(!g[x.name]||pe>g[x.name].e1rm)&&(g[x.name]={weight:k,reps:P,e1rm:pe})}R>0&&(b[x.name]||(b[x.name]={count:0,maxPain:0}),b[x.name].count++,b[x.name].maxPain=Math.max(b[x.name].maxPain,R)),$>0&&(C[x.name]||(C[x.name]={total:0,count:0}),C[x.name].total+=$,C[x.name].count++)})})});const S={};Object.entries(C).forEach(([u,x])=>{S[u]=Math.round(x.total/x.count*10)/10});let A=[];try{A=(await ts(as(ns(rs,"goals"),ls("userId","==",n),is(10)))).docs.map(x=>x.data()).filter(x=>x.status==="active")}catch(u){console.error(u)}const y=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],W=o.slice(0,5).map(u=>{const x=new Date(u.date);return{...u,dayOfWeek:y[x.getDay()],exercises:(u.exercises||[]).map(N=>({name:N.name,type:N.type||"weight",notes:N.notes,sets:(N.sets||[]).map(k=>({prescribedWeight:k.prescribedWeight,prescribedReps:k.prescribedReps,actualWeight:k.actualWeight,actualReps:k.actualReps,rpe:k.rpe,painLevel:k.painLevel,completed:k.completed}))}))}});return{id:n,maxLifts:g,painHistory:b,rpeAverages:S,goals:A,recentWorkouts:W}},Ie=async()=>{var b,C;if(E.length===0){B("Select at least one athlete");return}const o=X==="premium"?$e:Te["generate-group-workout"]*E.length,g=(J==null?void 0:J.credits)??0;if(!ae&&g<o){B(X==="premium"?`Not enough credits. Premium costs ${$e} credits, you have ${g}.`:`Not enough credits. Need ${o} (${Te["generate-group-workout"]} x ${E.length} athletes) but you have ${g}.`);return}we(!0),B(null),_("Generating workouts","loading"),z();try{ae||Oe({credits:g-o});const S=E.map(u=>{var x,N,k,P,$,R;return{id:u,name:((x=I[u])==null?void 0:x.name)||"Unknown",maxLifts:((N=I[u])==null?void 0:N.maxLifts)||{},painHistory:((k=I[u])==null?void 0:k.painHistory)||{},rpeAverages:((P=I[u])==null?void 0:P.rpeAverages)||{},goals:(($=I[u])==null?void 0:$.goals)||[],recentWorkouts:((R=I[u])==null?void 0:R.recentWorkouts)||[]}}),A=await Us(),y=await fetch(Is("generate-group-workout"),{method:"POST",headers:A,body:JSON.stringify({groupId:V.id,athletes:S,prompt:ce,workoutDate:Fe,model:X,workoutFocus:Y,intensity:Se,duration:he!=="auto"?parseInt(he):null,exerciseCount:Q!=="auto"?parseInt(Q):null,maxExercise:Y==="1rm-test"?Ee:null})});if(!y.ok){const u=await y.json().catch(()=>({}));throw new Error(u.error||"Failed to generate")}const W=await y.json();me(W),T(),H(u=>{var x;return[...u,{text:`Done! Created ${(x=W.createdWorkouts)==null?void 0:x.length} personalized workouts.`,icon:"check",id:u.length}]}),_("Generating workouts","complete",`${(b=W.createdWorkouts)==null?void 0:b.length} workouts created in ${(C=W.usage)==null?void 0:C.responseMs}ms`)}catch(S){console.error("Error:",S),B(S.message),ae||Oe({credits:g}),T(),H(A=>[...A,{text:`Error: ${S.message}`,icon:"error",id:A.length}]),_("Generating workouts","error",S.message)}finally{we(!1)}},He=()=>{v==null||v(),D()},Qe=n=>{ve(o=>o.includes(n)?o.filter(g=>g!==n):[...o,n])},ze=()=>{ve(E.length===(p==null?void 0:p.length)?[]:(p==null?void 0:p.map(n=>n.uid))||[])},D=()=>{F(""),ke("standard"),me(null),B(null),De([]),H([]),T(),te()},ie=n=>{switch(n){case"brain":return e.jsx(_e,{className:"w-3 h-3 text-flame-400"});case"alert":return e.jsx(Re,{className:"w-3 h-3 text-amber-400"});case"calc":return e.jsx(Ne,{className:"w-3 h-3 text-purple-400"});case"dumbbell":return e.jsx(Ye,{className:"w-3 h-3 text-cyan-400"});case"users":return e.jsx(Xe,{className:"w-3 h-3 text-green-400"});case"msg":return e.jsx(Ts,{className:"w-3 h-3 text-blue-400"});case"check":return e.jsx(se,{className:"w-3 h-3 text-green-400"});case"error":return e.jsx(Re,{className:"w-3 h-3 text-red-400"});default:return e.jsx(We,{className:"w-3 h-3 text-flame-400 animate-spin"})}};return M?e.jsx(Cs,{children:e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",onClick:D,children:e.jsxs(ge.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:n=>n.stopPropagation(),className:"bg-iron-900 rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-iron-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-flame-500/10 flex items-center justify-center",children:e.jsx(Ne,{className:"w-5 h-5 text-flame-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-iron-100",children:"AI Generate Workout"}),e.jsx("p",{className:"text-sm text-iron-500",children:V==null?void 0:V.name})]})]}),e.jsx("button",{onClick:D,className:"p-2 text-iron-400 hover:text-iron-200 rounded-xl",children:e.jsx(be,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-0 lg:gap-4 p-4",children:[e.jsx("div",{className:"lg:col-span-1 mb-4 lg:mb-0",children:e.jsxs("div",{className:"bg-iron-800/30 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_e,{className:"w-4 h-4 text-flame-400"}),e.jsx("h3",{className:"text-sm font-medium text-iron-300",children:"Analysis"})]}),e.jsx("div",{className:"space-y-2",children:Ue.map((n,o)=>e.jsxs(ge.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-0.5",children:n.status==="loading"?e.jsx(We,{className:"w-3 h-3 text-flame-400 animate-spin"}):n.status==="complete"?e.jsx(se,{className:"w-3 h-3 text-green-400"}):n.status==="warning"?e.jsx(Re,{className:"w-3 h-3 text-amber-400"}):e.jsx(Re,{className:"w-3 h-3 text-red-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-iron-300",children:n.label}),n.detail&&e.jsx("p",{className:"text-xs text-iron-500 truncate",children:n.detail})]})]},n.label))}),(G||K.length>0)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-iron-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[G&&e.jsx(We,{className:"w-3 h-3 text-flame-400 animate-spin"}),e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wider",children:G?"AI Thinking...":"AI Process"})]}),e.jsxs("div",{ref:Z,className:"max-h-40 overflow-y-auto space-y-1.5 scrollbar-thin",children:[K.map(n=>e.jsxs(ge.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0",children:ie(n.icon)}),e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed",children:n.text})]},n.id)),G&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("span",{className:"w-1 h-1 bg-flame-400 rounded-full animate-pulse"}),e.jsx("span",{className:"w-1 h-1 bg-flame-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"w-1 h-1 bg-flame-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]})]})]}),!de&&Object.keys(I).length>0&&!G&&K.length===0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-iron-700",children:[e.jsx("p",{className:"text-xs text-iron-500 mb-2",children:"Group Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[e.jsxs("div",{className:"bg-iron-800/50 rounded-lg py-2",children:[e.jsx("p",{className:"text-lg font-semibold text-iron-100",children:E.length}),e.jsx("p",{className:"text-xs text-iron-500",children:"Athletes"})]}),e.jsxs("div",{className:"bg-iron-800/50 rounded-lg py-2",children:[e.jsx("p",{className:"text-lg font-semibold text-iron-100",children:Object.values(I).filter(n=>Object.keys(n.painHistory||{}).length>0).length}),e.jsx("p",{className:"text-xs text-iron-500",children:"With Pain"})]})]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:G?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-iron-800/30 rounded-xl border border-flame-500/20 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-iron-700/50 bg-flame-500/5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-flame-500/20 flex items-center justify-center",children:e.jsx(_e,{className:"w-4 h-4 text-flame-400 animate-pulse"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-iron-200",children:"AI is generating workouts..."}),e.jsxs("p",{className:"text-xs text-iron-500",children:[E.length," athlete",E.length!==1?"s":""," · ",ce||"Custom workout"]})]}),e.jsx(We,{className:"w-5 h-5 text-flame-400 animate-spin ml-auto"})]}),e.jsxs("div",{ref:Z,className:"p-4 max-h-[300px] overflow-y-auto space-y-2.5 scrollbar-thin",children:[K.map(n=>e.jsxs(ge.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},className:"flex items-start gap-3 py-1",children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0 w-5 h-5 rounded bg-iron-800 flex items-center justify-center",children:ie(n.icon)}),e.jsx("p",{className:"text-sm text-iron-300 leading-relaxed",children:n.text})]},n.id)),e.jsxs("div",{className:"flex items-center gap-1.5 pt-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-flame-400 rounded-full animate-pulse"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-flame-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"w-1.5 h-1.5 bg-flame-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]})]})]}),re&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-400",children:re})})]}):L?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-lg",children:[e.jsxs("p",{className:"text-green-400 font-medium flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),(ue=L.createdWorkouts)==null?void 0:ue.length," workouts created"]}),L.usage&&e.jsxs("p",{className:"text-xs text-iron-500 mt-1",children:[L.usage.tokens," tokens · ",L.usage.responseMs,"ms · ",L.usage.cost]})]}),L.coachingNotes&&e.jsxs("div",{className:"bg-iron-800/50 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 border-b border-iron-700/50",children:[e.jsx(_e,{className:"w-4 h-4 text-flame-400"}),e.jsx("h3",{className:"text-sm font-medium text-iron-200",children:"AI Coaching Notes"})]}),e.jsx("div",{className:"p-3 max-h-32 overflow-y-auto",children:e.jsx("p",{className:"text-sm text-iron-400 leading-relaxed",children:L.coachingNotes})})]}),e.jsxs("div",{className:"p-4 bg-iron-800/50 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-iron-100 mb-2",children:L.workoutName}),e.jsx("div",{className:"space-y-1",children:(ee=L.baseExercises)==null?void 0:ee.map((n,o)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-iron-400",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsx("span",{children:n.name}),e.jsxs("span",{className:"text-iron-600",children:[n.defaultSets,"×",n.defaultReps]}),n.type&&n.type!=="weight"&&e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${n.type==="time"?"bg-blue-500/20 text-blue-400":n.type==="bodyweight"?"bg-emerald-500/20 text-emerald-400":""}`,children:n.type==="time"?"Time":"BW"})]},o))})]}),e.jsx("div",{className:"space-y-3 max-h-[250px] overflow-y-auto",children:Object.entries(L.athleteWorkouts||{}).map(([n,o])=>{var g;return e.jsxs("div",{className:"p-3 bg-iron-800/30 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-iron-200",children:o.athleteName}),o.personalNotes&&e.jsx("p",{className:"text-xs text-iron-500 mt-1 leading-relaxed",children:o.personalNotes}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:(g=o.exercises)==null?void 0:g.slice(0,4).map((b,C)=>{var S,A,y,W,u,x,N;return e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${b.substitution?"bg-amber-500/20 text-amber-400":"bg-iron-700 text-iron-400"}`,children:[((S=b.substitution)==null?void 0:S.replacement)||b.name,": ",b.type==="time"?`${((y=(A=b.sets)==null?void 0:A[0])==null?void 0:y.prescribedTime)||"?"}s`:b.type==="bodyweight"?`${((u=(W=b.sets)==null?void 0:W[0])==null?void 0:u.prescribedReps)||"?"} reps`:`${((N=(x=b.sets)==null?void 0:x[0])==null?void 0:N.prescribedWeight)||"?"}lb`]},C)})})]},n)})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Workout description (optional)"}),e.jsx("textarea",{value:ce,onChange:n=>F(n.target.value),placeholder:"e.g., 'Heavy bench day' or 'Focus on weak points'",className:"input-field w-full min-h-[60px] resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Style"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{value:"auto",label:"Auto"},{value:"push",label:"Push"},{value:"pull",label:"Pull"},{value:"legs",label:"Legs"},{value:"upper",label:"Upper"},{value:"full",label:"Full Body"},{value:"bench",label:"Bench Focus"},{value:"no-equipment",label:"Bodyweight"},{value:"1rm-test",label:"Test 1RM"}].map(n=>e.jsxs("button",{onClick:()=>{Ce(n.value),n.value!=="1rm-test"&&Me("")},className:`px-2.5 py-1 text-xs rounded-lg border transition-colors
                              ${Y===n.value?n.value==="1rm-test"?"border-yellow-500 bg-yellow-500/10 text-yellow-400":"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[n.label,n.value==="1rm-test"&&e.jsx("span",{className:"ml-1 text-[9px] px-1 py-0.5 rounded-full bg-green-500/20 text-green-400 font-medium leading-none",children:"New"})]},n.value))})]}),Y==="1rm-test"&&e.jsxs("div",{className:"p-3 bg-yellow-500/5 border border-yellow-500/20 rounded-xl",children:[e.jsx("label",{className:"block text-sm text-yellow-400 mb-2",children:"Which lift?"}),e.jsx("input",{type:"text",value:Ee,onChange:n=>Me(n.target.value),placeholder:"e.g. Bench Press, Squat, Deadlift...",className:"input-field w-full"}),e.jsx("p",{className:"text-xs text-iron-600 mt-1.5",children:"AI generates warm-up ramps and max attempt protocol per athlete."})]}),Y!=="1rm-test"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Intensity"}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:[{value:"light",label:"Light",desc:"RPE 5-6"},{value:"moderate",label:"Moderate",desc:"RPE 7-8"},{value:"heavy",label:"Heavy",desc:"RPE 8-9"},{value:"max",label:"Max",desc:"RPE 9-10"}].map(n=>e.jsxs("button",{onClick:()=>Ge(n.value),className:`px-2 py-1.5 text-xs rounded-lg border transition-colors text-center
                                ${Se===n.value?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[e.jsx("div",{className:"font-medium",children:n.label}),e.jsx("div",{className:"text-[10px] text-iron-500",children:n.desc})]},n.value))})]}),Y!=="1rm-test"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Duration"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:[{value:"auto",label:"Auto"},{value:"20",label:"20m"},{value:"30",label:"30m"},{value:"45",label:"45m"},{value:"60",label:"60m"},{value:"90",label:"90m"}].map(n=>e.jsx("button",{onClick:()=>Be(n.value),className:`px-2 py-0.5 text-[11px] rounded-md border transition-colors
                                  ${he===n.value?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:n.label},n.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Exercises"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:[{value:"auto",label:"Auto"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"8",label:"8"}].map(n=>e.jsx("button",{onClick:()=>Ze(n.value),className:`px-2 py-0.5 text-[11px] rounded-md border transition-colors
                                  ${Q===n.value?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:n.label},n.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:Fe,onChange:n=>ne(n.target.value),className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"AI Model"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[e.jsxs("button",{onClick:()=>ke("standard"),className:`px-2 py-1.5 text-xs rounded-lg border transition-colors text-center
                              ${X==="standard"?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[e.jsxs("div",{className:"font-medium flex items-center justify-center gap-1",children:[e.jsx(Gs,{className:"w-3 h-3"}),"Standard"]}),e.jsxs("div",{className:"text-[10px] text-iron-500",children:[Te["generate-group-workout"],"/athlete"]})]}),e.jsxs("button",{onClick:()=>ke("premium"),className:`px-2 py-1.5 text-xs rounded-lg border transition-colors text-center
                              ${X==="premium"?"border-purple-500 bg-purple-500/10 text-purple-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[e.jsxs("div",{className:"font-medium flex items-center justify-center gap-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),"Premium"]}),e.jsxs("div",{className:"text-[10px] text-iron-500",children:[$e," cr"]})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"text-sm text-iron-400 flex items-center gap-1",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Athletes (",E.length,"/",(p==null?void 0:p.length)||0,")"]}),e.jsx("button",{onClick:ze,className:"text-xs text-flame-400 hover:text-flame-300",children:E.length===(p==null?void 0:p.length)?"Deselect All":"Select All"})]}),e.jsx("div",{className:"space-y-2 max-h-[200px] overflow-y-auto",children:p==null?void 0:p.map(n=>{var S,A;const o=I[n.uid],g=Object.keys((o==null?void 0:o.painHistory)||{}).length>0,b=Object.keys((o==null?void 0:o.maxLifts)||{}).length,C=le===n.uid;return e.jsxs("div",{className:"border border-iron-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>Qe(n.uid),className:`w-full flex items-center gap-3 p-3 transition-colors
                                  ${E.includes(n.uid)?"bg-flame-500/10":"bg-iron-800/50 hover:bg-iron-800"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center
                                  ${E.includes(n.uid)?"border-flame-500 bg-flame-500":"border-iron-600"}`,children:E.includes(n.uid)&&e.jsx(se,{className:"w-3 h-3 text-white"})}),n.photoURL?e.jsx("img",{src:n.photoURL,alt:"",className:"w-6 h-6 rounded-full"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-iron-700 flex items-center justify-center text-xs text-iron-400",children:(S=n.displayName)==null?void 0:S[0]}),e.jsx("span",{className:"text-iron-200 flex-1 text-left",children:n.displayName}),e.jsxs("span",{className:"text-xs text-iron-500",children:[b," lifts"]}),g&&e.jsx(Re,{className:"w-4 h-4 text-amber-400"}),e.jsx("button",{onClick:y=>{y.stopPropagation(),O(C?null:n.uid)},className:"p-1 hover:bg-iron-700 rounded",children:C?e.jsx(Bs,{className:"w-4 h-4 text-iron-400"}):e.jsx(ms,{className:"w-4 h-4 text-iron-400"})})]}),e.jsx(Cs,{children:C&&o&&e.jsx(ge.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-iron-700 bg-iron-800/30",children:e.jsxs("div",{className:"p-3 text-xs space-y-2",children:[Object.keys(o.maxLifts||{}).length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-iron-500 mb-1",children:"Top Lifts"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(o.maxLifts).sort((y,W)=>W[1].e1rm-y[1].e1rm).slice(0,4).map(([y,W])=>e.jsxs("span",{className:"bg-iron-700 px-2 py-0.5 rounded text-iron-300",children:[y,": ",W.e1rm,"lb"]},y))})]}),Object.keys(o.painHistory||{}).length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-400 mb-1",children:"Pain History"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(o.painHistory).map(([y,W])=>e.jsxs("span",{className:"bg-amber-500/20 text-amber-400 px-2 py-0.5 rounded",children:[y,": ",W.maxPain,"/10"]},y))})]}),((A=o.goals)==null?void 0:A.length)>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-iron-500 mb-1",children:"Goals"}),o.goals.slice(0,2).map((y,W)=>e.jsxs("p",{className:"text-iron-400",children:[y.lift,": ",y.currentWeight||"?"," → ",y.targetWeight||y.targetValue]},W))]})]})})})]},n.uid)})})]}),re&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-400",children:re})})]})})]})}),e.jsx("div",{className:"p-4 border-t border-iron-800 flex gap-3",children:L?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{me(null),H([])},className:"btn-secondary flex-1",children:"Generate Another"}),e.jsxs("button",{onClick:He,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Done"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:D,className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{onClick:Ie,disabled:G||de||E.length===0||!ae&&((J==null?void 0:J.credits)??0)<(X==="premium"?$e:Te["generate-group-workout"]*E.length),className:"btn-primary flex-1 flex items-center justify-center gap-2",children:G?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-5 h-5"}),"Generate for ",E.length," ",e.jsxs("span",{className:"text-xs opacity-70",children:["(",X==="premium"?$e:Te["generate-group-workout"]*E.length," cr)"]})]})})]})})]})})}):null}const xs=(M,te="MMM d, yyyy")=>{if(!M)return"";try{const V=Rs(M);return isNaN(V.getTime())?"":Pe(V,te)}catch{return""}},ot=["Bench Press","Incline Bench Press","Close Grip Bench","Dumbbell Press","Overhead Press","Squat","Deadlift","Barbell Row","Pull-ups","Tricep Extension","Bicep Curl","Lateral Raise"],ct=["Dead Hang","Plank","Wall Sit","L-Sit","Farmers Carry","Static Hold"],dt=["Pull-ups","Push-ups","Dips","Chin-ups","Muscle-ups","Bodyweight Squats"];function Nt(){var gs,fs,js,bs,Ns,vs;const{id:M}=Hs(),te=zs(),V=qs();_s("Group");const{user:p,userProfile:Le,isAppAdmin:ae}=Ws(),[v,ce]=d.useState(null),[F,Ke]=d.useState([]),[J,Oe]=d.useState({}),[hs,Fe]=d.useState({}),[ne,E]=d.useState([]),[ve,I]=d.useState(!0),ye=(Le==null?void 0:Le.customExercises)||{},de=[...ot,...ye.weight||[]],xe=[...dt,...ye.bodyweight||[]],G=[...ct,...ye.time||[]],[we,L]=d.useState(!1),[me,re]=d.useState(!1),[B,X]=d.useState(((gs=V.state)==null?void 0:gs.activeTab)||"members"),[ke,Y]=d.useState(!1),[Ce,Se]=d.useState("code"),[Ge,he]=d.useState(""),[Be,Q]=d.useState([]),[Ze,Ee]=d.useState(!1),[Me,Ue]=d.useState(null),[De,le]=d.useState(!1),[O,K]=d.useState([]),[H,Z]=d.useState(new Date().toISOString().split("T")[0]),[U,_]=d.useState(""),[z,T]=d.useState({}),[j,Ae]=d.useState(null),[Ie,He]=d.useState(!1),[Qe,ze]=d.useState(null),[D,ie]=d.useState(null),[ue,ee]=d.useState(""),[n,o]=d.useState(!1),g=(fs=v==null?void 0:v.admins)==null?void 0:fs.includes(p==null?void 0:p.uid);d.useEffect(()=>{async function s(){if(!(!M||!p))try{const r=await je.getById(M);if(ce(r),r!=null&&r.members){const t=await je.getMemberDetails(r.members),a=Ss(new Date,{weekStartsOn:1}),l=Es(new Date,{weekStartsOn:1}),m={},h={};for(const i of r.members){try{const c=await Zs.getByDateRange(i,a,l);m[i]=c}catch{m[i]=[]}try{if(i===p.uid||ae){const c=await Qs.getByUser(i);h[i]=c.filter(f=>f.status==="active")}else h[i]=[]}catch{h[i]=[]}}Ke(t),Fe(m),Oe(h);try{const i=await fe.getByGroup(M,p.uid);E(i)}catch(i){console.error("Error loading group workouts:",i),E([])}}}catch(r){console.error("Error fetching group:",r)}finally{I(!1)}}s()},[M,p]);const b=async()=>{v!=null&&v.inviteCode&&(await navigator.clipboard.writeText(v.inviteCode),re(!0),setTimeout(()=>re(!1),2e3))},C=async s=>{if(he(s),s.length<2){Q([]);return}Ee(!0);try{const t=(await et.search(s)).filter(a=>{var l;return!((l=v==null?void 0:v.members)!=null&&l.includes(a.uid))});Q(t)}catch(r){console.error("Error searching users:",r)}finally{Ee(!1)}},S=async s=>{Ue(s);try{await je.addMember(M,s);const r=await je.getMemberDetails([...v.members,s]);Ke(r),ce(t=>({...t,members:[...t.members,s]})),Q(t=>t.filter(a=>a.uid!==s))}catch(r){console.error("Error inviting user:",r),alert("Failed to invite user")}finally{Ue(null)}},A=async()=>{if(confirm("Are you sure you want to leave this group?"))try{await je.removeMember(M,p.uid),te("/groups")}catch(s){console.error("Error leaving group:",s)}},y=async()=>{if(confirm("Are you sure you want to delete this group? This cannot be undone."))try{await je.delete(M),te("/groups")}catch(s){console.error("Error deleting group:",s)}},W=()=>{const s=(v==null?void 0:v.members)||[];K(s),Z(new Date().toISOString().split("T")[0]),_(""),ee("");const r={};s.forEach(t=>{r[t]={personalNotes:"",exercises:[{id:Date.now()+Math.random(),name:"",type:"weight",notes:"",sets:[{weight:"",reps:""}]}]}}),T(r),Ae(s[0]||null),ie(null),le(!0)},u=s=>{const r=s.assignments.map(f=>f.memberId);K(r);const t=Rs(s.date),a=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),m=String(t.getDate()).padStart(2,"0");Z(`${a}-${l}-${m}`),_(s.name);const h={},i={},c=ne.find(f=>{var w;return f.id===((w=s.assignments[0])==null?void 0:w.id)});ee((c==null?void 0:c.coachingNotes)||""),s.assignments.forEach(f=>{var q;const w=ne.find(oe=>oe.id===f.id);i[f.memberId]=f.id,(q=w==null?void 0:w.exercises)!=null&&q.length?h[f.memberId]={personalNotes:w.personalNotes||"",exercises:w.exercises.map(oe=>{var ys,ws,ks;const ss=oe.type||((ws=(ys=oe.sets)==null?void 0:ys[0])!=null&&ws.prescribedTime?"time":"weight");return{id:Date.now()+Math.random(),name:oe.name,type:ss,notes:oe.notes||"",sets:((ks=oe.sets)==null?void 0:ks.map(qe=>ss==="time"?{time:qe.prescribedTime||""}:ss==="bodyweight"?{reps:qe.prescribedReps||""}:{weight:qe.prescribedWeight||"",reps:qe.prescribedReps||""}))||[{weight:"",reps:""}]}})}:h[f.memberId]={personalNotes:(w==null?void 0:w.personalNotes)||"",exercises:[{id:Date.now()+Math.random(),name:"",type:"weight",notes:"",sets:[{weight:"",reps:""}]}]}}),T(h),Ae(r[0]||null),ie(i),le(!0)},x=async s=>{const r=s.length;if(confirm(`Delete this workout for ${r} member${r>1?"s":""}? This cannot be undone.`))try{await Promise.all(s.map(t=>fe.delete(t.id))),E(t=>t.filter(a=>!s.some(l=>l.id===a.id))),ze(null)}catch(t){console.error("Error deleting workouts:",t),alert("Failed to delete workouts")}},N=s=>{T(r=>{var t;return{...r,[s]:{...r[s],exercises:[...((t=r[s])==null?void 0:t.exercises)||[],{id:Date.now()+Math.random(),name:"",type:"weight",notes:"",sets:[{weight:"",reps:""}]}]}}})},k=(s,r)=>{T(t=>({...t,[s]:{...t[s],exercises:t[s].exercises.filter(a=>a.id!==r)}}))},P=(s,r,t,a)=>{T(l=>{const m={...l},h=m[s].exercises.map(i=>{if(i.id!==r)return i;const c={...i,[t]:a};if(t==="name"){const f=G.includes(a),w=xe.includes(a)&&!de.includes(a);f&&i.type!=="time"?(c.type="time",c.sets=i.sets.map(q=>({time:q.time||""}))):w&&i.type!=="bodyweight"?(c.type="bodyweight",c.sets=i.sets.map(q=>({reps:q.reps||""}))):!f&&!w&&i.type!=="weight"&&(c.type="weight",c.sets=i.sets.map(q=>({weight:q.weight||"",reps:q.reps||""})))}return c});return m[s]={...m[s],exercises:h},m})},$=(s,r)=>{T(t=>({...t,[s]:{...t[s],exercises:t[s].exercises.map(a=>{if(a.id!==r)return a;const l=a.sets[a.sets.length-1];let m;return a.type==="time"?m={time:(l==null?void 0:l.time)||""}:a.type==="bodyweight"?m={reps:(l==null?void 0:l.reps)||""}:m={weight:(l==null?void 0:l.weight)||"",reps:(l==null?void 0:l.reps)||""},{...a,sets:[...a.sets,m]}})}}))},R=(s,r,t,a,l)=>{T(m=>({...m,[s]:{...m[s],exercises:m[s].exercises.map(h=>h.id===r?{...h,sets:h.sets.map((i,c)=>c===t?{...i,[a]:l}:i)}:h)}}))},pe=(s,r,t)=>{T(a=>({...a,[s]:{...a[s],exercises:a[s].exercises.map(l=>l.id===r?{...l,sets:l.sets.filter((m,h)=>h!==t)}:l)}}))},$s=s=>{T(r=>({...r,[s]:{...r[s],exercises:r[s].exercises.map(t=>{const a=t.sets[t.sets.length-1];let l;return t.type==="time"?l={time:(a==null?void 0:a.time)||""}:t.type==="bodyweight"?l={reps:(a==null?void 0:a.reps)||""}:l={weight:(a==null?void 0:a.weight)||"",reps:(a==null?void 0:a.reps)||""},{...t,sets:[...t.sets,l]}})}}))},Ps=s=>{const t=(z[s]||{}).exercises||[],a=JSON.parse(JSON.stringify(t));T(l=>{const m={...l};return O.forEach(h=>{h!==s&&(m[h]={...m[h],exercises:a.map(i=>({...i,id:Date.now()+Math.random(),sets:i.sets.map(c=>({...c}))}))})}),m})},Ls=s=>{K(r=>{const t=r.includes(s)?r.filter(a=>a!==s):[...r,s];return r.includes(s)||T(a=>({...a,[s]:{personalNotes:"",exercises:[{id:Date.now(),name:"",type:"weight",notes:"",sets:[{weight:"",reps:""}]}]}})),t})},Os=async()=>{if(!U.trim()||O.length===0){alert("Please enter a workout name and select at least one member");return}He(!0);try{const[s,r,t]=H.split("-").map(Number),a=new Date(s,r-1,t,12,0,0),l=h=>((h==null?void 0:h.exercises)||[]).filter(i=>i.name.trim()).map(i=>({name:i.name,type:i.type||"weight",notes:i.notes||"",sets:i.sets.map((c,f)=>{const w={id:Date.now()+f,rpe:"",painLevel:0};return i.type==="time"?{...w,prescribedTime:c.time||"",actualTime:""}:i.type==="bodyweight"?{...w,prescribedReps:c.reps||"",actualReps:""}:{...w,prescribedWeight:c.weight||"",prescribedReps:c.reps||"",actualWeight:"",actualReps:""}})}));if(D)for(const h of O){const i=D[h];if(!i)continue;const c=z[h],f=l(c);await fe.update(i,{name:U,date:a,exercises:f,coachingNotes:ue||"",personalNotes:(c==null?void 0:c.personalNotes)||""})}else{const h=O.map(i=>{const c=z[i],f=l(c);return{assignedTo:i,name:U,exercises:f}});await fe.createBatch(M,v.admins,a,h,v.members)}const m=await fe.getByGroup(M,p.uid);E(m),le(!1),ie(null),ee(""),alert(D?"Workout updated!":`Workout assigned to ${O.length} member${O.length!==1?"s":""}!`)}catch(s){console.error("Error saving group workout:",s),alert("Failed to save workout")}finally{He(!1)}},es=tt({start:Ss(new Date,{weekStartsOn:1}),end:Es(new Date,{weekStartsOn:1})}),us=s=>{const r=hs[s]||[];return es.map(t=>{const a=r.find(l=>{var m;try{const h=(m=l.date)!=null&&m.toDate?l.date.toDate():new Date(l.date);return st(h,t)}catch{return!1}});return(a==null?void 0:a.status)||null})},ps=s=>{switch(s){case"present":return"bg-green-500";case"missed":return"bg-red-500";case"vacation":return"bg-blue-500";default:return"bg-iron-700"}};return ve?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"w-10 h-10 border-4 border-flame-500 border-t-transparent rounded-full animate-spin"})}):v?e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 pb-24",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>te("/groups"),className:"flex items-center gap-2 text-iron-400 hover:text-iron-200 transition-colors",children:[e.jsx(Vs,{className:"w-5 h-5"}),e.jsx("span",{children:"Groups"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>L(!we),className:"p-2 text-iron-400 hover:text-iron-200 hover:bg-iron-800 rounded-lg transition-colors",children:e.jsx(at,{className:"w-5 h-5"})}),we&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>L(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-iron-800 border border-iron-700 rounded-lg shadow-xl z-20 overflow-hidden",children:[g&&e.jsxs(Ve,{to:`/groups/${M}/settings`,className:"flex items-center gap-3 px-4 py-3 text-iron-300 hover:bg-iron-700 transition-colors",children:[e.jsx(Js,{className:"w-4 h-4"}),"Group Settings"]}),e.jsxs("button",{onClick:A,className:"w-full flex items-center gap-3 px-4 py-3 text-iron-300 hover:bg-iron-700 transition-colors",children:[e.jsx(Xs,{className:"w-4 h-4"}),"Leave Group"]}),g&&e.jsxs("button",{onClick:y,className:"w-full flex items-center gap-3 px-4 py-3 text-red-400 hover:bg-red-500/10 transition-colors",children:[e.jsx(os,{className:"w-4 h-4"}),"Delete Group"]})]})]})]})]}),e.jsxs("div",{className:"card-steel p-6 mb-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-flame-500/20 to-flame-600/10 flex items-center justify-center flex-shrink-0",children:e.jsx(Xe,{className:"w-8 h-8 text-flame-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-display text-iron-100 mb-1",children:v.name}),e.jsxs("p",{className:"text-iron-500 text-sm",children:[F.length," member",F.length!==1?"s":""," · Created ",xs(v.createdAt)]})]})]}),g&&v.inviteCode&&e.jsx("div",{className:"mt-6 p-4 bg-iron-800/50 rounded-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-iron-400 mb-1",children:"Invite Code"}),e.jsx("p",{className:"text-xl font-mono font-bold text-iron-200 tracking-wider",children:v.inviteCode})]}),e.jsx("button",{onClick:b,className:"btn-secondary flex items-center gap-2",children:me?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-4 h-4 text-green-400"}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-4 h-4"}),"Copy"]})})]})})]}),e.jsx("div",{className:"flex gap-2 mb-6 border-b border-iron-800 overflow-x-auto",children:["members","workouts","goals","attendance"].map(s=>e.jsxs("button",{onClick:()=>X(s),className:`px-4 py-3 text-sm font-medium whitespace-nowrap transition-colors relative ${B===s?"text-flame-400":"text-iron-500 hover:text-iron-300"}`,children:[s.charAt(0).toUpperCase()+s.slice(1),B===s&&e.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-flame-500"})]},s))}),B==="workouts"&&e.jsxs("div",{className:"space-y-4",children:[g&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>o(!0),className:"btn-secondary flex-1 flex items-center justify-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"AI Generate"]}),e.jsxs("button",{onClick:W,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5"}),"Manual"]})]}),ne.length===0?e.jsxs("div",{className:"card-steel p-8 text-center",children:[e.jsx(Ye,{className:"w-12 h-12 text-iron-600 mx-auto mb-3"}),e.jsx("p",{className:"text-iron-400",children:"No group workouts yet"}),g&&e.jsx("p",{className:"text-iron-500 text-sm mt-1",children:"Create a workout to assign it to group members"})]}):e.jsx("div",{className:"space-y-3",children:(()=>{const s={};return ne.forEach(r=>{const t=xs(r.date,"yyyy-MM-dd"),a=`${r.name}-${t}`;s[a]||(s[a]={name:r.name,date:r.date,exercises:r.exercises,assignments:[]}),s[a].assignments.push({id:r.id,memberId:r.assignedTo,status:r.status})}),Object.entries(s).map(([r,t])=>{var h,i;const a=Qe===r,l=t.assignments.filter(c=>c.status==="completed").length,m=t.assignments.length;return e.jsxs("div",{className:"card-steel overflow-hidden",children:[e.jsxs("button",{onClick:()=>ze(a?null:r),className:"w-full p-4 flex items-center gap-4 text-left hover:bg-iron-800/30 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-flame-500/10 flex items-center justify-center flex-shrink-0",children:e.jsx(Ye,{className:"w-5 h-5 text-flame-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-iron-100",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-iron-500",children:[e.jsx("span",{children:xs(t.date,"EEE, MMM d")}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[((h=t.exercises)==null?void 0:h.length)||0," exercises"]}),e.jsx("span",{children:"·"}),e.jsxs("span",{className:l===m?"text-green-400":"",children:[l,"/",m," done"]})]})]}),a?e.jsx(ms,{className:"w-5 h-5 text-iron-500"}):e.jsx(Ms,{className:"w-5 h-5 text-iron-500"})]}),a&&e.jsxs("div",{className:"border-t border-iron-800",children:[(()=>{const c=ne.find(f=>{var w;return f.id===((w=t.assignments[0])==null?void 0:w.id)});return c!=null&&c.coachingNotes?e.jsxs("div",{className:"p-4 bg-flame-500/5 border-b border-iron-800",children:[e.jsxs("p",{className:"text-xs text-flame-400 flex items-center gap-1.5 mb-1.5",children:[e.jsx(Ne,{className:"w-3 h-3"}),"AI Coaching Notes"]}),e.jsx("p",{className:"text-sm text-iron-400 leading-relaxed",children:c.coachingNotes})]}):null})(),e.jsxs("div",{className:"p-4 bg-iron-800/20 border-b border-iron-800",children:[e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wide mb-2",children:"Exercises"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(i=t.exercises)==null?void 0:i.map((c,f)=>{var w;return e.jsxs("span",{className:"px-2 py-1 bg-iron-800 rounded text-sm text-iron-300",children:[c.name," (",((w=c.sets)==null?void 0:w.length)||0,"×)"]},f)})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wide mb-3",children:"Assigned Members"}),e.jsx("div",{className:"space-y-2",children:t.assignments.map(c=>{var w;const f=F.find(q=>q.uid===c.memberId);return e.jsxs(Ve,{to:`/workouts/group/${c.id}`,state:{from:`/groups/${M}`,fromLabel:"Back to Group"},className:"flex items-center gap-3 p-3 rounded-lg bg-iron-800/30 hover:bg-iron-800/50 transition-colors",children:[f!=null&&f.photoURL?e.jsx("img",{src:f.photoURL,alt:"",className:"w-8 h-8 rounded-full"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-iron-700 flex items-center justify-center",children:e.jsx("span",{className:"text-sm text-iron-400",children:((w=f==null?void 0:f.displayName)==null?void 0:w[0])||"?"})}),e.jsx("span",{className:"flex-1 text-iron-200",children:(f==null?void 0:f.displayName)||"Unknown"}),c.status==="completed"?e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs font-medium",children:"Done"}):e.jsx("span",{className:"px-2 py-0.5 bg-yellow-500/20 text-yellow-400 rounded text-xs font-medium",children:"Pending"}),e.jsx(Ms,{className:"w-4 h-4 text-iron-600"})]},c.id)})})]}),g&&e.jsxs("div",{className:"p-4 border-t border-iron-800 flex gap-2",children:[e.jsxs("button",{onClick:()=>u(t),className:"btn-secondary flex-1 flex items-center justify-center gap-2",children:[e.jsx(nt,{className:"w-4 h-4"}),"Edit Workout"]}),e.jsxs("button",{onClick:c=>{c.stopPropagation(),x(t.assignments)},className:"px-4 py-2 bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"}),"Delete"]})]})]})]},r)})})()})]}),B==="members"&&e.jsxs("div",{className:"space-y-3",children:[F.map(s=>{var r,t;return e.jsxs(Ve,{to:`/profile/${s.username||s.uid}`,state:{from:`/groups/${M}`,fromLabel:"Back to Group"},className:"card-steel p-4 flex items-center gap-4 hover:border-iron-600 transition-colors",children:[s.photoURL?e.jsx("img",{src:s.photoURL,alt:s.displayName,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-iron-700 flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-bold text-iron-400",children:((r=s.displayName)==null?void 0:r[0])||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-iron-100 truncate",children:s.displayName||"Unknown"}),((t=v.admins)==null?void 0:t.includes(s.uid))&&e.jsx(rt,{className:"w-4 h-4 text-yellow-500 flex-shrink-0"}),s.uid===p.uid&&e.jsx("span",{className:"text-xs text-iron-500",children:"(you)"})]}),s.username&&e.jsxs("p",{className:"text-xs text-iron-500",children:["@",s.username]})]}),e.jsx("div",{className:"hidden sm:flex gap-1",children:us(s.uid).map((a,l)=>e.jsx("div",{className:`w-2 h-2 rounded-full ${ps(a)}`,title:Pe(es[l],"EEE")},l))})]},s.uid)}),g&&e.jsxs("button",{onClick:()=>Y(!0),className:"w-full card-steel p-4 flex items-center justify-center gap-2 text-iron-400 hover:text-iron-200 hover:border-iron-600 transition-colors",children:[e.jsx(Ys,{className:"w-5 h-5"}),"Invite Members"]})]}),B==="attendance"&&e.jsxs("div",{className:"card-steel overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-iron-700",children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-iron-400",children:"Member"}),es.map(s=>e.jsxs("th",{className:`px-3 py-3 text-center text-sm font-medium ${Ks(s)?"text-flame-400":"text-iron-400"}`,children:[Pe(s,"EEE"),e.jsx("div",{className:"text-xs text-iron-600 font-normal",children:Pe(s,"d")})]},s.toISOString()))]})}),e.jsx("tbody",{children:F.map(s=>{var r,t;return e.jsxs("tr",{className:"border-b border-iron-800 last:border-0",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.photoURL?e.jsx("img",{src:s.photoURL,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-iron-700 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-iron-400",children:(r=s.displayName)==null?void 0:r[0]})}),e.jsx("span",{className:"text-sm text-iron-200 truncate max-w-[100px]",children:(t=s.displayName)==null?void 0:t.split(" ")[0]})]})}),us(s.uid).map((a,l)=>e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsx("div",{className:`w-6 h-6 rounded-full mx-auto ${ps(a)}`,title:a||"No data"})},l))]},s.uid)})})]})}),e.jsxs("div",{className:"px-4 py-3 bg-iron-800/50 flex gap-4 text-xs text-iron-500",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500"})," Present"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"})," Missed"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-blue-500"})," Vacation"]})]})]}),B==="goals"&&e.jsx("div",{className:"space-y-4",children:F.map(s=>{var r,t;return e.jsxs("div",{className:"card-steel rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-iron-800 flex items-center gap-3",children:[s.photoURL?e.jsx("img",{src:s.photoURL,alt:"",className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-iron-700 flex items-center justify-center",children:e.jsx("span",{className:"font-bold text-iron-400",children:(r=s.displayName)==null?void 0:r[0]})}),e.jsx("div",{children:e.jsxs("h3",{className:"font-medium text-iron-100",children:[s.displayName,s.uid===p.uid&&e.jsx("span",{className:"text-xs text-iron-500 ml-2",children:"(you)"})]})})]}),e.jsx("div",{className:"p-4",children:((t=J[s.uid])==null?void 0:t.length)>0?e.jsx("div",{className:"space-y-3",children:J[s.uid].map(a=>{const l=a.currentValue??a.currentWeight??0,m=a.targetValue??a.targetWeight??0,h=m>0?Math.min(100,l/m*100):0,i=a.metricType==="time"?"sec":a.metricType==="reps"?"reps":"lbs";return e.jsxs("div",{className:"bg-iron-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-iron-200",children:a.lift}),e.jsxs("span",{className:"text-sm text-iron-400",children:[l," / ",m," ",i]})]}),e.jsx("div",{className:"h-2 bg-iron-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-flame-500 rounded-full transition-all",style:{width:`${h}%`}})})]},a.id)})}):e.jsx("p",{className:"text-iron-500 text-sm text-center py-2",children:"No active goals"})})]},s.uid)})}),De&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-iron-900 rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-iron-900 border-b border-iron-800 p-4 flex items-center justify-between flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-display text-iron-100",children:D?"Edit Group Workout":"Assign Group Workout"}),e.jsx("button",{onClick:()=>{le(!1),ie(null),ee("")},className:"p-2 text-iron-400 hover:text-iron-200 transition-colors",children:e.jsx(be,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-300 mb-2",children:"Workout Name *"}),e.jsx("input",{type:"text",value:U,onChange:s=>_(s.target.value),placeholder:"e.g., Push Day, Bench Focus",className:"input-field w-full text-base py-3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-300 mb-2",children:"Date *"}),e.jsx("input",{type:"date",value:H,onChange:s=>Z(s.target.value),className:"input-field w-full text-base py-3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-iron-300 mb-3",children:D?"Assigned Members":"Assign to Members"}),D&&ue&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>{const s=document.getElementById("coaching-notes-section");s&&s.classList.toggle("hidden")},className:"flex items-center gap-2 text-sm text-flame-400 hover:text-flame-300 mb-2",children:[e.jsx(lt,{className:"w-4 h-4"}),"AI Coaching Notes",e.jsx(ms,{className:"w-3 h-3"})]}),e.jsx("div",{id:"coaching-notes-section",children:e.jsx("textarea",{value:ue,onChange:s=>ee(s.target.value),rows:3,className:"input-field w-full text-sm resize-none",placeholder:"Coaching notes..."})})]}),D&&e.jsx("p",{className:"text-xs text-iron-500 mb-2",children:"Members cannot be changed when editing. Create a new workout to assign to different members."}),e.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(s=>{var a,l;const r=O.includes(s.uid),t=D&&!r;return e.jsxs("button",{onClick:()=>!D&&Ls(s.uid),disabled:D,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${r?"bg-flame-500/20 border border-flame-500/50 text-flame-200":t?"bg-iron-800/30 border border-iron-800 text-iron-600 cursor-not-allowed":"bg-iron-800/50 border border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[s.photoURL?e.jsx("img",{src:s.photoURL,alt:"",className:"w-5 h-5 rounded-full"}):e.jsx("div",{className:"w-5 h-5 rounded-full bg-iron-700 flex items-center justify-center text-xs",children:(a=s.displayName)==null?void 0:a[0]}),e.jsx("span",{className:"text-sm",children:(l=s.displayName)==null?void 0:l.split(" ")[0]}),r&&e.jsx(se,{className:"w-4 h-4"})]},s.uid)})})]}),O.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-iron-300",children:"Prescriptions by Member"}),j&&O.length>1&&e.jsxs("button",{onClick:()=>Ps(j),className:"text-xs text-flame-400 hover:text-flame-300 flex items-center gap-1",children:[e.jsx(cs,{className:"w-3 h-3"}),"Copy to all members"]})]}),e.jsx("div",{className:"flex gap-1 mb-4 overflow-x-auto pb-2",children:O.map(s=>{var t,a;const r=F.find(l=>l.uid===s);return e.jsxs("button",{onClick:()=>Ae(s),className:`flex items-center gap-2 px-3 py-2 rounded-lg whitespace-nowrap transition-colors ${j===s?"bg-flame-500 text-white":"bg-iron-800 text-iron-400 hover:bg-iron-700"}`,children:[r!=null&&r.photoURL?e.jsx("img",{src:r.photoURL,alt:"",className:"w-5 h-5 rounded-full"}):e.jsx("div",{className:"w-5 h-5 rounded-full bg-iron-600 flex items-center justify-center text-xs",children:(t=r==null?void 0:r.displayName)==null?void 0:t[0]}),e.jsx("span",{className:"text-sm",children:(a=r==null?void 0:r.displayName)==null?void 0:a.split(" ")[0]})]},s)})}),j&&z[j]&&e.jsxs("div",{className:"space-y-4",children:[(D||((js=z[j])==null?void 0:js.personalNotes))&&e.jsxs("div",{className:"bg-iron-800/30 rounded-lg p-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-iron-500 mb-2",children:[e.jsx(Ts,{className:"w-3 h-3"}),"Personal Notes for ",((Ns=(bs=F.find(s=>s.uid===j))==null?void 0:bs.displayName)==null?void 0:Ns.split(" ")[0])||"Member"]}),e.jsx("textarea",{value:((vs=z[j])==null?void 0:vs.personalNotes)||"",onChange:s=>T(r=>({...r,[j]:{...r[j],personalNotes:s.target.value}})),rows:2,className:"input-field w-full text-sm resize-none",placeholder:"Notes specific to this athlete..."})]}),z[j].exercises.length>1&&e.jsxs("button",{onClick:()=>$s(j),className:"w-full py-2 text-xs text-flame-400 hover:text-flame-300 bg-flame-500/5 hover:bg-flame-500/10 border border-flame-500/20 rounded-lg flex items-center justify-center gap-1.5 transition-colors",children:[e.jsx(Je,{className:"w-3 h-3"}),"Add 1 Set to Each Exercise"]}),z[j].exercises.map((s,r)=>e.jsxs("div",{className:"bg-iron-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"w-7 h-7 rounded-lg bg-flame-500/20 text-flame-400 flex items-center justify-center text-sm font-medium",children:r+1}),e.jsxs("select",{value:s.name,onChange:t=>P(j,s.id,"name",t.target.value),className:"input-field flex-1 text-base py-2",children:[e.jsx("option",{value:"",children:"Select exercise"}),s.name&&![...de,...xe,...G].includes(s.name)&&e.jsxs("option",{value:s.name,children:[s.name," (custom)"]}),e.jsx("optgroup",{label:"Weight Exercises",children:de.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("optgroup",{label:"Bodyweight",children:xe.map(t=>e.jsx("option",{value:t,children:t},`bw-${t}`))}),e.jsx("optgroup",{label:"Time-Based",children:G.map(t=>e.jsx("option",{value:t,children:t},`t-${t}`))})]}),z[j].exercises.length>1&&e.jsx("button",{onClick:()=>k(j,s.id),className:"p-2 text-iron-500 hover:text-red-400 transition-colors",children:e.jsx(os,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex items-center gap-1.5 mb-3 ml-9",children:["weight","bodyweight","time"].map(t=>e.jsx("button",{onClick:()=>{const a=s.sets.map(l=>t==="time"?{time:l.time||""}:t==="bodyweight"?{reps:l.reps||""}:{weight:l.weight||"",reps:l.reps||""});T(l=>({...l,[j]:{...l[j],exercises:l[j].exercises.map(m=>m.id===s.id?{...m,type:t,sets:a}:m)}}))},className:`text-xs px-2 py-0.5 rounded transition-colors ${s.type===t?t==="time"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":t==="bodyweight"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-iron-600/30 text-iron-300 border border-iron-500/30":"text-iron-600 hover:text-iron-400"}`,children:t==="weight"?"Weight":t==="bodyweight"?"BW":"Time"},t))}),e.jsxs("div",{className:"space-y-2",children:[s.type==="time"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2 text-xs text-iron-500 px-1",children:[e.jsx("div",{className:"col-span-2",children:"Set"}),e.jsx("div",{className:"col-span-8",children:"Time (seconds)"}),e.jsx("div",{className:"col-span-2"})]}),s.sets.map((t,a)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:"text-iron-400 text-sm font-medium pl-1",children:a+1})}),e.jsx("div",{className:"col-span-8",children:e.jsx("input",{type:"number",inputMode:"numeric",value:t.time||"",onChange:l=>R(j,s.id,a,"time",l.target.value),placeholder:"60",className:"input-field w-full text-base py-2 px-3"})}),e.jsx("div",{className:"col-span-2 flex justify-end",children:s.sets.length>1&&e.jsx("button",{onClick:()=>pe(j,s.id,a),className:"p-1 text-iron-600 hover:text-red-400 transition-colors",children:e.jsx(be,{className:"w-4 h-4"})})})]},a))]}):s.type==="bodyweight"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2 text-xs text-iron-500 px-1",children:[e.jsx("div",{className:"col-span-2",children:"Set"}),e.jsx("div",{className:"col-span-8",children:"Reps"}),e.jsx("div",{className:"col-span-2"})]}),s.sets.map((t,a)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:"text-iron-400 text-sm font-medium pl-1",children:a+1})}),e.jsx("div",{className:"col-span-8",children:e.jsx("input",{type:"text",inputMode:"numeric",value:t.reps||"",onChange:l=>R(j,s.id,a,"reps",l.target.value),onBlur:l=>R(j,s.id,a,"reps",Ds(l.target.value)),placeholder:"e.g. 10 or 8-12",className:"input-field w-full text-base py-2 px-3"})}),e.jsx("div",{className:"col-span-2 flex justify-end",children:s.sets.length>1&&e.jsx("button",{onClick:()=>pe(j,s.id,a),className:"p-1 text-iron-600 hover:text-red-400 transition-colors",children:e.jsx(be,{className:"w-4 h-4"})})})]},a))]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2 text-xs text-iron-500 px-1",children:[e.jsx("div",{className:"col-span-2",children:"Set"}),e.jsx("div",{className:"col-span-4",children:"Weight"}),e.jsx("div",{className:"col-span-4",children:"Reps"}),e.jsx("div",{className:"col-span-2"})]}),s.sets.map((t,a)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:"text-iron-400 text-sm font-medium pl-1",children:a+1})}),e.jsx("div",{className:"col-span-4",children:e.jsx("input",{type:"text",value:t.weight||"",onChange:l=>R(j,s.id,a,"weight",l.target.value),placeholder:"lbs",className:"input-field w-full text-base py-2 px-3"})}),e.jsx("div",{className:"col-span-4",children:e.jsx("input",{type:"text",inputMode:"numeric",value:t.reps||"",onChange:l=>R(j,s.id,a,"reps",l.target.value),onBlur:l=>R(j,s.id,a,"reps",Ds(l.target.value)),placeholder:"e.g. 8 or 6-8",className:"input-field w-full text-base py-2 px-3"})}),e.jsx("div",{className:"col-span-2 flex justify-end",children:s.sets.length>1&&e.jsx("button",{onClick:()=>pe(j,s.id,a),className:"p-1 text-iron-600 hover:text-red-400 transition-colors",children:e.jsx(be,{className:"w-4 h-4"})})})]},a))]}),e.jsxs("button",{onClick:()=>$(j,s.id),className:"w-full py-2 text-xs text-iron-500 hover:text-iron-300 flex items-center justify-center gap-1",children:[e.jsx(Je,{className:"w-3 h-3"}),"Add Set"]})]}),(s.notes||D)&&e.jsx("div",{className:"mt-3 pt-3 border-t border-iron-700/50",children:e.jsx("input",{type:"text",value:s.notes||"",onChange:t=>P(j,s.id,"notes",t.target.value),placeholder:"Form cues, modifications, warnings...",className:"input-field w-full text-xs py-1.5 px-2 bg-iron-800/30 placeholder:text-iron-600"})})]},s.id)),e.jsxs("button",{onClick:()=>N(j),className:"w-full py-3 border border-dashed border-iron-700 rounded-lg text-iron-400 hover:text-iron-200 hover:border-iron-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4"}),"Add Exercise"]})]})]})]}),e.jsxs("div",{className:"bg-iron-900 border-t border-iron-800 p-4 flex gap-3 flex-shrink-0",children:[e.jsx("button",{onClick:()=>le(!1),className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{onClick:Os,disabled:Ie||!U.trim()||O.length===0,className:"btn-primary flex-1 disabled:opacity-50",children:Ie?D?"Saving...":"Creating...":D?"Save Changes":`Assign to ${O.length} Member${O.length!==1?"s":""}`})]})]})}),ke&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-iron-900 rounded-xl w-full max-w-md max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-iron-800 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-display text-iron-100",children:"Invite Members"}),e.jsx("button",{onClick:()=>{Y(!1),he(""),Q([])},className:"p-2 text-iron-400 hover:text-iron-200",children:e.jsx(be,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex border-b border-iron-800",children:[e.jsx("button",{onClick:()=>Se("code"),className:`flex-1 py-3 text-sm font-medium transition-colors ${Ce==="code"?"text-flame-400 border-b-2 border-flame-400":"text-iron-400 hover:text-iron-200"}`,children:"Share Code"}),e.jsx("button",{onClick:()=>Se("search"),className:`flex-1 py-3 text-sm font-medium transition-colors ${Ce==="search"?"text-flame-400 border-b-2 border-flame-400":"text-iron-400 hover:text-iron-200"}`,children:"Search Users"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:Ce==="code"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-iron-400 text-sm",children:"Share this code with people you want to invite to the group."}),e.jsxs("div",{className:"bg-iron-800/50 rounded-xl p-6 text-center",children:[e.jsx("p",{className:"text-3xl font-mono font-bold text-iron-100 tracking-widest mb-4",children:(v==null?void 0:v.inviteCode)||"No code"}),e.jsx("button",{onClick:b,className:"btn-secondary flex items-center gap-2 mx-auto",children:me?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-4 h-4"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-4 h-4"}),"Copy Code"]})})]}),e.jsx("p",{className:"text-iron-500 text-xs text-center",children:"Members can join using this code in Groups → Join Group"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(As,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-iron-500"}),e.jsx("input",{type:"text",value:Ge,onChange:s=>C(s.target.value),placeholder:"Search by name or email...",className:"input-field w-full pl-10 py-3",autoFocus:!0})]}),Ze?e.jsx("div",{className:"py-8 text-center",children:e.jsx("div",{className:"w-6 h-6 border-2 border-flame-500 border-t-transparent rounded-full animate-spin mx-auto"})}):Be.length>0?e.jsx("div",{className:"space-y-2",children:Be.map(s=>{var r;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-iron-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.photoURL?e.jsx("img",{src:s.photoURL,alt:"",className:"w-10 h-10 rounded-full"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-iron-700 flex items-center justify-center",children:e.jsx("span",{className:"text-iron-400 font-medium",children:((r=s.displayName)==null?void 0:r[0])||"?"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-iron-100 font-medium",children:s.displayName}),e.jsx("p",{className:"text-iron-500 text-sm",children:s.email})]})]}),e.jsx("button",{onClick:()=>S(s.uid),disabled:Me===s.uid,className:"btn-primary text-sm py-2 px-4 disabled:opacity-50",children:Me===s.uid?"Adding...":"Add"})]},s.uid)})}):Ge.length>=2?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Xe,{className:"w-10 h-10 text-iron-700 mx-auto mb-2"}),e.jsx("p",{className:"text-iron-500",children:"No users found"})]}):e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(As,{className:"w-10 h-10 text-iron-700 mx-auto mb-2"}),e.jsx("p",{className:"text-iron-500",children:"Type to search for users"})]})]})})]})}),e.jsx(it,{isOpen:n,onClose:()=>o(!1),group:v,athletes:F,coachId:p.uid,isAdmin:ae,onSuccess:()=>{fe.getByGroup(M,p.uid).then(E).catch(s=>console.error("[GroupDetail] Refresh failed:",s))}})]}):e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8 text-center",children:[e.jsx("h2",{className:"text-xl font-display text-iron-200 mb-4",children:"Group Not Found"}),e.jsx(Ve,{to:"/groups",className:"btn-primary",children:"Back to Groups"})]})}export{Nt as default};

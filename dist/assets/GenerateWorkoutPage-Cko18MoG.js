import{b as Ht,u as Bt,as as zt,d as Ut,r as o,at as _t,V as ue,W as pe,Y as he,$ as ae,a0 as re,a2 as ge,au as Jt,j as e,K as Kt,A as qt,B as fe,n as ot,m as H,i as P,C as ct,J as ne,I as dt,Z as mt,t as Vt,N as Yt,M as Zt,av as be,S as Oe,aw as ye,R as xt,l as Xt,o as ut,H as Qt,X as es,P as pt,w as Le,x as Me,ax as ts,ay as ss,a3 as as,az as ht}from"./index-DngWaF3c.js";import{E as rs}from"./ExerciseInfoModal-DsZL8d_c.js";import{T as ns}from"./timer-D9FC-9LZ.js";import{P as ls}from"./pencil-D1KRYuJz.js";import{F as is}from"./file-text-4fyQo_E-.js";import{T as os}from"./trash-2-BfpgiwwA.js";import{M as cs}from"./message-square-DqcUYucI.js";import"./external-link-D9DGizLx.js";const we=[{text:"Reviewing your recent training sessions...",icon:"brain"},{text:"Analyzing strength progression trends...",icon:"calc"},{text:"Checking for pain history and injury risks...",icon:"alert"},{text:"Calculating working weights from your e1RM data...",icon:"calc"},{text:"Evaluating RPE patterns and recovery state...",icon:"brain"},{text:"Selecting exercises based on your focus area...",icon:"dumbbell"},{text:"Applying progressive overload to target weights...",icon:"calc"},{text:"Balancing volume with recovery capacity...",icon:"brain"},{text:"Building optimal set and rep schemes...",icon:"dumbbell"},{text:"Writing personalized coaching notes...",icon:"msg"}],gt=[{text:"Scanning for muscle group imbalances...",icon:"alert"},{text:"Rotating in fresh exercise variations...",icon:"dumbbell"},{text:"Mapping progressive overload from your history...",icon:"calc"},{text:"Dialing in rest periods for your intensity level...",icon:"brain"},{text:"Aligning exercises with your active goals...",icon:"dumbbell"},{text:"Verifying weights against your recent performance...",icon:"calc"},{text:"Cross-checking substitutions for flagged exercises...",icon:"alert"},{text:"Personalizing form cues and exercise notes...",icon:"msg"},{text:"Running final consistency checks...",icon:"brain"},{text:"Almost there...",icon:"calc"}];function ys(){var at;const je=Ht();Bt("Generate Workout");const[Fe]=zt(),{user:T,userProfile:E,updateProfile:J,isAppAdmin:ft}=Ut(),[a]=o.useState(()=>{try{const t=Fe.get("programContext");return t?JSON.parse(t):null}catch{return null}}),[R,O]=o.useState(!1),[le,Ge]=o.useState(!0),[w,C]=o.useState(null),[ie,He]=o.useState(null),[Be,L]=o.useState(null),[ze,Ue]=o.useState(!1),[j,_e]=o.useState(!1),[Je,oe]=o.useState(null),[ve,K]=o.useState(null),[Ne,q]=o.useState(""),[ke,bt]=o.useState(!1),[Ke,Se]=o.useState(null),[qe,Ce]=o.useState(null),[Ee,yt]=o.useState(!1),[V,De]=o.useState([]),[ds,Ve]=o.useState(null),[Y,D]=o.useState([]),Z=o.useRef(null),B=o.useRef(null),M=o.useRef(null),[b,wt]=o.useState({recentWorkouts:[],goals:[],maxLifts:{},painHistory:{},rpeAverages:{},cardioHistory:[],ouraData:null}),[X,jt]=o.useState(()=>{var s;if(!a)return"";const t=[`Program: ${a.programName} — Week ${a.weekNumber} (${a.phase})`];return t.push(`Day: ${a.dayLabel} (${a.dayType})`),t.push(`Primary: ${a.primaryLift} ${a.primaryScheme} @ ${a.intensity}`),((s=a.accessories)==null?void 0:s.length)>0&&t.push(`Accessories: ${a.accessories.join(", ")}`),a.notes&&t.push(`Notes: ${a.notes}`),t.push(`
Generate this workout following the program prescription above. Use my actual performance data to calculate working weights.`),t.join(`
`)}),[N,vt]=o.useState("strength"),[k,$e]=o.useState(a?"bench":"auto"),[Ie,Ye]=o.useState((a==null?void 0:a.dayType)==="deload"?"recovery":(a==null?void 0:a.dayType)==="test"?"max":(a==null?void 0:a.dayType)==="speed"?"light":"moderate"),[z,Ze]=o.useState("standard"),[Q,Nt]=o.useState("auto"),[ee,kt]=o.useState("auto"),[Te,Re]=o.useState(!1),[We,Ae]=o.useState(!1),[W,Pe]=o.useState(""),[Xe,St]=o.useState(()=>{const t=Fe.get("date");return t&&/^\d{4}-\d{2}-\d{2}$/.test(t)?t:_t()}),F=ft;o.useEffect(()=>{T&&Et()},[T]),o.useEffect(()=>{Z.current&&(Z.current.scrollTop=Z.current.scrollHeight)},[Y]),o.useEffect(()=>()=>{B.current&&clearInterval(B.current),M.current&&M.current()},[]);const y=(t,s,r=null)=>{De(i=>{const c=i.findIndex(n=>n.label===t);if(c>=0){const n=[...i];return n[c]={label:t,status:s,detail:r},n}return[...i,{label:t,status:s,detail:r}]}),Ve(t)},Ct=()=>{D([]);let t=1,s=0;D([{...we[0],id:0}]),B.current=setInterval(()=>{t<we.length?(D(r=>[...r,{...we[t],id:t}]),t++):s<gt.length&&(D(r=>[...r,{...gt[s],id:we.length+s}]),s++)},2e3)},U=()=>{B.current&&(clearInterval(B.current),B.current=null)},Qe=t=>{switch(t){case"brain":return e.jsx(fe,{className:"w-3 h-3 text-flame-400"});case"alert":return e.jsx(ne,{className:"w-3 h-3 text-amber-400"});case"calc":return e.jsx(Oe,{className:"w-3 h-3 text-purple-400"});case"dumbbell":return e.jsx(dt,{className:"w-3 h-3 text-cyan-400"});case"msg":return e.jsx(cs,{className:"w-3 h-3 text-blue-400"});case"check":return e.jsx(ct,{className:"w-3 h-3 text-green-400"});case"error":return e.jsx(ne,{className:"w-3 h-3 text-red-400"});default:return e.jsx(P,{className:"w-3 h-3 text-flame-400 animate-spin"})}},Et=async()=>{var t,s,r,i;try{Ge(!0),De([]);const c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];let n=[];y("Loading workout history","loading");try{(await ue(pe(he(ae,"workouts"),re("userId","==",T.uid),ge(50)))).docs.forEach(x=>{var g,u;const h=x.data();if(h.status==="completed"){const f=((u=(g=h.date)==null?void 0:g.toDate)==null?void 0:u.call(g))||new Date(h.date);n.push({...h,date:f.toISOString().split("T")[0],dayOfWeek:c[f.getDay()]})}})}catch(d){console.error(d)}try{(await ue(pe(he(ae,"groupWorkouts"),re("assignedTo","==",T.uid),ge(50)))).docs.forEach(x=>{var g,u;const h=x.data();if(h.status==="completed"){const f=((u=(g=h.date)==null?void 0:g.toDate)==null?void 0:u.call(g))||new Date(h.date);n.push({...h,date:f.toISOString().split("T")[0],dayOfWeek:c[f.getDay()]})}})}catch(d){console.error(d)}n.sort((d,x)=>new Date(x.date||0)-new Date(d.date||0)),n=n.slice(0,20),y("Loading workout history","complete",`${n.length} workouts found`),y("Analyzing max lifts","loading");const m={},l={},p={},S=new Date;n.forEach(d=>{var g;const x=(g=d.date)!=null&&g.toDate?d.date.toDate():d.date?new Date(d.date):null,h=x&&!isNaN(x.getTime())?Math.floor((S-x)/(1e3*60*60*24)):null;(d.exercises||[]).forEach(u=>{u.name&&(u.sets||[]).forEach(f=>{const _=parseFloat(f.actualWeight)||parseFloat(f.prescribedWeight)||0,xe=parseInt(f.actualReps)||parseInt(f.prescribedReps)||0,nt=parseInt(f.rpe)||0,lt=parseInt(f.painLevel)||0;if(!(!f.actualWeight&&!f.actualReps&&f.prescribedWeight)){if(_>0&&xe>0&&xe<=12){const it=Math.round(_*(1+xe/30));(!m[u.name]||it>m[u.name].e1rm)&&(m[u.name]={weight:_,reps:xe,e1rm:it})}lt>0&&(l[u.name]||(l[u.name]={count:0,maxPain:0,lastDaysAgo:null,recentCount:0}),l[u.name].count++,l[u.name].maxPain=Math.max(l[u.name].maxPain,lt),h!==null&&((l[u.name].lastDaysAgo===null||h<l[u.name].lastDaysAgo)&&(l[u.name].lastDaysAgo=h),h<=30&&l[u.name].recentCount++)),nt>0&&(p[u.name]||(p[u.name]={total:0,count:0}),p[u.name].total+=nt,p[u.name].count++)}})})});const I=Object.keys(m).length,de=Object.entries(m).sort((d,x)=>x[1].e1rm-d[1].e1rm).slice(0,3).map(([d,x])=>`${d}: ${x.e1rm}lb`);y("Analyzing max lifts","complete",I>0?`${I} lifts tracked. Top: ${de.join(", ")}`:"No lift data found");const v=E==null?void 0:E.aiContextOverrides;v&&(v.maxLifts&&Object.entries(v.maxLifts).forEach(([d,x])=>{m[d]={...m[d]||{},...x}}),v.excludeExercises&&v.excludeExercises.forEach(d=>{const x=d.toLowerCase();Object.keys(m).forEach(h=>{const g=h.toLowerCase();(x===g||g.includes(x)||x.includes(g))&&delete m[h]})})),y("Checking pain history","loading");const A=Object.keys(l).length,Gt=Object.keys(l).slice(0,3).join(", ");y("Checking pain history",A>0?"warning":"complete",A>0?`Pain flagged on: ${Gt}`:"No pain history"),y("Analyzing RPE patterns","loading");const te={};Object.entries(p).forEach(([d,x])=>{te[d]=Math.round(x.total/x.count*10)/10});const rt=Object.values(te).length>0?(Object.values(te).reduce((d,x)=>d+x,0)/Object.values(te).length).toFixed(1):null;y("Analyzing RPE patterns","complete",rt?`Average RPE: ${rt}`:"No RPE data"),y("Loading goals","loading");let me=[];try{me=(await ue(pe(he(ae,"goals"),re("userId","==",T.uid),ge(10)))).docs.map(x=>x.data()).filter(x=>x.status==="active")}catch(d){console.error(d)}y("Loading goals","complete",me.length>0?`${me.length} active goals`:"No active goals"),y("Loading cardio history","loading");let G=[];try{G=(await ue(pe(he(ae,"workouts"),re("userId","==",T.uid),re("workoutType","==","cardio"),ge(20)))).docs.map(x=>{var g,u,f,_;const h=x.data();return{...h,date:((_=(f=(u=(g=h.date)==null?void 0:g.toDate)==null?void 0:u.call(g))==null?void 0:f.toISOString)==null?void 0:_.call(f).split("T")[0])||h.date}}),G.sort((x,h)=>new Date(h.date||0)-new Date(x.date||0)),G=G.slice(0,10)}catch(d){console.error(d)}y("Loading cardio history","complete",G.length>0?`${G.length} recent cardio sessions`:"No cardio data");let se=null;try{se=await Jt.getLatestScores(T.uid),se&&y("Loading Oura data","complete",`Readiness: ${((s=(t=se.latest)==null?void 0:t.readiness)==null?void 0:s.score)||"—"}, Sleep: ${((i=(r=se.latest)==null?void 0:r.sleep)==null?void 0:i.score)||"—"}`)}catch{}wt({recentWorkouts:n,goals:me,maxLifts:m,painHistory:l,rpeAverages:te,cardioHistory:G,ouraData:se}),Ve(null)}catch(c){console.error("Error loading context:",c)}finally{Ge(!1)}},Dt=async()=>{var r;const t=(E==null?void 0:E.credits)??0,s=z==="premium"?ye:be["generate-workout"];if(!F&&t<s){L(`Not enough credits. You need ${s} credits but have ${t}. Check Settings for your usage.`);return}O(!0),L(null),y("Generating workout","loading"),Ct();try{F||J({credits:t-s});const i=await Le(),c=await fetch(Me("generate-workout"),{method:"POST",headers:i,body:JSON.stringify({prompt:X,workoutFocus:k,intensity:Ie,workoutCategory:N,model:z,includeWarmup:Te,includeStretches:We,duration:Q!=="auto"?parseInt(Q):null,exerciseCount:ee!=="auto"?parseInt(ee):null,maxExercise:k==="1rm-test"?W:null,draftMode:!0,context:{recentWorkouts:b.recentWorkouts.slice(0,5),goals:b.goals,maxLifts:b.maxLifts,painHistory:b.painHistory,rpeAverages:b.rpeAverages,cardioHistory:b.cardioHistory,ouraData:b.ouraData}})});if(!c.ok){const S=await c.json().catch(()=>({}));throw new Error(S.error||"Failed to generate workout")}const n=await c.json();if(n.success&&!n.background){C(n.workout),He(n.usage),U(),D(S=>[...S,{text:"Workout ready!",icon:"check",id:S.length}]),y("Generating workout","complete",`Created in ${(r=n.usage)==null?void 0:r.responseMs}ms`),O(!1);return}const m=ts(ae,"workoutJobs",n.jobId);let l=!1;const p=ss(m,S=>{var de;if(l)return;const I=S.data();if(I){if(I.status==="complete"&&I.result){l=!0,p(),M.current=null;const v=I.result;C(v.workout),He(v.usage),U(),D(A=>[...A,{text:"Workout ready!",icon:"check",id:A.length}]),y("Generating workout","complete",`Created in ${(de=v.usage)==null?void 0:de.responseMs}ms`),O(!1)}else if(I.status==="error"){l=!0,p(),M.current=null;const v=I.error||"Generation failed";L(v),F||J({credits:t}),U(),D(A=>[...A,{text:`Error: ${v}`,icon:"error",id:A.length}]),y("Generating workout","error",v),O(!1)}}},()=>{l||(l=!0,p(),M.current=null,L("Lost connection. Please try again."),F||J({credits:t}),U(),O(!1))});M.current=p,setTimeout(()=>{l||(l=!0,p(),M.current=null,L("Generation is taking too long. Please try again."),F||J({credits:t}),U(),O(!1))},9e4)}catch(i){console.error("Generation error:",i),L(i.message),F||J({credits:t}),U(),D(c=>[...c,{text:`Error: ${i.message}`,icon:"error",id:c.length}]),y("Generating workout","error",i.message),O(!1)}},$t=async()=>{if(w){Ue(!0);try{const t={...w,date:new Date(Xe+"T12:00:00"),status:"scheduled"};a&&(t.programId=a.programId,t.programWeek=a.weekNumber,t.programDayLabel=a.dayLabel);const s=await as.create(T.uid,t);if(a!=null&&a.programId&&(a!=null&&a.dayKey))try{const r=await ht.get(a.programId);if(r){const i=[...r.completedDays||[],a.dayKey];await ht.update(a.programId,{completedDays:i})}}catch(r){console.error("Failed to mark program day complete:",r)}je(`/workouts/${s.id}`)}catch(t){console.error("Save error:",t),L("Failed to save workout")}finally{Ue(!1)}}},It=(t,s)=>{C(r=>({...r,exercises:r.exercises.map((i,c)=>c===t?{...i,name:s}:i)}))},ce=(t,s,r,i)=>{C(c=>({...c,exercises:c.exercises.map((n,m)=>m===t?{...n,sets:n.sets.map((l,p)=>p===s?{...l,[r]:i}:l)}:n)}))},Tt=t=>{C(s=>({...s,exercises:s.exercises.filter((r,i)=>i!==t)}))},Rt=t=>{C(s=>({...s,exercises:s.exercises.map((r,i)=>{if(i!==t)return r;const c=r.sets[r.sets.length-1]||{};return{...r,sets:[...r.sets,{...c,id:Date.now(),completed:!1}]}})}))},Wt=(t,s)=>{C(r=>({...r,exercises:r.exercises.map((i,c)=>c===t?{...i,sets:i.sets.filter((n,m)=>m!==s)}:i)}))},et=async(t,s)=>{const r=w.exercises[t];if(r){oe(t);try{const i=w.exercises.filter((l,p)=>p!==t).map(l=>l.name),c=await Le(),n=await fetch(Me("swap-exercise"),{method:"POST",headers:c,body:JSON.stringify({exerciseName:r.name,exerciseType:r.type||"weight",sets:r.sets,workoutContext:{otherExercises:i},...s?{reason:s}:{}})});if(!n.ok)throw new Error("Swap failed");const m=await n.json();m.exercise&&C(l=>({...l,exercises:l.exercises.map((p,S)=>S===t?{...m.exercise,type:m.exercise.type||p.type||"weight"}:p)}))}catch(i){console.error("Swap error:",i)}finally{oe(null)}}},At=async(t,s)=>{const r=w.exercises[t];if(r){oe(t),Se(null),Ce(null);try{const i=w.exercises.filter((l,p)=>p!==t).map(l=>l.name),c=await Le(),n=await fetch(Me("swap-exercise"),{method:"POST",headers:c,body:JSON.stringify({exerciseName:r.name,exerciseType:r.type||"weight",sets:r.sets,workoutContext:{otherExercises:i},preferredReplacement:s})});if(!n.ok)throw new Error("Swap failed");const m=await n.json();m.exercise&&C(l=>({...l,exercises:l.exercises.map((p,S)=>S===t?{...m.exercise,type:m.exercise.type||p.type||"weight"}:p)}))}catch(i){console.error("Substitution swap error:",i)}finally{oe(null)}}},tt=()=>{C(null),_e(!1),D([]),De(t=>t.filter(s=>s.label!=="Generating workout"))},Pt=t=>{const s=t.type||"weight";return s==="time"?{label:"Time",color:"bg-blue-500/20 text-blue-400"}:s==="bodyweight"?{label:"BW",color:"bg-emerald-500/20 text-emerald-400"}:null},Ot=(t,s)=>s==="time"?`${t.prescribedTime||"?"}s`:s==="bodyweight"?`${t.prescribedReps||"?"} reps`:`${t.prescribedWeight?`${t.prescribedWeight} lbs × `:""}${t.prescribedReps||"?"} reps`,Lt=[{value:"strength",label:"Strength",desc:"Standard weight training",icon:dt,color:"flame"},{value:"hiit",label:"HIIT",desc:"Timed work/rest intervals",icon:ns,color:"red"},{value:"wod",label:"WOD",desc:"AMRAP / EMOM / For Time",icon:mt,color:"yellow"},{value:"mobility",label:"Mobility",desc:"Flexibility & movement flows",icon:Vt,color:"green"},{value:"calisthenics",label:"Calisthenics",desc:"Bodyweight progressions",icon:Yt,color:"cyan"},{value:"dynamic",label:"Dynamic",desc:"Explosive & plyometric",icon:Zt,color:"purple"}],st={strength:{showFocus:!0,showIntensity:!0,showDuration:!0,showExerciseCount:!0,showWarmup:!0},hiit:{showFocus:!0,showIntensity:!1,showDuration:!0,showExerciseCount:!0,showWarmup:!0},wod:{showFocus:!1,showIntensity:!1,showDuration:!0,showExerciseCount:!1,showWarmup:!1},mobility:{showFocus:!0,showIntensity:!1,showDuration:!0,showExerciseCount:!0,showWarmup:!1},calisthenics:{showFocus:!0,showIntensity:!0,showDuration:!0,showExerciseCount:!0,showWarmup:!0},dynamic:{showFocus:!0,showIntensity:!0,showDuration:!0,showExerciseCount:!0,showWarmup:!0}},$=st[N]||st.strength,Mt=[{value:"auto",label:"Auto"},{value:"push",label:"Push"},{value:"pull",label:"Pull"},{value:"legs",label:"Legs"},{value:"upper",label:"Upper"},{value:"full",label:"Full Body"},{value:"bench",label:"Bench Focus"},{value:"core",label:"Core"},{value:"no-equipment",label:"Bodyweight"},{value:"vacation",label:"Hotel / Travel"},{value:"1rm-test",label:"Test 1RM"}],Ft=[{value:"light",label:"Light",desc:"RPE 5-6"},{value:"moderate",label:"Moderate",desc:"RPE 7-8"},{value:"heavy",label:"Heavy",desc:"RPE 8-9"},{value:"max",label:"Max",desc:"RPE 9-10"}];return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[a&&e.jsxs("div",{className:"mb-4 p-3 bg-flame-500/10 border border-flame-500/20 rounded-xl flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-flame-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx(Kt,{className:"w-4 h-4 text-flame-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-flame-300",children:a.programName}),e.jsxs("p",{className:"text-xs text-iron-400",children:["Week ",a.weekNumber," · ",a.phase," · ",a.dayLabel]})]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-medium border ${{primary:"bg-flame-500/20 text-flame-400 border-flame-500/30",volume:"bg-blue-500/20 text-blue-400 border-blue-500/30",speed:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",deload:"bg-green-500/20 text-green-400 border-green-500/30",test:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"}[a.dayType]||"bg-iron-800 text-iron-400 border-iron-700"}`,children:a.dayType})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>je(a?`/programs/${a.programId}`:"/workouts"),className:"p-2 text-iron-400 hover:text-iron-200 hover:bg-iron-800 rounded-xl transition-colors",children:e.jsx(qt,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-display text-2xl text-iron-50",children:a?"Generate Program Workout":"AI Generate Workout"}),e.jsx("p",{className:"text-iron-400 mt-1",children:a?`${a.primaryLift} ${a.primaryScheme} @ ${a.intensity}`:"Personalized based on your training history"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1 order-2 lg:order-1",children:e.jsxs("div",{className:"card-steel rounded-xl p-4",children:[e.jsxs("button",{onClick:()=>bt(!ke),className:"flex items-center gap-2 w-full lg:cursor-default",children:[e.jsx(fe,{className:"w-5 h-5 text-flame-400"}),e.jsx("h3",{className:"font-medium text-iron-200 flex-1 text-left",children:"Analysis"}),!le&&V.length>0&&e.jsxs("span",{className:"text-xs text-iron-500 lg:hidden",children:[V.filter(t=>t.status==="complete").length,"/",V.length]}),e.jsx(ot,{className:`w-4 h-4 text-iron-500 lg:hidden transition-transform ${ke?"rotate-180":""}`})]}),e.jsxs("div",{className:`${ke?"":"hidden"} lg:block mt-4`,children:[e.jsxs("div",{className:"space-y-3",children:[V.map((t,s)=>e.jsxs(H.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:s*.05},className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:t.status==="loading"?e.jsx(P,{className:"w-4 h-4 text-flame-400 animate-spin"}):t.status==="complete"?e.jsx(ct,{className:"w-4 h-4 text-green-400"}):t.status==="warning"?e.jsx(ne,{className:"w-4 h-4 text-amber-400"}):e.jsx(ne,{className:"w-4 h-4 text-red-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-iron-200",children:t.label}),t.detail&&e.jsx("p",{className:"text-xs text-iron-500 mt-0.5 truncate",children:t.detail})]})]},t.label)),V.length===0&&e.jsxs("div",{className:"flex items-center gap-2 text-iron-500",children:[e.jsx(P,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Starting analysis..."})]})]}),(R||Y.length>0)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-iron-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[R&&e.jsx(P,{className:"w-3 h-3 text-flame-400 animate-spin"}),e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wider",children:R?"AI Thinking...":"AI Process"})]}),e.jsxs("div",{ref:Z,className:"max-h-44 overflow-y-auto space-y-1.5",children:[Y.map(t=>e.jsxs(H.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0",children:Qe(t.icon)}),e.jsx("p",{className:"text-xs text-iron-400 leading-relaxed",children:t.text})]},t.id)),R&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("span",{className:"w-1 h-1 bg-flame-400 rounded-full animate-pulse"}),e.jsx("span",{className:"w-1 h-1 bg-flame-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"w-1 h-1 bg-flame-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]})]})]}),!le&&!R&&Y.length===0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-iron-800",children:[e.jsx("p",{className:"text-xs text-iron-500 uppercase tracking-wide mb-3",children:"Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-iron-800/50 rounded-lg p-2",children:[e.jsx("p",{className:"text-lg font-semibold text-iron-100",children:b.recentWorkouts.length}),e.jsx("p",{className:"text-xs text-iron-500",children:"Workouts"})]}),e.jsxs("div",{className:"bg-iron-800/50 rounded-lg p-2",children:[e.jsx("p",{className:"text-lg font-semibold text-iron-100",children:Object.keys(b.maxLifts).length}),e.jsx("p",{className:"text-xs text-iron-500",children:"Lifts Tracked"})]}),e.jsxs("div",{className:"bg-iron-800/50 rounded-lg p-2",children:[e.jsx("p",{className:"text-lg font-semibold text-iron-100",children:b.goals.length}),e.jsx("p",{className:"text-xs text-iron-500",children:"Goals"})]}),e.jsxs("div",{className:`bg-iron-800/50 rounded-lg p-2 ${Object.keys(b.painHistory).length>0?"border border-amber-500/30":""}`,children:[e.jsx("p",{className:"text-lg font-semibold text-iron-100",children:Object.keys(b.painHistory).length}),e.jsx("p",{className:"text-xs text-iron-500",children:"Pain Flags"})]})]})]})]})]})}),e.jsx("div",{className:"lg:col-span-2 order-1 lg:order-2",children:R?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-iron-800/30 rounded-xl border border-flame-500/20 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-iron-700/50 bg-flame-500/5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-flame-500/20 flex items-center justify-center",children:e.jsx(fe,{className:"w-4 h-4 text-flame-400 animate-pulse"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-iron-200",children:"AI is generating your workout..."}),e.jsxs("p",{className:"text-xs text-iron-500",children:[N!=="strength"?`${N.toUpperCase()} · `:"",k!=="auto"?k:"Auto"," · ",Ie," intensity",Q!=="auto"?` · ${Q}min`:"",ee!=="auto"?` · ${ee} exercises`:"",X?` · "${X.slice(0,40)}${X.length>40?"...":""}"`:""]})]}),e.jsx(P,{className:"w-5 h-5 text-flame-400 animate-spin ml-auto"})]}),e.jsxs("div",{ref:Z,className:"p-4 max-h-[400px] overflow-y-auto space-y-2.5 scrollbar-thin",children:[Y.map(t=>e.jsxs(H.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},className:"flex items-start gap-3 py-1",children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0 w-5 h-5 rounded bg-iron-800 flex items-center justify-center",children:Qe(t.icon)}),e.jsx("p",{className:"text-sm text-iron-300 leading-relaxed",children:t.text})]},t.id)),e.jsxs("div",{className:"flex items-center gap-1.5 pt-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-flame-400 rounded-full animate-pulse"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-flame-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"w-1.5 h-1.5 bg-flame-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]})]})]})}):w?e.jsxs(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card-steel rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-iron-800",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-amber-500/20 text-amber-400 font-medium",children:"Draft"})}),j?e.jsx("input",{type:"text",value:w.name,onChange:t=>C(s=>({...s,name:t.target.value})),className:"input-field w-full text-xl font-semibold"}):e.jsx("h2",{className:"text-xl font-semibold text-iron-100",children:w.name}),w.description&&!j&&e.jsx("p",{className:"text-iron-400 mt-1",children:w.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>_e(!j),className:`p-2 rounded-xl transition-colors ${j?"text-flame-400 bg-flame-500/10":"text-iron-400 hover:text-iron-200 hover:bg-iron-800"}`,title:j?"Done editing":"Edit workout",children:e.jsx(ls,{className:"w-4 h-4"})}),e.jsx("button",{onClick:tt,className:"p-2 text-iron-400 hover:text-iron-200 hover:bg-iron-800 rounded-xl",title:"Start over",children:e.jsx(xt,{className:"w-5 h-5"})})]})]}),ie&&e.jsxs("p",{className:"text-xs text-iron-600 mt-2",children:[ie.tokens," tokens · ",ie.responseMs,"ms · ",ie.cost]})]}),w.notes&&!j&&e.jsxs("div",{className:"border-b border-iron-800",children:[e.jsxs("div",{className:"flex items-center gap-2 px-6 pt-3",children:[e.jsx(fe,{className:"w-4 h-4 text-flame-400"}),e.jsx("span",{className:"text-xs text-iron-500 uppercase tracking-wider",children:"Coaching Notes"})]}),e.jsx("div",{className:"px-6 py-3 max-h-32 overflow-y-auto",children:e.jsx("p",{className:"text-sm text-iron-400 leading-relaxed",children:w.notes})})]}),w.generationPrompt&&!j&&e.jsxs("div",{className:"border-b border-iron-800",children:[e.jsxs("button",{onClick:()=>yt(!Ee),className:"w-full flex items-center justify-between px-6 py-3 hover:bg-iron-800/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4 text-iron-500"}),e.jsx("span",{className:"text-sm font-medium text-iron-200",children:"Generation Prompt"})]}),Ee?e.jsx(Xt,{className:"w-4 h-4 text-iron-500"}):e.jsx(ot,{className:"w-4 h-4 text-iron-500"})]}),e.jsx(ut,{children:Ee&&e.jsx(H.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"px-6 pb-3",children:e.jsx("pre",{className:"text-xs text-iron-400 leading-relaxed whitespace-pre-wrap font-mono max-h-96 overflow-y-auto",children:w.generationPrompt})})})})]}),e.jsx("div",{className:"divide-y divide-iron-800",children:(at=w.exercises)==null?void 0:at.map((t,s)=>{var c;const r=Pt(t),i=t.type||"weight";return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-iron-800 flex items-center justify-center text-iron-400 text-sm font-medium",children:s+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[j?e.jsx("input",{type:"text",value:t.name,onChange:n=>It(s,n.target.value),className:"input-field w-full text-sm font-medium"}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{Se(t),Ce(s)},className:"font-medium text-iron-100 hover:text-flame-400 transition-colors text-left flex items-center gap-1.5",children:[t.name,e.jsx(Qt,{className:"w-3.5 h-3.5 text-iron-600 flex-shrink-0"})]}),r&&e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${r.color}`,children:r.label})]}),t.notes&&!j&&e.jsx("p",{className:"text-xs text-iron-500 mt-0.5",children:t.notes})]}),!j&&e.jsx("button",{onClick:()=>K(s),disabled:Je!==null,title:"Swap for similar exercise",className:"p-1.5 text-iron-500 hover:text-flame-400 hover:bg-flame-500/10 rounded-lg transition-colors disabled:opacity-30",children:Je===s?e.jsx(P,{className:"w-4 h-4 animate-spin text-flame-400"}):e.jsx(xt,{className:"w-4 h-4"})}),j&&e.jsx("button",{onClick:()=>Tt(s),className:"p-1.5 text-red-400 hover:bg-red-500/10 rounded-lg",children:e.jsx(os,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"ml-11 space-y-1",children:[(c=t.sets)==null?void 0:c.map((n,m)=>e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("span",{className:"text-iron-500 w-12",children:["Set ",m+1]}),j?e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[i==="time"?e.jsx("input",{type:"text",value:n.prescribedTime||"",onChange:l=>ce(s,m,"prescribedTime",l.target.value),className:"input-field w-20 text-sm py-1",placeholder:"sec"}):i==="bodyweight"?e.jsx("input",{type:"text",value:n.prescribedReps||"",onChange:l=>ce(s,m,"prescribedReps",l.target.value),className:"input-field w-20 text-sm py-1",placeholder:"reps"}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:n.prescribedWeight||"",onChange:l=>ce(s,m,"prescribedWeight",l.target.value),className:"input-field w-20 text-sm py-1",placeholder:"lbs"}),e.jsx("span",{className:"text-iron-500",children:"×"}),e.jsx("input",{type:"text",value:n.prescribedReps||"",onChange:l=>ce(s,m,"prescribedReps",l.target.value),className:"input-field w-20 text-sm py-1",placeholder:"reps"})]}),e.jsx("button",{onClick:()=>Wt(s,m),className:"p-1 text-iron-600 hover:text-red-400",children:e.jsx(es,{className:"w-3 h-3"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-iron-300",children:Ot(n,i)}),n.targetRpe&&e.jsxs("span",{className:"text-iron-500 cursor-help",title:`RPE ${n.targetRpe}/10 effort — ${n.targetRpe>=10?"all-out, nothing left":n.targetRpe>=9?"could maybe do 1 more rep":n.targetRpe>=8?"could do ~2 more reps":n.targetRpe>=7?"could do ~3 more reps":"comfortable, 4+ reps in reserve"}`,children:["@ RPE ",n.targetRpe]})]})]},m)),j&&e.jsxs("button",{onClick:()=>Rt(s),className:"text-xs text-flame-400 hover:text-flame-300 mt-1 flex items-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3"})," Add set"]})]})]},s)})}),e.jsxs("div",{className:"p-4 border-t border-iron-800 flex gap-3",children:[e.jsx("button",{onClick:tt,className:"btn-secondary flex-1",children:"Regenerate"}),e.jsx("button",{onClick:$t,disabled:ze,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:ze?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pt,{className:"w-5 h-5"}),"Add to Workouts"]})})]})]}):e.jsxs("div",{className:"card-steel rounded-xl p-4",children:[e.jsx("h3",{className:"font-medium text-iron-200 mb-3",children:"Workout Options"}),!le&&Object.keys(b.maxLifts).length===0&&e.jsxs("div",{className:"mb-3 p-2.5 bg-amber-500/10 border border-amber-500/20 rounded-lg flex items-start gap-2",children:[e.jsx(ne,{className:"w-4 h-4 text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-300",children:"No training data yet"}),e.jsx("p",{className:"text-xs text-iron-500",children:"Weights will be set conservatively. Log a workout first for personalized loads."})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"Describe your workout (optional)"}),e.jsx("textarea",{value:X,onChange:t=>jt(t.target.value),placeholder:N==="hiit"?"e.g., 'Upper body HIIT, 30/15 intervals'":N==="wod"?"e.g., 'AMRAP with pull-ups and thrusters'":N==="mobility"?"e.g., 'Hip and thoracic spine focus'":N==="calisthenics"?"e.g., 'Push progression day with handstand work'":N==="dynamic"?"e.g., 'Lower body plyometrics and sprint work'":"e.g., 'Heavy bench day with tricep accessories'",className:"input-field w-full min-h-[60px] resize-none text-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-2",children:"Workout Type"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Lt.map(t=>{const s=t.icon,r=N===t.value,c={flame:{border:"border-flame-500",bg:"bg-flame-500/10",text:"text-flame-400",iconBg:"bg-flame-500/20"},red:{border:"border-red-500",bg:"bg-red-500/10",text:"text-red-400",iconBg:"bg-red-500/20"},yellow:{border:"border-yellow-500",bg:"bg-yellow-500/10",text:"text-yellow-400",iconBg:"bg-yellow-500/20"},green:{border:"border-green-500",bg:"bg-green-500/10",text:"text-green-400",iconBg:"bg-green-500/20"},cyan:{border:"border-cyan-500",bg:"bg-cyan-500/10",text:"text-cyan-400",iconBg:"bg-cyan-500/20"},purple:{border:"border-purple-500",bg:"bg-purple-500/10",text:"text-purple-400",iconBg:"bg-purple-500/20"}}[t.color];return e.jsxs("button",{onClick:()=>{vt(t.value),t.value!=="strength"&&k==="1rm-test"&&($e("auto"),Pe("")),t.value==="wod"&&($e("auto"),Re(!1),Ae(!1)),t.value==="mobility"&&(Ye("light"),Re(!1),Ae(!1))},className:`flex items-start gap-2.5 p-2.5 rounded-xl border transition-all text-left
                          ${r?`${c.border} ${c.bg} ${c.text}`:"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0
                          ${r?c.iconBg:"bg-iron-800"}`,children:e.jsx(s,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-medium",children:t.label}),e.jsx("div",{className:"text-[10px] text-iron-500 leading-tight",children:t.desc})]})]},t.value)})})]}),$.showFocus&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"Style"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Mt.filter(t=>N!=="strength"?t.value!=="1rm-test":!0).map(t=>e.jsxs("button",{onClick:()=>{$e(t.value),t.value!=="1rm-test"&&Pe("")},className:`px-3 py-1.5 text-sm rounded-lg border transition-colors
                        ${k===t.value?t.value==="1rm-test"?"border-yellow-500 bg-yellow-500/10 text-yellow-400":"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[t.label,t.value==="1rm-test"&&e.jsx("span",{className:"ml-1 text-[9px] px-1 py-0.5 rounded-full bg-green-500/20 text-green-400 font-medium leading-none",children:"New"})]},t.value))}),k==="auto"&&e.jsx("p",{className:"text-[11px] text-iron-600 mt-2",children:"Auto selects exercises from your logged workouts and adjusts weights based on recent performance. The more you log, the more variety you'll get."})]}),N==="strength"&&k==="1rm-test"&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-500/5 border border-yellow-500/20 rounded-xl",children:[e.jsx("label",{className:"block text-sm text-yellow-400 mb-2",children:"Which lift are you testing?"}),e.jsx("input",{type:"text",value:W,onChange:t=>Pe(t.target.value),placeholder:"e.g. Bench Press, Squat, Deadlift...",className:"input-field w-full",list:"known-exercises"}),e.jsx("datalist",{id:"known-exercises",children:Object.keys(b.maxLifts).map(t=>e.jsx("option",{value:t},t))}),W&&b.maxLifts[W]&&e.jsxs("p",{className:"text-xs text-iron-500 mt-2",children:["Current e1RM: ",e.jsxs("span",{className:"text-iron-300",children:[b.maxLifts[W].e1rm," lbs"]}),e.jsxs("span",{className:"text-iron-600",children:[" (best: ",b.maxLifts[W].weight,"×",b.maxLifts[W].reps,")"]})]}),e.jsx("p",{className:"text-xs text-iron-600 mt-1.5",children:"AI will generate warm-up ramps, attempt protocols, and accessory cooldown."})]}),$.showIntensity&&k!=="1rm-test"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"text-sm text-iron-400 mb-1.5 block",children:"Intensity"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-1.5",children:Ft.map(t=>e.jsxs("button",{onClick:()=>Ye(t.value),className:`px-2 py-1.5 text-xs rounded-lg border transition-colors text-center
                        ${Ie===t.value?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-[10px] text-iron-500",children:t.desc})]},t.value))})]}),k!=="1rm-test"&&($.showDuration||$.showExerciseCount)&&e.jsxs("div",{className:`grid ${$.showDuration&&$.showExerciseCount?"grid-cols-2":"grid-cols-1"} gap-3 mb-3`,children:[$.showDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"Duration"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{value:"auto",label:"Auto"},{value:"20",label:"20m"},{value:"30",label:"30m"},{value:"45",label:"45m"},{value:"60",label:"60m"},{value:"90",label:"90m"}].map(t=>e.jsx("button",{onClick:()=>Nt(t.value),className:`px-2.5 py-1 text-xs rounded-lg border transition-colors
                          ${Q===t.value?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:t.label},t.value))})]}),$.showExerciseCount&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"Exercises"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{value:"auto",label:"Auto"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"8",label:"8"}].map(t=>e.jsx("button",{onClick:()=>kt(t.value),className:`px-2.5 py-1 text-xs rounded-lg border transition-colors
                          ${ee===t.value?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:t.label},t.value))})]})]}),$.showWarmup&&k!=="1rm-test"&&e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>Re(!Te),className:`flex-1 px-3 py-2 text-xs rounded-lg border transition-colors text-center ${Te?"border-flame-500/50 bg-flame-500/10 text-flame-400 font-semibold":"border-iron-700 text-iron-500 hover:border-iron-600"}`,children:"Warm-up"}),e.jsx("button",{onClick:()=>Ae(!We),className:`flex-1 px-3 py-2 text-xs rounded-lg border transition-colors text-center ${We?"border-flame-500/50 bg-flame-500/10 text-flame-400 font-semibold":"border-iron-700 text-iron-500 hover:border-iron-600"}`,children:"Stretches"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"Workout Date"}),e.jsx("input",{type:"date",value:Xe,onChange:t=>St(t.target.value),className:"input-field text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-iron-400 mb-1.5",children:"AI Model"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>Ze("standard"),className:`px-3 py-2 text-xs rounded-lg border transition-colors text-center
                        ${z==="standard"?"border-flame-500 bg-flame-500/10 text-flame-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[e.jsxs("div",{className:"font-medium flex items-center justify-center gap-1",children:[e.jsx(mt,{className:"w-3 h-3"}),"Standard"]}),e.jsxs("div",{className:"text-[10px] text-iron-500",children:[be["generate-workout"]," cr"]})]}),e.jsxs("button",{onClick:()=>Ze("premium"),className:`px-3 py-2 text-xs rounded-lg border transition-colors text-center
                        ${z==="premium"?"border-purple-500 bg-purple-500/10 text-purple-400":"border-iron-700 text-iron-400 hover:border-iron-600"}`,children:[e.jsxs("div",{className:"font-medium flex items-center justify-center gap-1",children:[e.jsx(Oe,{className:"w-3 h-3"}),"Premium"]}),e.jsxs("div",{className:"text-[10px] text-iron-500",children:[ye," cr"]})]})]})]})]}),e.jsx("button",{onClick:Dt,disabled:R||le||k==="1rm-test"&&!W.trim()||!F&&((E==null?void 0:E.credits)??0)<(z==="premium"?ye:be["generate-workout"]),className:"btn-primary w-full flex items-center justify-center gap-2",children:R?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-5 h-5"}),"Generate Workout",e.jsxs("span",{className:"text-xs opacity-70 ml-1",children:["(",z==="premium"?ye:be["generate-workout"]," credits)"]})]})}),Be&&e.jsx("p",{className:"text-red-400 text-sm mt-3 text-center",children:Be})]})})]}),e.jsx(rs,{exercise:Ke,isOpen:!!Ke,onClose:()=>{Se(null),Ce(null)},onSubstitute:qe!==null?t=>At(qe,t):void 0}),e.jsx(ut,{children:ve!==null&&e.jsxs(e.Fragment,{children:[e.jsx(H.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>{K(null),q("")},className:"fixed inset-0 bg-black/60 z-50"}),e.jsxs(H.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-x-4 top-[30%] mx-auto max-w-sm bg-iron-900 border border-iron-700 rounded-2xl z-50 p-4 space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-iron-200",children:"Swap Exercise"}),e.jsx("p",{className:"text-xs text-iron-500",children:`Optionally note why you're swapping (e.g. "shoulder pain", "no cable machine")`}),e.jsx("input",{type:"text",value:Ne,onChange:t=>q(t.target.value),placeholder:"Reason (optional)",className:"input-field w-full text-sm",autoFocus:!0,onKeyDown:t=>{t.key==="Enter"&&(et(ve,Ne),K(null),q(""))}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{K(null),q("")},className:"flex-1 py-2.5 text-sm text-iron-400 hover:text-iron-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>{et(ve,Ne),K(null),q("")},className:"flex-1 py-2.5 text-sm bg-flame-500/15 text-flame-400 border border-flame-500/30 rounded-xl hover:bg-flame-500/25 transition-colors",children:"Swap"})]})]})]})})]})}export{ys as default};
